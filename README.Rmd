---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-"
)
```

# selection.index

<!-- badges: start -->
[![R-CMD-check](https://github.com/zankrut20/selection.index/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/zankrut20/selection.index/actions/workflows/R-CMD-check.yaml)
[![CRAN status](https://www.r-pkg.org/badges/version/selection.index)](https://CRAN.R-project.org/package=selection.index)
[![Lifecycle: stable](https://img.shields.io/badge/lifecycle-stable-brightgreen.svg)](https://lifecycle.r-lib.org/articles/stages.html#stable)
[![Codecov test coverage](https://codecov.io/gh/zankrut20/selection.index/branch/master/graph/badge.svg)](https://app.codecov.io/gh/zankrut20/selection.index?branch=master)
[![Downloads](https://cranlogs.r-pkg.org/badges/grand-total/selection.index?color=blue)](https://CRAN.R-project.org/package=selection.index)
<!-- badges: end -->

Stop wasting days manually assembling complex variance-covariance matrices and resolving selection weights. **`selection.index`** is the definitive, production-ready R package built specifically for agricultural statisticians and quantitative geneticists to instantly calculate optimal multi-trait selection indices. Whether you are running classical phenotypic field trials or building advanced genomic evaluations, this package provides a fully integrated engine that directly maximizes genetic advance and substantially accelerates your breeding pipeline.

**ðŸ“š [Read the Official Documentation & Vignettes on our pkgdown Website](https://zankrut20.github.io/selection.index/)**

## Installation

Install the stable release from CRAN:
```r
install.packages("selection.index")
```

Install the development version from GitHub:
```r
# install.packages("devtools")
devtools::install_github("zankrut20/selection.index")
```

## Quick Start: Optimizing Phenotypic Selection

The package includes several pre-configured structural datasets (`seldata`, `maize_pheno`, `maize_geno`) to test your models. Here, we demonstrate a fundamental phenotypic index evaluating multiple field traits simultaneously.

```{r intro, include=FALSE}
library(selection.index)
```

Before combining traits into a unified index, breeders must cleanly partition the total phenotypic variation. We first use `phen.varcov()` and `gen.varcov()` to extract the precise phenotypic and genotypic variance-covariance matrices directly from your replicated trial data.

```{r matrices}
# Using the built-in 'seldata' dataset (Replication in Col 1, Genotype in Col 2)
p_mat <- phen.varcov(data = seldata[, 3:9], genotypes = seldata[, 2], replication = seldata[, 1])
g_mat <- gen.varcov(data = seldata[, 3:9], genotypes = seldata[, 2], replication = seldata[, 1])
```

Next, we establish strict economic objectives for our evaluated traits. The `weight.mat()` function rapidly converts raw economic weight arrays into the formalized mathematical format required for the core index calculation.

```{r weights}
# Convert the built-in 'weight' configuration matrix
w_mat <- weight.mat(weight)
```

With our covariance structures and economic priorities firmly defined, we must evaluate the baseline potential of our population. We calculate the expected genetic gain for our primary target trait (e.g., yield) using the `gen.advance()` function.

```{r advance}
# Calculate expected genetic advance for the primary trait
base_advance <- gen.advance(phen_mat = p_mat[1, 1], gen_mat = g_mat[1, 1], weight_mat = w_mat[1, 1])
base_advance
```

Finally, to make definitive selection decisions, we dynamically evaluate trait combinations. The `comb.indices()` function constructs robust selection indices and immediately ranks them by predicted relative efficiency, allowing you to confidently select the mathematically superior combination.

```{r index}
# Calculate and rank selection indices
optimal_index <- comb.indices(
  ncomb = 1, pmat = p_mat, gmat = g_mat,
  wmat = weight[, 2:3], wcol = 1, GAY = base_advance
)
head(optimal_index)
```

*(For advanced modeling involving marker-assisted indices, multistage selection, or genomic predictions, please load the included `maize_pheno` and `maize_geno` datasets and consult our [pkgdown vignettes](https://zankrut20.github.io/selection.index/).)*

## Citation

We rely directly on academic citations to maintain and justify the continued development of this software ecosystem. If you use `selection.index` in a publication, breeding pipeline, or research project, it is imperative that you cite it:

```r
citation("selection.index")
```

## Support & Consulting

### Direct-to-Client Consulting
Are you scaling up a commercial breeding operation or standardizing a massive academic quantitative pipeline? I offer dedicated, expert consulting to researchers tailored for custom selection index development, stochastic simulation modeling, and full software pipeline integration. 

**Note: I operate strictly direct-to-client. There are absolutely no middlemen, generic agencies, or intermediaries involved. You work directly with the package creator.**

To discuss consulting scope and availability, contact: `zankrut20@gmail.com`

### Tip Jar
If this package has saved you substantial time, simplified your data pipeline, or helped you publish faster, please consider supporting its independent development! Monetary contributions directly fund repository maintenance and the addition of modern quantitative genetic models.

* **International Users:** [Support via Gumroad](https://gumroad.com/) *(Add your specific link here)*
* **Indian Users (UPI):** `zankrut20@upi` *(Add your specific UPI here)*
