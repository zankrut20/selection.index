<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Combined Linear Genomic Selection Index (CLGSI) — clgsi • selection.index</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Combined Linear Genomic Selection Index (CLGSI) — clgsi"><meta name="description" content="Implements the Combined Linear Genomic Selection Index where selection combines
both phenotypic observations and Genomic Estimated Breeding Values (GEBVs).
This is used for selecting candidates with both phenotype and genotype data
(e.g., in a training population)."><meta property="og:description" content="Implements the Combined Linear Genomic Selection Index where selection combines
both phenotypic observations and Genomic Estimated Breeding Values (GEBVs).
This is used for selecting candidates with both phenotype and genotype data
(e.g., in a training population)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">selection.index</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/constrained-linear-phenotypic-selection-indices.html">Constrained Linear Phenotypic Selection Indices</a></li>
    <li><a class="dropdown-item" href="../articles/Examples.html">Data Analysis with selection.index</a></li>
    <li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started with selection.index</a></li>
    <li><a class="dropdown-item" href="../articles/linear-phenotypic-selection-index.html">The Linear Phenotypic Selection Index Theory</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/zankrut20/selection.index/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Combined Linear Genomic Selection Index (CLGSI)</h1>
      <small class="dont-index">Source: <a href="https://github.com/zankrut20/selection.index/blob/feature/cpp-backend/R/genomic_indices.R" class="external-link"><code>R/genomic_indices.R</code></a></small>
      <div class="d-none name"><code>clgsi.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Implements the Combined Linear Genomic Selection Index where selection combines
both phenotypic observations and Genomic Estimated Breeding Values (GEBVs).
This is used for selecting candidates with both phenotype and genotype data
(e.g., in a training population).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">clgsi</span><span class="op">(</span></span>
<span>  phen_mat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  gebv_mat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">pmat</span>,</span>
<span>  <span class="va">gmat</span>,</span>
<span>  <span class="va">wmat</span>,</span>
<span>  wcol <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  P_y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  P_g <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  P_yg <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  reliability <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  selection_intensity <span class="op">=</span> <span class="fl">2.063</span>,</span>
<span>  GAY <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-phen-mat">phen_mat<a class="anchor" aria-label="anchor" href="#arg-phen-mat"></a></dt>
<dd><p>Matrix of phenotypes (n_genotypes x n_traits). Can be NULL if P_y and P_yg are provided.</p></dd>


<dt id="arg-gebv-mat">gebv_mat<a class="anchor" aria-label="anchor" href="#arg-gebv-mat"></a></dt>
<dd><p>Matrix of GEBVs (n_genotypes x n_traits). Can be NULL if P_g and P_yg are provided.</p></dd>


<dt id="arg-pmat">pmat<a class="anchor" aria-label="anchor" href="#arg-pmat"></a></dt>
<dd><p>Phenotypic variance-covariance matrix (n_traits x n_traits)</p></dd>


<dt id="arg-gmat">gmat<a class="anchor" aria-label="anchor" href="#arg-gmat"></a></dt>
<dd><p>Genotypic variance-covariance matrix (n_traits x n_traits)</p></dd>


<dt id="arg-wmat">wmat<a class="anchor" aria-label="anchor" href="#arg-wmat"></a></dt>
<dd><p>Economic weights matrix (n_traits x k), or vector</p></dd>


<dt id="arg-wcol">wcol<a class="anchor" aria-label="anchor" href="#arg-wcol"></a></dt>
<dd><p>Weight column to use if wmat has multiple columns (default: 1)</p></dd>


<dt id="arg-p-y">P_y<a class="anchor" aria-label="anchor" href="#arg-p-y"></a></dt>
<dd><p>Optional. Phenotypic variance-covariance matrix computed from data (n_traits x n_traits).
If NULL (default), uses pmat or computes from phen_mat using cov().</p></dd>


<dt id="arg-p-g">P_g<a class="anchor" aria-label="anchor" href="#arg-p-g"></a></dt>
<dd><p>Optional. GEBV variance-covariance matrix (n_traits x n_traits).
If NULL (default), computed from gebv_mat using cov().</p></dd>


<dt id="arg-p-yg">P_yg<a class="anchor" aria-label="anchor" href="#arg-p-yg"></a></dt>
<dd><p>Optional. Covariance matrix between phenotypes and GEBVs (n_traits x n_traits).
If NULL (default), computed from phen_mat and gebv_mat using cov().</p></dd>


<dt id="arg-reliability">reliability<a class="anchor" aria-label="anchor" href="#arg-reliability"></a></dt>
<dd><p>Optional. Reliability of GEBVs (r^2, the squared correlation). See lgsi() for details.</p></dd>


<dt id="arg-selection-intensity">selection_intensity<a class="anchor" aria-label="anchor" href="#arg-selection-intensity"></a></dt>
<dd><p>Selection intensity i (default: 2.063 for 10% selection)</p></dd>


<dt id="arg-gay">GAY<a class="anchor" aria-label="anchor" href="#arg-gay"></a></dt>
<dd><p>Optional. Genetic advance of comparative trait for PRE calculation</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List with components:</p><ul><li><p><code>b_y</code> - Coefficients for phenotypes</p></li>
<li><p><code>b_g</code> - Coefficients for GEBVs</p></li>
<li><p><code>b_combined</code> - Full coefficient vector [b_y; b_g]</p></li>
<li><p><code>P_combined</code> - Combined variance matrix</p></li>
<li><p><code>Delta_H</code> - Expected genetic advance per trait</p></li>
<li><p><code>GA</code> - Overall genetic advance</p></li>
<li><p><code>PRE</code> - Percent relative efficiency</p></li>
<li><p><code>hI2</code> - Index heritability</p></li>
<li><p><code>rHI</code> - Index accuracy</p></li>
<li><p><code>summary</code> - Data frame with all metrics</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>Mathematical Formulation:</strong></p>
<p>The CLGSI combines phenotypic and genomic information:
$$I = \mathbf{b}_y' \mathbf{y} + \mathbf{b}_g' \hat{\mathbf{g}}$$</p>
<p>Coefficients are obtained by solving the partitioned system:
$$\begin{bmatrix} \mathbf{b}_y \\ \mathbf{b}_g \end{bmatrix} =
      \begin{bmatrix} \mathbf{P} &amp; \mathbf{P}_{y\hat{g}} \\
                      \mathbf{P}_{y\hat{g}}' &amp; \mathbf{P}_{\hat{g}} \end{bmatrix}^{-1}
      \begin{bmatrix} \mathbf{G} \\ \mathbf{C}_{\hat{g}g} \end{bmatrix} \mathbf{w}$$</p>
<p>Where:
- \(\mathbf{P}\) = Var(phenotypes)
- \(\mathbf{P}_{\hat{g}}\) = Var(GEBVs)
- \(\mathbf{P}_{y\hat{g}}\) = Cov(phenotypes, GEBVs)
- \(\mathbf{G}\) = Genotypic variance-covariance
- \(\mathbf{C}_{\hat{g}g}\) = Cov(GEBV, true BV)</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Cerón-Rojas, J. J., &amp; Crossa, J. (2018). Linear Selection Indices in Modern Plant Breeding.
Springer International Publishing.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Generate example data</span></span></span>
<span class="r-in"><span><span class="va">gmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="gen_varcov.html">gen_varcov</a></span><span class="op">(</span><span class="va">seldata</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>, <span class="va">seldata</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="va">seldata</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="phen_varcov.html">phen_varcov</a></span><span class="op">(</span><span class="va">seldata</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>, <span class="va">seldata</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="va">seldata</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate phenotypes and GEBVs</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n_genotypes</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">n_traits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">gmat</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">phen_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_genotypes</span> <span class="op">*</span> <span class="va">n_traits</span>, mean <span class="op">=</span> <span class="fl">15</span>, sd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   nrow <span class="op">=</span> <span class="va">n_genotypes</span>, ncol <span class="op">=</span> <span class="va">n_traits</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gebv_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_genotypes</span> <span class="op">*</span> <span class="va">n_traits</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   nrow <span class="op">=</span> <span class="va">n_genotypes</span>, ncol <span class="op">=</span> <span class="va">n_traits</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">phen_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">gmat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">gebv_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">gmat</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Economic weights</span></span></span>
<span class="r-in"><span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">5</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">8</span>, <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate CLGSI</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">clgsi</span><span class="op">(</span><span class="va">phen_mat</span>, <span class="va">gebv_mat</span>, <span class="va">pmat</span>, <span class="va">gmat</span>, <span class="va">weights</span>, reliability <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zankrut Goyani.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

