<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Missing Value Estimation for RCBD, Latin Square, and Split Plot Designs — missing_value_estimation • selection.index</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Missing Value Estimation for RCBD, Latin Square, and Split Plot Designs — missing_value_estimation"><meta name="description" content="Estimates missing values in Randomized Complete Block Design (RCBD),
Latin Square Design (LSD), or Split Plot Design (SPD) using one of six methods:
REML, Yates, Healy, Regression, Mean, or Bartlett."><meta property="og:description" content="Estimates missing values in Randomized Complete Block Design (RCBD),
Latin Square Design (LSD), or Split Plot Design (SPD) using one of six methods:
REML, Yates, Healy, Regression, Mean, or Bartlett."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">selection.index</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Examples.html">Data Analysis with selection.index</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/zankrut20/selection.index/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Missing Value Estimation for RCBD, Latin Square, and Split Plot Designs</h1>
      <small class="dont-index">Source: <a href="https://github.com/zankrut20/selection.index/blob/feature/cpp-backend/R/missing_value_estimation.R" class="external-link"><code>R/missing_value_estimation.R</code></a></small>
      <div class="d-none name"><code>missing_value_estimation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimates missing values in Randomized Complete Block Design (RCBD),
Latin Square Design (LSD), or Split Plot Design (SPD) using one of six methods:
REML, Yates, Healy, Regression, Mean, or Bartlett.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">missing_value_estimation</span><span class="op">(</span></span>
<span>  <span class="va">data_mat</span>,</span>
<span>  <span class="va">gen_idx</span>,</span>
<span>  <span class="va">rep_idx</span>,</span>
<span>  col_idx <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  main_idx <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  design_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RCBD"</span>, <span class="st">"LSD"</span>, <span class="st">"SPD"</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"REML"</span>, <span class="st">"Yates"</span>, <span class="st">"Healy"</span>, <span class="st">"Regression"</span>, <span class="st">"Mean"</span>, <span class="st">"Bartlett"</span><span class="op">)</span>,</span>
<span>  tolerance <span class="op">=</span> <span class="fl">1e-06</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data-mat">data_mat<a class="anchor" aria-label="anchor" href="#arg-data-mat"></a></dt>
<dd><p>Numeric matrix with observations (rows) by traits (columns).
May contain missing values (NA, NaN, Inf).</p></dd>


<dt id="arg-gen-idx">gen_idx<a class="anchor" aria-label="anchor" href="#arg-gen-idx"></a></dt>
<dd><p>Integer vector indicating genotype/treatment index for each observation (sub-plot in SPD).</p></dd>


<dt id="arg-rep-idx">rep_idx<a class="anchor" aria-label="anchor" href="#arg-rep-idx"></a></dt>
<dd><p>Integer vector indicating replicate/block (RCBD) or row (LSD) index for each observation.</p></dd>


<dt id="arg-col-idx">col_idx<a class="anchor" aria-label="anchor" href="#arg-col-idx"></a></dt>
<dd><p>Integer vector indicating column index for each observation (required for LSD only).</p></dd>


<dt id="arg-main-idx">main_idx<a class="anchor" aria-label="anchor" href="#arg-main-idx"></a></dt>
<dd><p>Integer vector indicating main plot treatment index for each observation (required for SPD only).</p></dd>


<dt id="arg-design-type">design_type<a class="anchor" aria-label="anchor" href="#arg-design-type"></a></dt>
<dd><p>Character string specifying experimental design: "RCBD" (default), "LSD" (Latin Square), or "SPD" (Split Plot).</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Character string specifying the estimation method. One of:</p><dl><dt>REML</dt>
<dd><p>Restricted Maximum Likelihood with variance components and BLUP
    (Best Linear Unbiased Prediction). Most robust for complex missing patterns.
    Default method. Iterations: 100. (RCBD, LSD only)</p></dd>

  <dt>Yates</dt>
<dd><p>Traditional iterative formula: (r*T + t*B - G) / ((r-1)(t-1)).
    Simple and fast. Good for simple missing patterns. Iterations: 50. (RCBD, LSD only)</p></dd>

  <dt>Healy</dt>
<dd><p>Healy &amp; Westmacott method using weighted adjustment of treatment
    and block means. More stable than Yates for multiple missing values. Iterations: 50. (RCBD, LSD only)</p></dd>

  <dt>Regression</dt>
<dd><p>Linear regression on treatment and block effects with QR
    decomposition. Non-iterative, single-pass estimation. Fast and stable. (RCBD, LSD only)</p></dd>

  <dt>Mean</dt>
<dd><p>Simple mean substitution using treatment and block effects.
    Non-iterative, fastest method. Good for quick estimation. (RCBD, LSD, SPD)</p></dd>

  <dt>Bartlett</dt>
<dd><p>ANCOVA using other traits as covariates with QR decomposition.
    Best when traits are correlated. Iterations: 30. (RCBD, LSD only)</p></dd>


</dl></dd>


<dt id="arg-tolerance">tolerance<a class="anchor" aria-label="anchor" href="#arg-tolerance"></a></dt>
<dd><p>Numeric convergence criterion. Iteration stops when maximum
change in estimated values is below this threshold. Default: 1e-6.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A numeric matrix of the same dimensions as <code>data_mat</code> with all
  missing values replaced by estimates.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function handles missing values in RCBD, LSD, or SPD experiments by iteratively
estimating them until convergence. For RCBD, uses 2-way blocking (genotypes × blocks);
for LSD, uses 3-way blocking (genotypes × rows × columns); for SPD, uses nested
structure (blocks &gt; main plots &gt; sub-plots). Each method has different strengths:</p>
<p><strong>REML Method:</strong>
Uses variance component estimation with restricted maximum likelihood.
Applies shrinkage to predictions based on estimated variance ratios.
Most computationally intensive but handles complex patterns well.</p>
<p><strong>Yates Method:</strong>
Uses the classical formula accounting for treatment, block, and grand totals.
Fast and simple, suitable for balanced designs with few missing values.</p>
<p><strong>Healy &amp; Westmacott Method:</strong>
Uses weighted adjustment based on residuals from treatment and block effects.
More stable than Yates when multiple values are missing from same treatment or block.
Particularly effective for unbalanced missing patterns.</p>
<p><strong>Regression Method:</strong>
Fits linear model using complete observations with treatment and block as factors.
Non-iterative single-pass estimation using QR decomposition for numerical stability.
Fast and deterministic - no convergence iterations needed.</p>
<p><strong>Mean Substitution Method:</strong>
Replaces missing values with treatment mean + block mean - grand mean.
Non-iterative, fastest method. Simple additive model without regression.
Best for quick estimation when precision is less critical.</p>
<p><strong>Bartlett Method:</strong>
Performs ANCOVA using other traits as covariates to predict missing values.
Leverages trait correlations for better predictions when traits are related.
Uses QR decomposition for numerical stability.</p>
<p><strong>Method Availability by Design:</strong></p><ul><li><p>RCBD: REML, Yates, Healy, Regression, Mean, Bartlett</p></li>
<li><p>LSD:  REML, Yates, Healy, Regression, Mean, Bartlett</p></li>
<li><p>SPD:  Mean only (other methods fall back to Mean)</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Yates, F. (1933). The analysis of replicated experiments when the field results
are incomplete. <em>Empire Journal of Experimental Agriculture</em>, 1, 129-142.</p>
<p>Healy, M. J. R., &amp; Westmacott, M. (1956). Missing values in experiments analysed
on automatic computers. <em>Applied Statistics</em>, 5(3), 203-206.</p>
<p>Bartlett, M. S. (1937). Some examples of statistical methods of research in
agriculture and applied biology. <em>Supplement to the Journal of the Royal
Statistical Society</em>, 4(2), 137-183.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zankrut Goyani.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

