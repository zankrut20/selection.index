<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Desired Gains Index (DG-LPSI) — dg_lpsi • selection.index</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Desired Gains Index (DG-LPSI) — dg_lpsi"><meta name="description" content="Implements the Pesek &amp;amp; Baker (1969) Desired Gains Index where breeders specify
target genetic gains instead of economic weights. This enhanced version includes
calculation of implied economic weights and feasibility checking."><meta property="og:description" content="Implements the Pesek &amp;amp; Baker (1969) Desired Gains Index where breeders specify
target genetic gains instead of economic weights. This enhanced version includes
calculation of implied economic weights and feasibility checking."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">selection.index</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/constrained-linear-phenotypic-selection-indices.html">Constrained Linear Phenotypic Selection Indices</a></li>
    <li><a class="dropdown-item" href="../articles/Examples.html">Data Analysis with selection.index</a></li>
    <li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started with selection.index</a></li>
    <li><a class="dropdown-item" href="../articles/linear-phenotypic-selection-index.html">The Linear Phenotypic Selection Index Theory</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/zankrut20/selection.index/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Desired Gains Index (DG-LPSI)</h1>
      <small class="dont-index">Source: <a href="https://github.com/zankrut20/selection.index/blob/feature/cpp-backend/R/constrained_indices.R" class="external-link"><code>R/constrained_indices.R</code></a></small>
      <div class="d-none name"><code>dg_lpsi.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Implements the Pesek &amp; Baker (1969) Desired Gains Index where breeders specify
target genetic gains instead of economic weights. This enhanced version includes
calculation of implied economic weights and feasibility checking.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dg_lpsi</span><span class="op">(</span></span>
<span>  <span class="va">pmat</span>,</span>
<span>  <span class="va">gmat</span>,</span>
<span>  <span class="va">d</span>,</span>
<span>  return_implied_weights <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  check_feasibility <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  selection_intensity <span class="op">=</span> <span class="fl">2.063</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pmat">pmat<a class="anchor" aria-label="anchor" href="#arg-pmat"></a></dt>
<dd><p>Phenotypic variance-covariance matrix (n_traits x n_traits)</p></dd>


<dt id="arg-gmat">gmat<a class="anchor" aria-label="anchor" href="#arg-gmat"></a></dt>
<dd><p>Genotypic variance-covariance matrix (n_traits x n_traits)</p></dd>


<dt id="arg-d">d<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>Vector of desired genetic gains (length n_traits).
Example: d = c(1.5, 0.8, -0.2) means gain +1.5 in trait 1, +0.8 in trait 2, -0.2 in trait 3.</p></dd>


<dt id="arg-return-implied-weights">return_implied_weights<a class="anchor" aria-label="anchor" href="#arg-return-implied-weights"></a></dt>
<dd><p>Logical - calculate implied economic weights? (default: TRUE)</p></dd>


<dt id="arg-check-feasibility">check_feasibility<a class="anchor" aria-label="anchor" href="#arg-check-feasibility"></a></dt>
<dd><p>Logical - warn if desired gains are unrealistic? (default: TRUE)</p></dd>


<dt id="arg-selection-intensity">selection_intensity<a class="anchor" aria-label="anchor" href="#arg-selection-intensity"></a></dt>
<dd><p>Selection intensity i (default: 2.063)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List with:</p><ul><li><p><code>summary</code> - Data frame with coefficients, metrics, and implied weights</p></li>
<li><p><code>b</code> - Vector of selection index coefficients</p></li>
<li><p><code>Delta_G</code> - Named vector of achieved genetic gains per trait</p></li>
<li><p><code>desired_gains</code> - Named vector of desired gains (input d)</p></li>
<li><p><code>gain_errors</code> - Difference between desired and achieved gains</p></li>
<li><p><code>implied_weights</code> - Economic weights that would achieve these gains in Smith-Hazel LPSI</p></li>
<li><p><code>implied_weights_normalized</code> - Normalized implied weights (max absolute = 1)</p></li>
<li><p><code>feasibility</code> - Data frame with feasibility analysis per trait</p></li>
<li><p><code>hI2</code> - Index heritability</p></li>
<li><p><code>rHI</code> - Index accuracy</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>Mathematical Formulation:</strong></p>
<p>1. Index coefficients: \(\mathbf{b} = \mathbf{G}^{-1}\mathbf{d}\)</p>
<p>2. Expected response: \(\Delta \mathbf{G} = (i/\sigma_I) \mathbf{G}\mathbf{b}\)</p>
<p><strong>CRITICAL: Scale Invariance Property</strong></p>
<p>The achieved gains \(\Delta\mathbf{G}\) are determined by selection intensity (i),
genetic variance (G), and phenotypic variance (P), NOT by scaling \(\mathbf{b}\).
If you multiply \(\mathbf{b}\) by constant c, \(\sigma_I\) also scales by c, causing
complete cancellation in \(\Delta\mathbf{G} = (i/(c\sigma_I))\mathbf{G}(c\mathbf{b}) = (i/\sigma_I)\mathbf{G}\mathbf{b}\).</p>
<p><strong>What DG-LPSI Actually Achieves:</strong></p>
<p>- Proportional gains matching the RATIOS in d (not absolute magnitudes)
- Achieved magnitude depends on biological/genetic constraints
- Use feasibility checking to verify if desired gains are realistic</p>
<p>3. Implied economic weights (Section 1.4 of Chapter 4):
   $$\hat{\mathbf{w}} = \mathbf{G}^{-1} \mathbf{P} \mathbf{b}$$</p>
<p>The implied weights represent the economic values that would have been needed
in a Smith-Hazel index to achieve the desired gain PROPORTIONS. Large implied weights
indicate traits that are "expensive" to improve (low heritability or unfavorable
correlations), while small weights indicate traits that are "cheap" to improve.</p>
<p><strong>Feasibility Checking:</strong></p>
<p>The function estimates maximum possible gains as approximately 3.0 * sqrt(G_ii)
(assuming very intense selection with i ~ 3.0) and warns if desired gains
exceed 80% of these theoretical maxima.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Pesek, J., &amp; Baker, R. J. (1969). Desired improvement in relation to
selection indices. <em>Canadian Journal of Plant Science</em>, 49(6), 803-804.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load data</span></span></span>
<span class="r-in"><span><span class="va">gmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="gen_varcov.html">gen_varcov</a></span><span class="op">(</span><span class="va">seldata</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>, <span class="va">seldata</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="va">seldata</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="phen_varcov.html">phen_varcov</a></span><span class="op">(</span><span class="va">seldata</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>, <span class="va">seldata</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="va">seldata</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specify desired gains (e.g., increase each trait by 1 unit)</span></span></span>
<span class="r-in"><span><span class="va">desired_gains</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">gmat</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate Desired Gains Index with all enhancements</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">dg_lpsi</span><span class="op">(</span><span class="va">pmat</span>, <span class="va">gmat</span>, d <span class="op">=</span> <span class="va">desired_gains</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Desired gains may be unrealistic for trait(s): rpp, ppr, spp, pw</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Desired gains exceed 80% of theoretical maximum (i = 2.06).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Consider reducing targets or using higher selection intensity.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View summary</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       b.1    b.2     b.3      b.4    b.5       b.6     b.7 Delta_G     hI2 rHI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 11.4784 3.8899 -17.521 -17.3052 0.5096 -115.2781 71.4102 53.5871 -0.0931  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   implied_w.1 implied_w.2 implied_w.3 implied_w.4 implied_w.5 implied_w.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    -46.6372     14.1965    178.2319     72.9888    -26.4785   -256.3287</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   implied_w.7 implied_w_norm.1 implied_w_norm.2 implied_w_norm.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    738.7446          -0.0631           0.0192           0.2413</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   implied_w_norm.4 implied_w_norm.5 implied_w_norm.6 implied_w_norm.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           0.0988          -0.0358           -0.347                1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extract implied weights to understand relative "cost" of gains</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">implied_weights_normalized</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        sypp         dtf         rpp         ppr         ppp         spp </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.06313034  0.01921701  0.24126326  0.09880111 -0.03584256 -0.34697876 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          pw </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.00000000 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check feasibility</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">feasibility</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      trait desired_gain achieved_gain genetic_sd max_possible_gain</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sypp  sypp            1    0.07942154  1.1209826            2.3126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dtf    dtf            1    0.07942154  1.2490710            2.5768</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rpp    rpp            1    0.07942154  0.3639840            0.7509</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ppr    ppr            1    0.07942154  0.4931853            1.0174</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ppp    ppp            1    0.07942154  0.9801869            2.0221</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> spp    spp            1    0.07942154  0.1319506            0.2722</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pw      pw            1    0.07942154  0.1015121            0.2094</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      feasibility_ratio is_realistic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sypp            0.4324         TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> dtf             0.3881         TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rpp             1.3317        FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ppr             0.9829        FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ppp             0.4945         TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> spp             3.6736        FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pw              4.7751        FALSE</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zankrut Goyani.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

