<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Constrained Linear Genomic Selection Indices (Chapter 6) • selection.index</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Constrained Linear Genomic Selection Indices (Chapter 6)"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">selection.index</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="articles/Examples.html">Data Analysis with selection.index</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/zankrut20/selection.index/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Constrained Linear Genomic Selection Indices (Chapter 6)</h1>
      <small class="dont-index">Source: <a href="https://github.com/zankrut20/selection.index/blob/feature/cpp-backend/CONSTRAINED_GENOMIC_INDICES.md" class="external-link"><code>CONSTRAINED_GENOMIC_INDICES.md</code></a></small>
    </div>

<div id="constrained-linear-genomic-selection-indices-chapter-6" class="section level1">

<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a></h2>
<p>This document describes the implementation of constrained linear genomic selection indices from Chapter 6 of Cerón-Rojas &amp; Crossa (2018). All mathematical formulas have been implemented in the new modular file <code>constrained_genomic_indices.R</code>.</p>
</div>
<div class="section level2">
<h2 id="implementation-architecture">Implementation Architecture<a class="anchor" aria-label="anchor" href="#implementation-architecture"></a></h2>
<div class="section level3">
<h3 id="design-principles">Design Principles<a class="anchor" aria-label="anchor" href="#design-principles"></a></h3>
<ol style="list-style-type: decimal"><li>
<strong>Modular Structure</strong>: All constrained genomic indices in a separate file for easy maintenance</li>
<li>
<strong>C++ for Math</strong>: All mathematical operations use primitives from <code>math_primitives.cpp</code>
</li>
<li>
<strong>R for Logic</strong>: All selection index logic and algorithms implemented in R</li>
<li>
<strong>Consistent API</strong>: Functions follow the same pattern as existing package functions</li>
</ol></div>
<div class="section level3">
<h3 id="files-created">Files Created<a class="anchor" aria-label="anchor" href="#files-created"></a></h3>
<ul><li>
<strong>R Code</strong>: <code>R/constrained_genomic_indices.R</code> (1200+ lines)</li>
<li>
<strong>Documentation</strong>:
<ul><li><code>man/rlgsi.Rd</code></li>
<li><code>man/ppg_lgsi.Rd</code></li>
<li><code>man/crlgsi.Rd</code></li>
<li><code>man/cppg_lgsi.Rd</code></li>
<li><code>man/constrained_genomic_indices.Rd</code></li>
</ul></li>
<li>
<strong>Examples</strong>: <code>inst/examples/chapter6_constrained_genomic_indices.R</code>
</li>
<li>
<strong>Exports</strong>: Updated <code>NAMESPACE</code>
</li>
</ul><hr></div>
</div>
<div class="section level2">
<h2 id="mathematical-formulas--r-implementation">Mathematical Formulas → R Implementation<a class="anchor" aria-label="anchor" href="#mathematical-formulas--r-implementation"></a></h2>
<div class="section level3">
<h3 id="id_61-rlgsi-restricted-linear-genomic-selection-index">6.1 RLGSI (Restricted Linear Genomic Selection Index)<a class="anchor" aria-label="anchor" href="#id_61-rlgsi-restricted-linear-genomic-selection-index"></a></h3>
<div class="section level4">
<h4 id="latex-formulas-from-chapter-6tex">LaTeX Formulas (from Chapter 6.tex)<a class="anchor" aria-label="anchor" href="#latex-formulas-from-chapter-6tex"></a></h4>
<p><strong>Objective Function</strong> (Eq. 6.1):</p>
<pre><code>f_R(β,v) = w'Cw + β'Γβ - 2w'Γβ + 2v'U'Γβ</code></pre>
<p><strong>Augmented System</strong> (Eq. 6.2):</p>
<pre><code>[Γ   ΓU ] [β]   [Γw]
[U'Γ  0 ] [v] = [ 0 ]</code></pre>
<p><strong>Coefficients</strong> (Eq. 6.3):</p>
<pre><code>β_RG = K_G w</code></pre>
<p><strong>Selection Response</strong> (Eq. 6.5):</p>
<pre><code>R_RG = (k_I / L_G) * sqrt(β_RG' Γ β_RG)</code></pre>
<p><strong>Expected Gains</strong> (Eq. 6.6):</p>
<pre><code>E_RG = (k_I / L_G) * (Γ β_RG) / sqrt(β_RG' Γ β_RG)</code></pre>
</div>
<div class="section level4">
<h4 id="r-implementation">R Implementation<a class="anchor" aria-label="anchor" href="#r-implementation"></a></h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/rlgsi.html">rlgsi</a></span><span class="op">(</span><span class="va">Gamma</span>, <span class="va">wmat</span>, wcol <span class="op">=</span> <span class="fl">1</span>, restricted_traits <span class="op">=</span> <span class="cn">NULL</span>, U <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>      k_I <span class="op">=</span> <span class="fl">2.063</span>, L_G <span class="op">=</span> <span class="fl">1</span>, GAY <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p><strong>Key Implementation Details</strong>: - Build augmented matrix using <code><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind()</a></code>, <code><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind()</a></code> - Solve system using <code><a href="https://rdrr.io/pkg/MASS/man/ginv.html" class="external-link">MASS::ginv()</a></code> for robustness - Extract β_RG from solution vector (first n_traits elements) - Use <code><a href="reference/cpp_quadratic_form_sym.html">cpp_quadratic_form_sym()</a></code> for β’Γβ calculation - Response and gains computed in <code><a href="reference/dot-genomic_index_metrics.html">.genomic_index_metrics()</a></code> helper</p>
<hr></div>
</div>
<div class="section level3">
<h3 id="id_62-ppg-lgsi-predetermined-proportional-gains">6.2 PPG-LGSI (Predetermined Proportional Gains)<a class="anchor" aria-label="anchor" href="#id_62-ppg-lgsi-predetermined-proportional-gains"></a></h3>
<div class="section level4">
<h4 id="latex-formulas">LaTeX Formulas<a class="anchor" aria-label="anchor" href="#latex-formulas"></a></h4>
<p><strong>Alternative Form</strong> (Eq. 6.9):</p>
<pre><code>β_PG = β_RG + θ_G * U(U'ΓU)^(-1)d</code></pre>
<p><strong>Proportionality Constant</strong> (Eq. 6.10):</p>
<pre><code>θ_G = [d'(U'ΓU)^(-1)U'Γw] / [d'(U'ΓU)^(-1)d]</code></pre>
<p><strong>Selection Response</strong> (Eq. 6.11):</p>
<pre><code>R_PG = (k_I / L_G) * sqrt(β_PG' Γ β_PG)</code></pre>
<p><strong>Expected Gains</strong> (Eq. 6.12):</p>
<pre><code>E_PG = (k_I / L_G) * (Γ β_PG) / sqrt(β_PG' Γ β_PG)</code></pre>
</div>
<div class="section level4">
<h4 id="r-implementation-1">R Implementation<a class="anchor" aria-label="anchor" href="#r-implementation-1"></a></h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ppg_lgsi.html">ppg_lgsi</a></span><span class="op">(</span><span class="va">Gamma</span>, <span class="va">d</span>, wmat <span class="op">=</span> <span class="cn">NULL</span>, wcol <span class="op">=</span> <span class="fl">1</span>, U <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>         k_I <span class="op">=</span> <span class="fl">2.063</span>, L_G <span class="op">=</span> <span class="fl">1</span>, GAY <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p><strong>Key Implementation Details</strong>: - First compute β_RG using internal call to <code><a href="reference/rlgsi.html">rlgsi()</a></code> - Compute U’ΓU and invert using <code><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve()</a></code> - Calculate θ_G using matrix operations - Compute δ = U(U’ΓU)^(-1)d - Final coefficients: β_PG = β_RG + θ_G * δ - Verify proportionality by computing gain ratios</p>
<hr></div>
</div>
<div class="section level3">
<h3 id="id_63-crlgsi-combined-restricted-linear-genomic-selection-index">6.3 CRLGSI (Combined Restricted Linear Genomic Selection Index)<a class="anchor" aria-label="anchor" href="#id_63-crlgsi-combined-restricted-linear-genomic-selection-index"></a></h3>
<div class="section level4">
<h4 id="latex-formulas-1">LaTeX Formulas<a class="anchor" aria-label="anchor" href="#latex-formulas-1"></a></h4>
<p><strong>Coefficients</strong> (Eq. 6.13):</p>
<pre><code>β_CR = K_C β_C</code></pre>
<p><strong>Selection Response</strong> (Eq. 6.14):</p>
<pre><code>R_CR = (k_I / L_I) * sqrt(β_CR' T_C β_CR)</code></pre>
<p><strong>Expected Gains</strong> (Eq. 6.15):</p>
<pre><code>E_CR = (k_I / L_I) * (Ψ_C β_CR) / sqrt(β_CR' T_C β_CR)</code></pre>
</div>
<div class="section level4">
<h4 id="r-implementation-2">R Implementation<a class="anchor" aria-label="anchor" href="#r-implementation-2"></a></h4>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/crlgsi.html">crlgsi</a></span><span class="op">(</span>T_C <span class="op">=</span> <span class="cn">NULL</span>, Psi_C <span class="op">=</span> <span class="cn">NULL</span>, phen_mat <span class="op">=</span> <span class="cn">NULL</span>, gebv_mat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>       pmat <span class="op">=</span> <span class="cn">NULL</span>, gmat <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">wmat</span>, wcol <span class="op">=</span> <span class="fl">1</span>,</span>
<span>       restricted_traits <span class="op">=</span> <span class="cn">NULL</span>, U <span class="op">=</span> <span class="cn">NULL</span>, reliability <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>       k_I <span class="op">=</span> <span class="fl">2.063</span>, L_I <span class="op">=</span> <span class="fl">1</span>, GAY <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p><strong>Key Implementation Details</strong>: - Build T_C matrix: [P, P_yg; P_yg’, P_g] (2t x 2t) - Build Ψ_C matrix: [G; C_gebv_g] (2t x t) - Transform constraint matrix: U_TC = Ψ_C %*% U - Solve augmented system similar to RLGSI - Split solution into b_y (phenotype) and b_g (GEBV) coefficients - Use <code><a href="reference/dot-combined_index_metrics.html">.combined_index_metrics()</a></code> helper for calculations</p>
<hr></div>
</div>
<div class="section level3">
<h3 id="id_64-cppg-lgsi-combined-predetermined-proportional-gains">6.4 CPPG-LGSI (Combined Predetermined Proportional Gains)<a class="anchor" aria-label="anchor" href="#id_64-cppg-lgsi-combined-predetermined-proportional-gains"></a></h3>
<div class="section level4">
<h4 id="latex-formulas-2">LaTeX Formulas<a class="anchor" aria-label="anchor" href="#latex-formulas-2"></a></h4>
<p><strong>Coefficients</strong> (Eq. 6.16):</p>
<pre><code><span><span class="va">β_CP</span> <span class="op">=</span> <span class="va">β_CR</span> <span class="op">+</span> <span class="va">θ_CP</span> <span class="op">*</span> <span class="va">δ_CP</span></span></code></pre>
<p><strong>Proportionality Constant</strong> (Eq. 6.17):</p>
<pre><code>θ_CP = [β_C' Φ_C(Φ_C' T_C^(-1) Φ_C)^(-1) d_C] /
       [d_C' (Φ_C' T_C^(-1) Φ_C)^(-1) d_C]</code></pre>
<p><strong>Selection Response</strong> (Eq. 6.18):</p>
<pre><code>R_CP = (k_I / L_I) * sqrt(β_CP' T_C β_CP)</code></pre>
<p><strong>Expected Gains</strong> (Eq. 6.19):</p>
<pre><code>E_CP = (k_I / L_I) * (Ψ_C β_CP) / sqrt(β_CP' T_C β_CP)</code></pre>
</div>
<div class="section level4">
<h4 id="r-implementation-3">R Implementation<a class="anchor" aria-label="anchor" href="#r-implementation-3"></a></h4>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/cppg_lgsi.html">cppg_lgsi</a></span><span class="op">(</span>T_C <span class="op">=</span> <span class="cn">NULL</span>, Psi_C <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">d</span>, phen_mat <span class="op">=</span> <span class="cn">NULL</span>, gebv_mat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>          pmat <span class="op">=</span> <span class="cn">NULL</span>, gmat <span class="op">=</span> <span class="cn">NULL</span>, wmat <span class="op">=</span> <span class="cn">NULL</span>, wcol <span class="op">=</span> <span class="fl">1</span>, U <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>          reliability <span class="op">=</span> <span class="cn">NULL</span>, k_I <span class="op">=</span> <span class="fl">2.063</span>, L_I <span class="op">=</span> <span class="fl">1</span>, GAY <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p><strong>Key Implementation Details</strong>: - First compute β_CR using internal call to <code><a href="reference/crlgsi.html">crlgsi()</a></code> - Compute Φ_C = Ψ_C %*% U - Invert T_C using <code><a href="https://rdrr.io/pkg/MASS/man/ginv.html" class="external-link">MASS::ginv()</a></code> - Calculate (Φ_C’ T_C^(-1) Φ_C)^(-1) - Compute unrestricted β_C = T_C^(-1) Ψ_C w - Calculate θ_CP using formula - Compute δ_CP and final coefficients - Split into phenotype and GEBV components</p>
<hr></div>
</div>
</div>
<div class="section level2">
<h2 id="c-primitives-used">C++ Primitives Used<a class="anchor" aria-label="anchor" href="#c-primitives-used"></a></h2>
<p>All mathematical operations leverage existing C++ functions from <code>math_primitives.cpp</code>:</p>
<table class="table"><colgroup><col width="34%"><col width="43%"><col width="21%"></colgroup><thead><tr class="header"><th>Operation</th>
<th>C++ Function</th>
<th>Usage</th>
</tr></thead><tbody><tr class="odd"><td>Solve Ax = b</td>
<td><code><a href="reference/cpp_symmetric_solve.html">cpp_symmetric_solve()</a></code></td>
<td>Solving linear systems</td>
</tr><tr class="even"><td>x’Ay</td>
<td><code><a href="reference/cpp_quadratic_form.html">cpp_quadratic_form()</a></code></td>
<td>Computing quadratic forms</td>
</tr><tr class="odd"><td>x’Ax</td>
<td><code><a href="reference/cpp_quadratic_form_sym.html">cpp_quadratic_form_sym()</a></code></td>
<td>Computing symmetric quadratic forms</td>
</tr><tr class="even"><td>Extract elements</td>
<td><code><a href="reference/cpp_extract_vector.html">cpp_extract_vector()</a></code></td>
<td>Extracting weight vectors</td>
</tr></tbody></table><p><strong>No new C++ code was needed</strong> - all existing primitives were sufficient!</p>
<hr></div>
<div class="section level2">
<h2 id="helper-functions">Helper Functions<a class="anchor" aria-label="anchor" href="#helper-functions"></a></h2>
<div class="section level3">
<h3 id="genomic_index_metrics"><code>.genomic_index_metrics()</code><a class="anchor" aria-label="anchor" href="#genomic_index_metrics"></a></h3>
<p>Computes standard metrics for genomic indices (RLGSI, PPG-LGSI): - Uses Γ (GEBV variance-covariance) - Computes b’Γb, selection response, expected gains - Returns accuracy (rHI), overall GA, PRE</p>
</div>
<div class="section level3">
<h3 id="combined_index_metrics"><code>.combined_index_metrics()</code><a class="anchor" aria-label="anchor" href="#combined_index_metrics"></a></h3>
<p>Computes metrics for combined indices (CRLGSI, CPPG-LGSI): - Uses T_C (combined variance) and Ψ_C (combined genetic covariance) - Computes b’T_Cb, selection response, expected gains - Returns accuracy, GA, PRE</p>
<p>Both helpers use only C++ primitives for calculations.</p>
<hr></div>
</div>
<div class="section level2">
<h2 id="usage-examples">Usage Examples<a class="anchor" aria-label="anchor" href="#usage-examples"></a></h2>
<div class="section level3">
<h3 id="simple-restriction-example">Simple Restriction Example<a class="anchor" aria-label="anchor" href="#simple-restriction-example"></a></h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Restrict traits 2 and 4 to zero gain</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/rlgsi.html">rlgsi</a></span><span class="op">(</span><span class="va">Gamma</span>, <span class="va">weights</span>, restricted_traits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check constraints (should be ~0)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">E</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="proportional-gains-example">Proportional Gains Example<a class="anchor" aria-label="anchor" href="#proportional-gains-example"></a></h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Achieve 3:2:1 ratio for first 3 traits</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ppg_lgsi.html">ppg_lgsi</a></span><span class="op">(</span><span class="va">Gamma</span>, <span class="va">d</span>, wmat <span class="op">=</span> <span class="va">weights</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Verify proportionality</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">gain_ratios</span><span class="op">)</span>  <span class="co"># Should be constant</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="combined-data-with-restrictions">Combined Data with Restrictions<a class="anchor" aria-label="anchor" href="#combined-data-with-restrictions"></a></h3>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use both phenotypes and GEBVs</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/crlgsi.html">crlgsi</a></span><span class="op">(</span></span>
<span>  phen_mat <span class="op">=</span> <span class="va">phenotypes</span>,</span>
<span>  gebv_mat <span class="op">=</span> <span class="va">gebvs</span>,</span>
<span>  pmat <span class="op">=</span> <span class="va">pmat</span>,</span>
<span>  gmat <span class="op">=</span> <span class="va">gmat</span>,</span>
<span>  wmat <span class="op">=</span> <span class="va">weights</span>,</span>
<span>  restricted_traits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  reliability <span class="op">=</span> <span class="fl">0.7</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Access separate coefficients</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">b_y</span><span class="op">)</span>  <span class="co"># Phenotype coefficients</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">b_g</span><span class="op">)</span>  <span class="co"># GEBV coefficients</span></span></code></pre></div>
<hr></div>
</div>
<div class="section level2">
<h2 id="testing-and-validation">Testing and Validation<a class="anchor" aria-label="anchor" href="#testing-and-validation"></a></h2>
<div class="section level3">
<h3 id="constraint-verification">Constraint Verification<a class="anchor" aria-label="anchor" href="#constraint-verification"></a></h3>
<p>All functions return <code>constrained_response</code> to verify constraints are satisfied: - RLGSI: U’Γβ ≈ 0 - PPG-LGSI: gain_ratios should be constant - CRLGSI: U’E ≈ 0 - CPPG-LGSI: gain_ratios should be constant</p>
</div>
<div class="section level3">
<h3 id="numerical-stability">Numerical Stability<a class="anchor" aria-label="anchor" href="#numerical-stability"></a></h3>
<ul><li>All functions use <code><a href="https://rdrr.io/pkg/MASS/man/ginv.html" class="external-link">MASS::ginv()</a></code> for matrix inversion (handles near-singular matrices)</li>
<li>Augmented systems with explicit zero blocks for Lagrange multipliers</li>
<li>Checks for NA/Inf in coefficient vectors</li>
</ul><hr></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
<p>Cerón-Rojas, J. J., &amp; Crossa, J. (2018). <em>Linear Selection Indices in Modern Plant Breeding</em>. Springer International Publishing. Chapter 6: Constrained Linear Genomic Selection Indices.</p>
<hr></div>
<div class="section level2">
<h2 id="package-integration">Package Integration<a class="anchor" aria-label="anchor" href="#package-integration"></a></h2>
<div class="section level3">
<h3 id="existing-functions">Existing Functions<a class="anchor" aria-label="anchor" href="#existing-functions"></a></h3>
<p>These new functions complement existing package capabilities:</p>
<p><strong>Unrestricted Indices:</strong> - <code><a href="reference/lpsi.html">lpsi()</a></code> - Linear Phenotypic Selection Index - <code><a href="reference/lgsi.html">lgsi()</a></code> - Linear Genomic Selection Index<br>
- <code><a href="reference/clgsi.html">clgsi()</a></code> - Combined Linear Genomic Selection Index</p>
<p><strong>Constrained Phenotypic Indices:</strong> - <code><a href="reference/rlpsi.html">rlpsi()</a></code> - Restricted LPSI - <code><a href="reference/ppg_lpsi.html">ppg_lpsi()</a></code> - Predetermined Proportional Gains LPSI - <code><a href="reference/dg_lpsi.html">dg_lpsi()</a></code> - Desired Gains LPSI</p>
<p><strong>New Constrained Genomic Indices:</strong> - <code><a href="reference/rlgsi.html">rlgsi()</a></code> - Restricted LGSI - <code><a href="reference/ppg_lgsi.html">ppg_lgsi()</a></code> - Predetermined Proportional Gains LGSI - <code><a href="reference/crlgsi.html">crlgsi()</a></code> - Combined Restricted LGSI - <code><a href="reference/cppg_lgsi.html">cppg_lgsi()</a></code> - Combined Predetermined Proportional Gains LGSI</p>
</div>
<div class="section level3">
<h3 id="consistent-api-design">Consistent API Design<a class="anchor" aria-label="anchor" href="#consistent-api-design"></a></h3>
<p>All functions share common parameter names: - <code>restricted_traits</code> - User-friendly way to specify constraints - <code>U</code> - Advanced constraint matrix option - <code>k_I</code> - Selection intensity - <code>GAY</code> - Comparative trait for PRE calculation - <code>wmat</code>, <code>wcol</code> - Economic weights</p>
<p>All return lists with: - <code>summary</code> - Data frame with coefficients and metrics - <code>b</code> - Coefficient vector - <code>E</code> - Expected genetic gains per trait - <code>R</code> - Overall selection response</p>
<hr></div>
</div>
<div class="section level2">
<h2 id="future-extensions">Future Extensions<a class="anchor" aria-label="anchor" href="#future-extensions"></a></h2>
<p>Possible additions following the same modular pattern:</p>
<ol style="list-style-type: decimal"><li>
<strong>Print/Summary Methods</strong>: S3 methods for the new index classes</li>
<li>
<strong>Visualization</strong>: Plot functions for constraint visualization</li>
<li>
<strong>Cross-validation</strong>: Functions to validate reliability estimates</li>
<li>
<strong>Multi-trait GEBV</strong>: Support for joint modeling</li>
<li>
<strong>Economic Weights</strong>: Automated weight estimation from market data</li>
</ol><p>All extensions would follow the same principles: - C++ for computation - R for logic - Modular organization - Consistent API</p>
<hr></div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a></h2>
<p>The implementation successfully translates all mathematical formulas from Chapter 6 into efficient, well-documented R code. The modular design makes it easy to:</p>
<ul><li>Understand how formulas map to code</li>
<li>Maintain and extend functionality</li>
<li>Test individual components</li>
<li>Integrate with existing package functions</li>
</ul><p>All code follows package conventions and uses existing C++ primitives, requiring no new C++ development.</p>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zankrut Goyani.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

