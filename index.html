<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Analysis of Selection Index in Plant Breeding â€¢ selection.index</title>
<script src="lightswitch.js"></script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><script src="extra.js"></script><meta property="og:title" content="Analysis of Selection Index in Plant Breeding">
<meta name="description" content="Provides tools for the simultaneous improvement of multiple traits in plant breeding. Building upon the classical selection index (Smith 1937 &lt;doi:10.1111/j.1469-1809.1936.tb02143.x&gt;) and modern quantitative genetics (Kang 2020 &lt;doi:10.1007/978-3-319-91223-3&gt;), this package calculates classical phenotypic, genomic, marker-assisted, restricted/constrained, and eigen selection indices. It also incorporates multi-stage selection evaluation and stochastic simulations to estimate genetic advance based on economic weights, heritability, and genetic correlations.">
<meta property="og:description" content="Provides tools for the simultaneous improvement of multiple traits in plant breeding. Building upon the classical selection index (Smith 1937 &lt;doi:10.1111/j.1469-1809.1936.tb02143.x&gt;) and modern quantitative genetics (Kang 2020 &lt;doi:10.1007/978-3-319-91223-3&gt;), this package calculates classical phenotypic, genomic, marker-assisted, restricted/constrained, and eigen selection indices. It also incorporates multi-stage selection evaluation and stochastic simulations to estimate genetic advance based on economic weights, heritability, and genetic correlations.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">selection.index</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/getting-started.html">Getting Started with selection.index</a></li>
    <li><a class="dropdown-item" href="articles/linear-phenotypic-selection-index.html">The Linear Phenotypic Selection Index Theory</a></li>
    <li><a class="dropdown-item" href="articles/constrained-linear-phenotypic-selection-indices.html">Constrained Linear Phenotypic Selection Indices</a></li>
    <li><a class="dropdown-item" href="articles/linear-marker-selection-indices.html">Linear Marker and Genome-Wide Selection Indices</a></li>
    <li><a class="dropdown-item" href="articles/linear-genomic-selection-indices.html">Linear Genomic Selection Indices</a></li>
    <li><a class="dropdown-item" href="articles/constrained-linear-genomic-selection-indices.html">Constrained Linear Genomic Selection Indices</a></li>
    <li><a class="dropdown-item" href="articles/linear-phenotypic-eigen-selection-index-methods.html">Linear Phenotypic Eigen Selection Index Methods</a></li>
    <li><a class="dropdown-item" href="articles/linear-genomic-eigen-selection-index-methods.html">Linear Genomic Eigen Selection Index Methods</a></li>
    <li><a class="dropdown-item" href="articles/multistage-linear-selection-indices.html">Multistage Phenotypic Selection Indices</a></li>
    <li><a class="dropdown-item" href="articles/stochastic-simulation-linear-phenotypic-indices.html">Stochastic Simulation of Linear Phenotypic Selection Indices</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/zankrut20/selection.index/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="selectionindex">selection.index<a class="anchor" aria-label="anchor" href="#selectionindex"></a>
</h1></div>
<!-- badges: start -->

<p>Stop wasting days manually assembling complex variance-covariance matrices and resolving selection weights. <strong><code>selection.index</code></strong> is the definitive, production-ready R package built specifically for agricultural statisticians and quantitative geneticists to instantly calculate optimal multi-trait selection indices. Whether you are running classical phenotypic field trials or building advanced genomic evaluations, this package provides a fully integrated mathematical engine that directly maximizes genetic advance and substantially accelerates your breeding pipeline.</p>
<p><strong>ðŸ“š <a href="https://zankrut20.github.io/selection.index/">Read the Official Documentation &amp; Vignettes on our pkgdown Website</a></strong></p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install the stable release from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"selection.index"</span><span class="op">)</span></span></code></pre></div>
<p>Install the development version from GitHub:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"zankrut20/selection.index"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quick-start-optimizing-phenotypic-selection">Quick Start: Optimizing Phenotypic Selection<a class="anchor" aria-label="anchor" href="#quick-start-optimizing-phenotypic-selection"></a>
</h2>
<p>The package includes several pre-configured structural datasets (<code>seldata</code>, <code>maize_pheno</code>, <code>maize_geno</code>) to test your models. Here, we demonstrate a fundamental phenotypic index evaluating multiple field traits simultaneously.</p>
<p>Before combining traits into a unified index, breeders must cleanly partition the total phenotypic variation. We first use the variance-covariance functions (<code><a href="reference/phen_varcov.html">phen_varcov()</a></code> and <code><a href="reference/gen_varcov.html">gen_varcov()</a></code>) to extract the precise phenotypic and genotypic matrices directly from your replicated trial data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using the built-in 'seldata' dataset (Replication in Col 1, Genotype in Col 2)</span></span>
<span><span class="va">p_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/phen_varcov.html">phen_varcov</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">seldata</span><span class="op">[</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>, genotypes <span class="op">=</span> <span class="va">seldata</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, replication <span class="op">=</span> <span class="va">seldata</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">g_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/gen_varcov.html">gen_varcov</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">seldata</span><span class="op">[</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>, genotypes <span class="op">=</span> <span class="va">seldata</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, replication <span class="op">=</span> <span class="va">seldata</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Next, we establish strict economic objectives for our evaluated traits. The <code><a href="reference/weight_mat.html">weight_mat()</a></code> function rapidly converts raw economic weight arrays into the formalized mathematical format required for the core index calculation.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert the built-in 'weight' configuration matrix</span></span>
<span><span class="va">w_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/weight_mat.html">weight_mat</a></span><span class="op">(</span><span class="va">weight</span><span class="op">)</span></span></code></pre></div>
<p>With our covariance structures and economic priorities firmly defined, we must evaluate the baseline potential of our population. We calculate the expected genetic gain for our primary target trait (e.g., yield) using the <code><a href="reference/gen_advance.html">gen_advance()</a></code> function.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate expected genetic advance for the primary trait</span></span>
<span><span class="va">base_advance</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/gen_advance.html">gen_advance</a></span><span class="op">(</span>phen_mat <span class="op">=</span> <span class="va">p_mat</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, gen_mat <span class="op">=</span> <span class="va">g_mat</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, weight_mat <span class="op">=</span> <span class="va">w_mat</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">base_advance</span></span>
<span><span class="co">#&gt;        [,1]</span></span>
<span><span class="co">#&gt; [1,] 1.2009</span></span></code></pre></div>
<p>Finally, to make definitive selection decisions, we dynamically evaluate trait combinations. The <code><a href="reference/lpsi.html">lpsi()</a></code> function constructs robust combinatorial selection indices and immediately ranks them by predicted relative efficiency, allowing you to confidently select the mathematically superior combination.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate and rank combinatorial selection indices</span></span>
<span><span class="va">optimal_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/lpsi.html">lpsi</a></span><span class="op">(</span></span>
<span>  ncomb <span class="op">=</span> <span class="fl">1</span>, pmat <span class="op">=</span> <span class="va">p_mat</span>, gmat <span class="op">=</span> <span class="va">g_mat</span>,</span>
<span>  wmat <span class="op">=</span> <span class="va">weight</span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, wcol <span class="op">=</span> <span class="fl">1</span>, GAY <span class="op">=</span> <span class="va">base_advance</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">optimal_index</span><span class="op">)</span></span>
<span><span class="co">#&gt;   ID    b.1     GA      PRE Delta_G    rHI    hI2 Rank</span></span>
<span><span class="co">#&gt; 1  1 0.6316 2.8125 234.2021  2.8125 0.4825 0.2697    1</span></span>
<span><span class="co">#&gt; 2  2 0.2396 1.3036 108.5481  1.3036 0.2237 0.2242    4</span></span>
<span><span class="co">#&gt; 3  3 1.4869 2.1526 179.2462  2.1526 0.3693 0.2690    2</span></span>
<span><span class="co">#&gt; 4  4 0.4507 0.9084  75.6402  0.9084 0.1558 0.2549    6</span></span>
<span><span class="co">#&gt; 5  5 0.3164 1.6236 135.1988  1.6236 0.2786 0.1553    3</span></span>
<span><span class="co">#&gt; 6  6 1.4499 1.0292  85.7009  1.0292 0.1766 0.1471    5</span></span></code></pre></div>
<p><em>(For advanced modeling involving marker-assisted indices, multistage selection, or genomic predictions, please load the included <code>maize_pheno</code> and <code>maize_geno</code> datasets and consult our <a href="https://zankrut20.github.io/selection.index/">pkgdown vignettes</a>.)</em></p>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>We rely directly on academic citations to maintain and justify the continued development of this software ecosystem. If you use <code>selection.index</code> in a publication, breeding pipeline, or research project, it is imperative that you cite it:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"selection.index"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="support--consulting">Support &amp; Consulting<a class="anchor" aria-label="anchor" href="#support--consulting"></a>
</h2>
<div class="section level3">
<h3 id="direct-to-client-consulting">Direct-to-Client Consulting<a class="anchor" aria-label="anchor" href="#direct-to-client-consulting"></a>
</h3>
<p>Are you scaling up a commercial breeding operation or standardizing a massive academic quantitative pipeline? I offer dedicated, expert consulting to researchers tailored for custom selection index development, stochastic simulation modeling, and full software pipeline integration.</p>
<p><strong>Note: I operate strictly direct-to-client. There are absolutely no middlemen, generic agencies, or intermediaries involved. You work directly with the package creator.</strong></p>
<p>To discuss consulting scope and availability, contact: <code>zankrut20@gmail.com</code></p>
</div>
<div class="section level3">
<h3 id="tip-jar">Tip Jar<a class="anchor" aria-label="anchor" href="#tip-jar"></a>
</h3>
<p>If this package has saved you substantial time, simplified your data pipeline, or helped you publish faster, please consider supporting its independent development! Monetary contributions directly fund repository maintenance and the addition of modern quantitative genetic models.</p>
<ul>
<li>
<strong>Indian Users (UPI):</strong> <code>zankrut20@oksbi</code>
</li>
<li>
<strong>International Users:</strong> Available Soon</li>
</ul>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=selection.index" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/zankrut20/selection.index/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/zankrut20/selection.index/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing selection.index</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Zankrut Goyani <br><small class="roles"> Author, maintainer, copyright holder </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/zankrut20/selection.index/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/zankrut20/selection.index/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://CRAN.R-project.org/package=selection.index" class="external-link"><img src="https://www.r-pkg.org/badges/version/selection.index" alt="CRAN status"></a></li>
<li><a href="https://cran.r-project.org/web/checks/check_results_selection.index.html" class="external-link"><img src="https://badges.cranchecks.info/summary/selection.index.svg" alt="CRAN checks"></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="Lifecycle: stable"></a></li>
<li><a href="https://www.gnu.org/licenses/gpl-3.0" class="external-link"><img src="https://img.shields.io/badge/License-GPL%20v3-blue.svg" alt="License: GPL-3"></a></li>
<li><a href="https://CRAN.R-project.org/package=selection.index" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/selection.index?color=blue" alt="Total downloads"></a></li>
<li><a href="https://cran.r-project.org/package=selection.index" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/last-month/selection.index?color=green" alt="Monthly downloads"></a></li>
<li><a href="https://app.codecov.io/gh/zankrut20/selection.index?branch=master" class="external-link"><img src="https://codecov.io/gh/zankrut20/selection.index/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://www.codefactor.io/repository/github/zankrut20/selection.index" class="external-link"><img src="https://www.codefactor.io/repository/github/zankrut20/selection.index/badge" alt="CodeFactor"></a></li>
<li><a href="https://github.com/zankrut20/selection.index/stargazers" class="external-link"><img src="https://img.shields.io/github/stars/zankrut20/selection.index?style=social" alt="GitHub stars"></a></li>
<li><a href="https://github.com/zankrut20/selection.index/issues" class="external-link"><img src="https://img.shields.io/github/issues/zankrut20/selection.index" alt="GitHub issues"></a></li>
<li><a href="https://github.com/zankrut20/selection.index/network/members" class="external-link"><img src="https://img.shields.io/github/forks/zankrut20/selection.index?style=social" alt="GitHub forks"></a></li>
<li><a href="https://github.com/zankrut20/selection.index/commits/master" class="external-link"><img src="https://img.shields.io/github/last-commit/zankrut20/selection.index" alt="Last commit"></a></li>
<li><a href="https://www.r-project.org/" class="external-link"><img src="https://img.shields.io/badge/R-%E2%89%A5%203.5.0-blue" alt="R version"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zankrut Goyani.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
