[{"path":"https://zankrut20.github.io/selection.index/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"GNU General Public License","title":"GNU General Public License","text":"Version 3, 29 June 2007Copyright ¬© 2007 Free Software Foundation, Inc.¬†<http://fsf.org/> Everyone permitted copy distribute verbatim copies license document, changing allowed.","code":""},{"path":"https://zankrut20.github.io/selection.index/LICENSE.html","id":"preamble","dir":"","previous_headings":"","what":"Preamble","title":"GNU General Public License","text":"GNU General Public License free, copyleft license software kinds works. licenses software practical works designed take away freedom share change works. contrast, GNU General Public License intended guarantee freedom share change versions program‚Äìmake sure remains free software users. , Free Software Foundation, use GNU General Public License software; applies also work released way authors. can apply programs, . speak free software, referring freedom, price. General Public Licenses designed make sure freedom distribute copies free software (charge wish), receive source code can get want , can change software use pieces new free programs, know can things. protect rights, need prevent others denying rights asking surrender rights. Therefore, certain responsibilities distribute copies software, modify : responsibilities respect freedom others. example, distribute copies program, whether gratis fee, must pass recipients freedoms received. must make sure , , receive can get source code. must show terms know rights. Developers use GNU GPL protect rights two steps: (1) assert copyright software, (2) offer License giving legal permission copy, distribute /modify . developers‚Äô authors‚Äô protection, GPL clearly explains warranty free software. users‚Äô authors‚Äô sake, GPL requires modified versions marked changed, problems attributed erroneously authors previous versions. devices designed deny users access install run modified versions software inside , although manufacturer can . fundamentally incompatible aim protecting users‚Äô freedom change software. systematic pattern abuse occurs area products individuals use, precisely unacceptable. Therefore, designed version GPL prohibit practice products. problems arise substantially domains, stand ready extend provision domains future versions GPL, needed protect freedom users. Finally, every program threatened constantly software patents. States allow patents restrict development use software general-purpose computers, , wish avoid special danger patents applied free program make effectively proprietary. prevent , GPL assures patents used render program non-free. precise terms conditions copying, distribution modification follow.","code":""},{"path":[]},{"path":"https://zankrut20.github.io/selection.index/LICENSE.html","id":"id_0-definitions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"0. Definitions","title":"GNU General Public License","text":"‚ÄúLicense‚Äù refers version 3 GNU General Public License. ‚ÄúCopyright‚Äù also means copyright-like laws apply kinds works, semiconductor masks. ‚ÄúProgram‚Äù refers copyrightable work licensed License. licensee addressed ‚Äú‚Äù. ‚ÄúLicensees‚Äù ‚Äúrecipients‚Äù may individuals organizations. ‚Äúmodify‚Äù work means copy adapt part work fashion requiring copyright permission, making exact copy. resulting work called ‚Äúmodified version‚Äù earlier work work ‚Äúbased ‚Äù earlier work. ‚Äúcovered work‚Äù means either unmodified Program work based Program. ‚Äúpropagate‚Äù work means anything , without permission, make directly secondarily liable infringement applicable copyright law, except executing computer modifying private copy. Propagation includes copying, distribution (without modification), making available public, countries activities well. ‚Äúconvey‚Äù work means kind propagation enables parties make receive copies. Mere interaction user computer network, transfer copy, conveying. interactive user interface displays ‚ÄúAppropriate Legal Notices‚Äù extent includes convenient prominently visible feature (1) displays appropriate copyright notice, (2) tells user warranty work (except extent warranties provided), licensees may convey work License, view copy License. interface presents list user commands options, menu, prominent item list meets criterion.","code":""},{"path":"https://zankrut20.github.io/selection.index/LICENSE.html","id":"id_1-source-code","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"1. Source Code","title":"GNU General Public License","text":"‚Äúsource code‚Äù work means preferred form work making modifications . ‚ÄúObject code‚Äù means non-source form work. ‚ÄúStandard Interface‚Äù means interface either official standard defined recognized standards body, , case interfaces specified particular programming language, one widely used among developers working language. ‚ÄúSystem Libraries‚Äù executable work include anything, work whole, () included normal form packaging Major Component, part Major Component, (b) serves enable use work Major Component, implement Standard Interface implementation available public source code form. ‚ÄúMajor Component‚Äù, context, means major essential component (kernel, window system, ) specific operating system () executable work runs, compiler used produce work, object code interpreter used run . ‚ÄúCorresponding Source‚Äù work object code form means source code needed generate, install, (executable work) run object code modify work, including scripts control activities. However, include work‚Äôs System Libraries, general-purpose tools generally available free programs used unmodified performing activities part work. example, Corresponding Source includes interface definition files associated source files work, source code shared libraries dynamically linked subprograms work specifically designed require, intimate data communication control flow subprograms parts work. Corresponding Source need include anything users can regenerate automatically parts Corresponding Source. Corresponding Source work source code form work.","code":""},{"path":"https://zankrut20.github.io/selection.index/LICENSE.html","id":"id_2-basic-permissions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"2. Basic Permissions","title":"GNU General Public License","text":"rights granted License granted term copyright Program, irrevocable provided stated conditions met. License explicitly affirms unlimited permission run unmodified Program. output running covered work covered License output, given content, constitutes covered work. License acknowledges rights fair use equivalent, provided copyright law. may make, run propagate covered works convey, without conditions long license otherwise remains force. may convey covered works others sole purpose make modifications exclusively , provide facilities running works, provided comply terms License conveying material control copyright. thus making running covered works must exclusively behalf, direction control, terms prohibit making copies copyrighted material outside relationship . Conveying circumstances permitted solely conditions stated . Sublicensing allowed; section 10 makes unnecessary.","code":""},{"path":"https://zankrut20.github.io/selection.index/LICENSE.html","id":"id_3-protecting-users-legal-rights-from-anti-circumvention-law","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"3. Protecting Users‚Äô Legal Rights From Anti-Circumvention Law","title":"GNU General Public License","text":"covered work shall deemed part effective technological measure applicable law fulfilling obligations article 11 WIPO copyright treaty adopted 20 December 1996, similar laws prohibiting restricting circumvention measures. convey covered work, waive legal power forbid circumvention technological measures extent circumvention effected exercising rights License respect covered work, disclaim intention limit operation modification work means enforcing, work‚Äôs users, third parties‚Äô legal rights forbid circumvention technological measures.","code":""},{"path":"https://zankrut20.github.io/selection.index/LICENSE.html","id":"id_4-conveying-verbatim-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"4. Conveying Verbatim Copies","title":"GNU General Public License","text":"may convey verbatim copies Program‚Äôs source code receive , medium, provided conspicuously appropriately publish copy appropriate copyright notice; keep intact notices stating License non-permissive terms added accord section 7 apply code; keep intact notices absence warranty; give recipients copy License along Program. may charge price price copy convey, may offer support warranty protection fee.","code":""},{"path":"https://zankrut20.github.io/selection.index/LICENSE.html","id":"id_5-conveying-modified-source-versions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"5. Conveying Modified Source Versions","title":"GNU General Public License","text":"may convey work based Program, modifications produce Program, form source code terms section 4, provided also meet conditions: ) work must carry prominent notices stating modified , giving relevant date. b) work must carry prominent notices stating released License conditions added section 7. requirement modifies requirement section 4 ‚Äúkeep intact notices‚Äù. c) must license entire work, whole, License anyone comes possession copy. License therefore apply, along applicable section 7 additional terms, whole work, parts, regardless packaged. License gives permission license work way, invalidate permission separately received . d) work interactive user interfaces, must display Appropriate Legal Notices; however, Program interactive interfaces display Appropriate Legal Notices, work need make . compilation covered work separate independent works, nature extensions covered work, combined form larger program, volume storage distribution medium, called ‚Äúaggregate‚Äù compilation resulting copyright used limit access legal rights compilation‚Äôs users beyond individual works permit. Inclusion covered work aggregate cause License apply parts aggregate.","code":""},{"path":"https://zankrut20.github.io/selection.index/LICENSE.html","id":"id_6-conveying-non-source-forms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"6. Conveying Non-Source Forms","title":"GNU General Public License","text":"may convey covered work object code form terms sections 4 5, provided also convey machine-readable Corresponding Source terms License, one ways: ) Convey object code , embodied , physical product (including physical distribution medium), accompanied Corresponding Source fixed durable physical medium customarily used software interchange. b) Convey object code , embodied , physical product (including physical distribution medium), accompanied written offer, valid least three years valid long offer spare parts customer support product model, give anyone possesses object code either (1) copy Corresponding Source software product covered License, durable physical medium customarily used software interchange, price reasonable cost physically performing conveying source, (2) access copy Corresponding Source network server charge. c) Convey individual copies object code copy written offer provide Corresponding Source. alternative allowed occasionally noncommercially, received object code offer, accord subsection 6b. d) Convey object code offering access designated place (gratis charge), offer equivalent access Corresponding Source way place charge. need require recipients copy Corresponding Source along object code. place copy object code network server, Corresponding Source may different server (operated third party) supports equivalent copying facilities, provided maintain clear directions next object code saying find Corresponding Source. Regardless server hosts Corresponding Source, remain obligated ensure available long needed satisfy requirements. e) Convey object code using peer--peer transmission, provided inform peers object code Corresponding Source work offered general public charge subsection 6d. separable portion object code, whose source code excluded Corresponding Source System Library, need included conveying object code work. ‚ÄúUser Product‚Äù either (1) ‚Äúconsumer product‚Äù, means tangible personal property normally used personal, family, household purposes, (2) anything designed sold incorporation dwelling. determining whether product consumer product, doubtful cases shall resolved favor coverage. particular product received particular user, ‚Äúnormally used‚Äù refers typical common use class product, regardless status particular user way particular user actually uses, expects expected use, product. product consumer product regardless whether product substantial commercial, industrial non-consumer uses, unless uses represent significant mode use product. ‚ÄúInstallation Information‚Äù User Product means methods, procedures, authorization keys, information required install execute modified versions covered work User Product modified version Corresponding Source. information must suffice ensure continued functioning modified object code case prevented interfered solely modification made. convey object code work section , , specifically use , User Product, conveying occurs part transaction right possession use User Product transferred recipient perpetuity fixed term (regardless transaction characterized), Corresponding Source conveyed section must accompanied Installation Information. requirement apply neither third party retains ability install modified object code User Product (example, work installed ROM). requirement provide Installation Information include requirement continue provide support service, warranty, updates work modified installed recipient, User Product modified installed. Access network may denied modification materially adversely affects operation network violates rules protocols communication across network. Corresponding Source conveyed, Installation Information provided, accord section must format publicly documented (implementation available public source code form), must require special password key unpacking, reading copying.","code":""},{"path":"https://zankrut20.github.io/selection.index/LICENSE.html","id":"id_7-additional-terms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"7. Additional Terms","title":"GNU General Public License","text":"‚ÄúAdditional permissions‚Äù terms supplement terms License making exceptions one conditions. Additional permissions applicable entire Program shall treated though included License, extent valid applicable law. additional permissions apply part Program, part may used separately permissions, entire Program remains governed License without regard additional permissions. convey copy covered work, may option remove additional permissions copy, part . (Additional permissions may written require removal certain cases modify work.) may place additional permissions material, added covered work, can give appropriate copyright permission. Notwithstanding provision License, material add covered work, may (authorized copyright holders material) supplement terms License terms: ) Disclaiming warranty limiting liability differently terms sections 15 16 License; b) Requiring preservation specified reasonable legal notices author attributions material Appropriate Legal Notices displayed works containing ; c) Prohibiting misrepresentation origin material, requiring modified versions material marked reasonable ways different original version; d) Limiting use publicity purposes names licensors authors material; e) Declining grant rights trademark law use trade names, trademarks, service marks; f) Requiring indemnification licensors authors material anyone conveys material (modified versions ) contractual assumptions liability recipient, liability contractual assumptions directly impose licensors authors. non-permissive additional terms considered ‚Äúrestrictions‚Äù within meaning section 10. Program received , part , contains notice stating governed License along term restriction, may remove term. license document contains restriction permits relicensing conveying License, may add covered work material governed terms license document, provided restriction survive relicensing conveying. add terms covered work accord section, must place, relevant source files, statement additional terms apply files, notice indicating find applicable terms. Additional terms, permissive non-permissive, may stated form separately written license, stated exceptions; requirements apply either way.","code":""},{"path":"https://zankrut20.github.io/selection.index/LICENSE.html","id":"id_8-termination","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"8. Termination","title":"GNU General Public License","text":"may propagate modify covered work except expressly provided License. attempt otherwise propagate modify void, automatically terminate rights License (including patent licenses granted third paragraph section 11). However, cease violation License, license particular copyright holder reinstated () provisionally, unless copyright holder explicitly finally terminates license, (b) permanently, copyright holder fails notify violation reasonable means prior 60 days cessation. Moreover, license particular copyright holder reinstated permanently copyright holder notifies violation reasonable means, first time received notice violation License (work) copyright holder, cure violation prior 30 days receipt notice. Termination rights section terminate licenses parties received copies rights License. rights terminated permanently reinstated, qualify receive new licenses material section 10.","code":""},{"path":"https://zankrut20.github.io/selection.index/LICENSE.html","id":"id_9-acceptance-not-required-for-having-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"9. Acceptance Not Required for Having Copies","title":"GNU General Public License","text":"required accept License order receive run copy Program. Ancillary propagation covered work occurring solely consequence using peer--peer transmission receive copy likewise require acceptance. However, nothing License grants permission propagate modify covered work. actions infringe copyright accept License. Therefore, modifying propagating covered work, indicate acceptance License .","code":""},{"path":"https://zankrut20.github.io/selection.index/LICENSE.html","id":"id_10-automatic-licensing-of-downstream-recipients","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"10. Automatic Licensing of Downstream Recipients","title":"GNU General Public License","text":"time convey covered work, recipient automatically receives license original licensors, run, modify propagate work, subject License. responsible enforcing compliance third parties License. ‚Äúentity transaction‚Äù transaction transferring control organization, substantially assets one, subdividing organization, merging organizations. propagation covered work results entity transaction, party transaction receives copy work also receives whatever licenses work party‚Äôs predecessor interest give previous paragraph, plus right possession Corresponding Source work predecessor interest, predecessor can get reasonable efforts. may impose restrictions exercise rights granted affirmed License. example, may impose license fee, royalty, charge exercise rights granted License, may initiate litigation (including cross-claim counterclaim lawsuit) alleging patent claim infringed making, using, selling, offering sale, importing Program portion .","code":""},{"path":"https://zankrut20.github.io/selection.index/LICENSE.html","id":"id_11-patents","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"11. Patents","title":"GNU General Public License","text":"‚Äúcontributor‚Äù copyright holder authorizes use License Program work Program based. work thus licensed called contributor‚Äôs ‚Äúcontributor version‚Äù. contributor‚Äôs ‚Äúessential patent claims‚Äù patent claims owned controlled contributor, whether already acquired hereafter acquired, infringed manner, permitted License, making, using, selling contributor version, include claims infringed consequence modification contributor version. purposes definition, ‚Äúcontrol‚Äù includes right grant patent sublicenses manner consistent requirements License. contributor grants non-exclusive, worldwide, royalty-free patent license contributor‚Äôs essential patent claims, make, use, sell, offer sale, import otherwise run, modify propagate contents contributor version. following three paragraphs, ‚Äúpatent license‚Äù express agreement commitment, however denominated, enforce patent (express permission practice patent covenant sue patent infringement). ‚Äúgrant‚Äù patent license party means make agreement commitment enforce patent party. convey covered work, knowingly relying patent license, Corresponding Source work available anyone copy, free charge terms License, publicly available network server readily accessible means, must either (1) cause Corresponding Source available, (2) arrange deprive benefit patent license particular work, (3) arrange, manner consistent requirements License, extend patent license downstream recipients. ‚ÄúKnowingly relying‚Äù means actual knowledge , patent license, conveying covered work country, recipient‚Äôs use covered work country, infringe one identifiable patents country reason believe valid. , pursuant connection single transaction arrangement, convey, propagate procuring conveyance , covered work, grant patent license parties receiving covered work authorizing use, propagate, modify convey specific copy covered work, patent license grant automatically extended recipients covered work works based . patent license ‚Äúdiscriminatory‚Äù include within scope coverage, prohibits exercise , conditioned non-exercise one rights specifically granted License. may convey covered work party arrangement third party business distributing software, make payment third party based extent activity conveying work, third party grants, parties receive covered work , discriminatory patent license () connection copies covered work conveyed (copies made copies), (b) primarily connection specific products compilations contain covered work, unless entered arrangement, patent license granted, prior 28 March 2007. Nothing License shall construed excluding limiting implied license defenses infringement may otherwise available applicable patent law.","code":""},{"path":"https://zankrut20.github.io/selection.index/LICENSE.html","id":"id_12-no-surrender-of-others-freedom","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"12. No Surrender of Others‚Äô Freedom","title":"GNU General Public License","text":"conditions imposed (whether court order, agreement otherwise) contradict conditions License, excuse conditions License. convey covered work satisfy simultaneously obligations License pertinent obligations, consequence may convey . example, agree terms obligate collect royalty conveying convey Program, way satisfy terms License refrain entirely conveying Program.","code":""},{"path":"https://zankrut20.github.io/selection.index/LICENSE.html","id":"id_13-use-with-the-gnu-affero-general-public-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"13. Use with the GNU Affero General Public License","title":"GNU General Public License","text":"Notwithstanding provision License, permission link combine covered work work licensed version 3 GNU Affero General Public License single combined work, convey resulting work. terms License continue apply part covered work, special requirements GNU Affero General Public License, section 13, concerning interaction network apply combination .","code":""},{"path":"https://zankrut20.github.io/selection.index/LICENSE.html","id":"id_14-revised-versions-of-this-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"14. Revised Versions of this License","title":"GNU General Public License","text":"Free Software Foundation may publish revised /new versions GNU General Public License time time. new versions similar spirit present version, may differ detail address new problems concerns. version given distinguishing version number. Program specifies certain numbered version GNU General Public License ‚Äúlater version‚Äù applies , option following terms conditions either numbered version later version published Free Software Foundation. Program specify version number GNU General Public License, may choose version ever published Free Software Foundation. Program specifies proxy can decide future versions GNU General Public License can used, proxy‚Äôs public statement acceptance version permanently authorizes choose version Program. Later license versions may give additional different permissions. However, additional obligations imposed author copyright holder result choosing follow later version.","code":""},{"path":"https://zankrut20.github.io/selection.index/LICENSE.html","id":"id_15-disclaimer-of-warranty","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"15. Disclaimer of Warranty","title":"GNU General Public License","text":"WARRANTY PROGRAM, EXTENT PERMITTED APPLICABLE LAW. EXCEPT OTHERWISE STATED WRITING COPYRIGHT HOLDERS /PARTIES PROVIDE PROGRAM ‚Äú‚Äù WITHOUT WARRANTY KIND, EITHER EXPRESSED IMPLIED, INCLUDING, LIMITED , IMPLIED WARRANTIES MERCHANTABILITY FITNESS PARTICULAR PURPOSE. ENTIRE RISK QUALITY PERFORMANCE PROGRAM . PROGRAM PROVE DEFECTIVE, ASSUME COST NECESSARY SERVICING, REPAIR CORRECTION.","code":""},{"path":"https://zankrut20.github.io/selection.index/LICENSE.html","id":"id_16-limitation-of-liability","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"16. Limitation of Liability","title":"GNU General Public License","text":"EVENT UNLESS REQUIRED APPLICABLE LAW AGREED WRITING COPYRIGHT HOLDER, PARTY MODIFIES /CONVEYS PROGRAM PERMITTED , LIABLE DAMAGES, INCLUDING GENERAL, SPECIAL, INCIDENTAL CONSEQUENTIAL DAMAGES ARISING USE INABILITY USE PROGRAM (INCLUDING LIMITED LOSS DATA DATA RENDERED INACCURATE LOSSES SUSTAINED THIRD PARTIES FAILURE PROGRAM OPERATE PROGRAMS), EVEN HOLDER PARTY ADVISED POSSIBILITY DAMAGES.","code":""},{"path":"https://zankrut20.github.io/selection.index/LICENSE.html","id":"id_17-interpretation-of-sections-15-and-16","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"17. Interpretation of Sections 15 and 16","title":"GNU General Public License","text":"disclaimer warranty limitation liability provided given local legal effect according terms, reviewing courts shall apply local law closely approximates absolute waiver civil liability connection Program, unless warranty assumption liability accompanies copy Program return fee. END TERMS CONDITIONS","code":""},{"path":"https://zankrut20.github.io/selection.index/LICENSE.html","id":"how-to-apply-these-terms-to-your-new-programs","dir":"","previous_headings":"","what":"How to Apply These Terms to Your New Programs","title":"GNU General Public License","text":"develop new program, want greatest possible use public, best way achieve make free software everyone can redistribute change terms. , attach following notices program. safest attach start source file effectively state exclusion warranty; file least ‚Äúcopyright‚Äù line pointer full notice found. Also add information contact electronic paper mail. program terminal interaction, make output short notice like starts interactive mode: hypothetical commands show w show c show appropriate parts General Public License. course, program‚Äôs commands might different; GUI interface, use ‚Äúbox‚Äù. also get employer (work programmer) school, , sign ‚Äúcopyright disclaimer‚Äù program, necessary. information , apply follow GNU GPL, see <http://www.gnu.org/licenses/>. GNU General Public License permit incorporating program proprietary programs. program subroutine library, may consider useful permit linking proprietary applications library. want , use GNU Lesser General Public License instead License. first, please read <http://www.gnu.org/philosophy/--lgpl.html>.","code":"<one line to give the program's name and a brief idea of what it does.> Copyright (C) <year>  <name of author>  This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with this program.  If not, see <http://www.gnu.org/licenses/>. <program>  Copyright (C) <year>  <name of author> This program comes with ABSOLUTELY NO WARRANTY; for details type 'show w'. This is free software, and you are welcome to redistribute it under certain conditions; type 'show c' for details."},{"path":"https://zankrut20.github.io/selection.index/articles/constrained-linear-genomic-selection-indices.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Constrained Linear Genomic Selection Indices","text":"vignette demonstrates methodology behind Constrained Linear Genomic Selection Indices (LGSI) based Chapter 6 book Linear Selection Indices Modern Plant Breeding. objective constrained selection indices maximize genetic advance specific traits imposing defined restrictions traits. genomic selection context, indices use Genomic Estimated Breeding Values (GEBVs). core indices covered include: Restricted Linear Genomic Selection Index (RLGSI): Aims improve specific traits leaving others fixed (null restriction). Predetermined Proportional Gain Linear Genomic Selection Index (PPG-LGSI): Aims achieve specific, predetermined proportions change population mean designated traits. Combined RLGSI (CRLGSI): Extends RLGSI use phenotypic GEBV information jointly. Combined PPG-LGSI (CPPG-LGSI): Extends PPG-LGSI use phenotypic GEBV information jointly.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/constrained-linear-genomic-selection-indices.html","id":"environment-setup-and-data-preparation","dir":"Articles","previous_headings":"","what":"Environment Setup and Data Preparation","title":"Constrained Linear Genomic Selection Indices","text":"utilize synthetic phenotypic genotypic maize data provided selection.index package illustrate methods.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/constrained-linear-genomic-selection-indices.html","id":"estimating-gebvs","dir":"Articles","previous_headings":"Environment Setup and Data Preparation","what":"1. Estimating GEBVs","title":"Constrained Linear Genomic Selection Indices","text":"applying indices, first estimate genomic breeding values. use Ridge Regression (lm.ridge) MASS package rapid simple method simulate step linking marker data phenotype data.","code":"library(selection.index) library(MASS) # For Ridge regression  # Load the maize datasets data(\"maize_pheno\", package = \"selection.index\") data(\"maize_geno\", package = \"selection.index\")  # Extract only the traits we care about to prevent missing value logic failures traits <- c(\"Yield\", \"PlantHeight\", \"DaysToMaturity\") maize_pheno_clean <- na.omit(maize_pheno[, c(\"Genotype\", \"Block\", traits)])  # Calculate mean performance for phenotypic data # Providing only the traits to `data` to accurately generate the table pheno_means_full <- mean_performance(   data = maize_pheno_clean[, traits],   genotypes = maize_pheno_clean$Genotype,   replications = maize_pheno_clean$Block,   method = \"Mean\" )  # Remove the trailing 9 rows composed of summary text-stats automatically generated pheno_means <- pheno_means_full[1:(nrow(pheno_means_full) - 9), ]  # Extract numerical phenotype matrix Y <- as.matrix(pheno_means[, traits]) mode(Y) <- \"numeric\" rownames(Y) <- pheno_means$Genotypes  # Format genotype matrix X <- as.matrix(maize_geno)  # Ensure matching dimensions and align the matrices common_genotypes <- intersect(rownames(Y), rownames(X))  # Filter and sort matrices to match genotypes sequence exactly Y_filtered <- Y[common_genotypes, ] X_filtered <- X[common_genotypes, ]  # Calculate GEBVs using a simple Ridge Regression model per trait gebvs_sim <- matrix(0, nrow = nrow(Y_filtered), ncol = ncol(Y_filtered)) colnames(gebvs_sim) <- colnames(Y_filtered) rownames(gebvs_sim) <- rownames(Y_filtered) lambda_ridge <- 0.1  for (j in seq_len(ncol(Y_filtered))) {   # Fit ridge regression to simulate marker effects   model_ridge <- lm.ridge(Y_filtered[, j] ~ X_filtered, lambda = lambda_ridge)   beta_ridge <- coef(model_ridge)[-1]    # Predict GEBVs   gebvs_sim[, j] <- X_filtered %*% matrix(beta_ridge, ncol = 1) }  # Define Covariance Matrices Gamma <- cov(gebvs_sim) # Genomic Covariance Matrix estimated from simulated GEBVs P_matrix <- cov(Y_filtered) # Phenotypic Covariance Matrix C_matrix <- Gamma # Genetic Covariance (Assuming Gamma captures genetic additive cov)  # Define vector of economic weights for Yield, PlantHeight, DaysToMaturity w <- matrix(c(5, -0.1, -0.1), ncol = 1)"},{"path":"https://zankrut20.github.io/selection.index/articles/constrained-linear-genomic-selection-indices.html","id":"the-restricted-linear-genomic-selection-index-rlgsi","dir":"Articles","previous_headings":"","what":"6.1 The Restricted Linear Genomic Selection Index (RLGSI)","title":"Constrained Linear Genomic Selection Indices","text":"RLGSI applied testing population GEBVs available. goal maximize response traits restricting expected generic advance traits exactly zero.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/constrained-linear-genomic-selection-indices.html","id":"mathematical-definition","dir":"Articles","previous_headings":"6.1 The Restricted Linear Genomic Selection Index (RLGSI)","what":"Mathematical Definition","title":"Constrained Linear Genomic Selection Indices","text":"expected genetic advance RLGSI restricted : Cov(IRG,ùêî‚Ä≤ùê†)=ùêî‚Ä≤ùö™ùõÉRG=ùüéCov(I_{RG}, \\mathbf{U}'\\mathbf{g}) = \\mathbf{U}'\\boldsymbol{\\Gamma}\\boldsymbol{\\beta}_{RG} = \\mathbf{0}, ùêî‚Ä≤\\mathbf{U}' matrix 1s 0s identifying restricted traits. Following maximization step selection response, index coefficients ùõÉRG\\boldsymbol{\\beta}_{RG} optimally resolve : ùõÉRG=ùêäGùê∞ \\boldsymbol{\\beta}_{RG} = \\mathbf{K}_{G}\\mathbf{w}  ùêäG=[ùêà‚àíùêêG]\\mathbf{K}_{G} = [\\mathbf{} - \\mathbf{Q}_{G}] ùêêG=ùêî(ùêî‚Ä≤ùö™ùêî)‚àí1ùêî‚Ä≤ùö™\\mathbf{Q}_{G} = \\mathbf{U} (\\mathbf{U}' \\boldsymbol{\\Gamma} \\mathbf{U})^{-1} \\mathbf{U}' \\boldsymbol{\\Gamma}.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/constrained-linear-genomic-selection-indices.html","id":"rlgsi-implementation-example","dir":"Articles","previous_headings":"6.1 The Restricted Linear Genomic Selection Index (RLGSI)","what":"RLGSI Implementation Example","title":"Constrained Linear Genomic Selection Indices","text":"Suppose want maximize gain using three traits, want hold Plant Height Days Maturity completely fixed (00 gain). Notice output Expected Genetic Gain (Delta_H) traits 2 3 evaluates precision limit 00, fulfilling null-gain restriction.","code":"# Define the restriction matrix U # We restrict traits 2 (PlantHeight) and 3 (DaysToMaturity). # Trait 1 (Yield) is left unrestricted. U_rlgsi <- matrix(c(   0, 0, # Yield unrestricted   1, 0, # PlantHeight restricted   0, 1 # DaysToMaturity restricted ), nrow = 3, byrow = TRUE)  # Calculate RLGSI rlgsi_res <- rlgsi(Gamma = Gamma, wmat = w, U = U_rlgsi)  # View the resulting index coefficients and Expected Genetic Gain cat(\"RLGSI Coefficients (beta_RG):\\n\") #> RLGSI Coefficients (beta_RG): print(rlgsi_res$b) #> [1]    5.0000 -111.1516  175.9708  cat(\"\\nExpected Genetic Gain per Trait:\\n\") #>  #> Expected Genetic Gain per Trait: print(rlgsi_res$Summary[, \"Delta_H\", drop = FALSE]) #> NULL"},{"path":"https://zankrut20.github.io/selection.index/articles/constrained-linear-genomic-selection-indices.html","id":"the-predetermined-proportional-gain-linear-genomic-selection-index-ppg-lgsi","dir":"Articles","previous_headings":"","what":"6.2 The Predetermined Proportional Gain Linear Genomic Selection Index (PPG-LGSI)","title":"Constrained Linear Genomic Selection Indices","text":"Instead forcing trait remain fixed 00, might want trait‚Äôs mean value undergo highly specific, predefined amount selection shift.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/constrained-linear-genomic-selection-indices.html","id":"mathematical-definition-1","dir":"Articles","previous_headings":"6.2 The Predetermined Proportional Gain Linear Genomic Selection Index (PPG-LGSI)","what":"Mathematical Definition","title":"Constrained Linear Genomic Selection Indices","text":"Let ùêù‚Ä≤=[d1,d2,‚Ä¶,dr]\\mathbf{d}' = [d_1, d_2, \\ldots, d_r] proportional gain values requested breeder. Similar RLGSI, coefficient array evaluates identically targeted constant proportionality factor restricting expected proportional shifts: ùõÉPG=ùêäPùê∞ \\boldsymbol{\\beta}_{PG} = \\mathbf{K}_{P}\\mathbf{w}","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/constrained-linear-genomic-selection-indices.html","id":"ppg-lgsi-implementation-example","dir":"Articles","previous_headings":"6.2 The Predetermined Proportional Gain Linear Genomic Selection Index (PPG-LGSI)","what":"PPG-LGSI Implementation Example","title":"Constrained Linear Genomic Selection Indices","text":"Suppose want target Yield proportionally increase 7.07.0 units, identically target Plant Height slightly decrease relatively ‚àí3.0-3.0 proportion targets.","code":"# Define the restriction matrix U for PPG # Restrict traits 1 (Yield) and 2 (PlantHeight) to predetermined scalars U_ppg <- matrix(c(   1, 0, # Yield restricted   0, 1, # PlantHeight restricted   0, 0 # DaysToMaturity unrestricted ), nrow = 3, byrow = TRUE)  # Define the predetermined values vector 'd' d_vec <- matrix(c(7.0, -3.0), ncol = 1)  # Calculate PPG-LGSI ppg_res <- ppg_lgsi(Gamma = Gamma, d = d_vec, wmat = w, U = U_ppg)  cat(\"PPG-LGSI Coefficients (beta_PG):\\n\") #> PPG-LGSI Coefficients (beta_PG): print(ppg_res$b) #> [1]   0.2441 -11.1971  -0.1000"},{"path":"https://zankrut20.github.io/selection.index/articles/constrained-linear-genomic-selection-indices.html","id":"combined-restricted-linear-genomic-selection-index-crlgsi","dir":"Articles","previous_headings":"","what":"6.3 Combined Restricted Linear Genomic Selection Index (CRLGSI)","title":"Constrained Linear Genomic Selection Indices","text":"CRLGSI extends basic RLGSI integrating phenotypic information genomic breeding values structurally blocks combined index ICI_C. mainly applied training population joint data uniformly available. mathematical structure models parallel coefficient distributions across phenotypic genomic parameters uniformly: ùõÉCR=ùêäCùõÉC \\boldsymbol{\\beta}_{CR} = \\mathbf{K}_{C}\\boldsymbol{\\beta}_C index combining phenotypes GEBVs, restrictions must concurrently assigned empirical dimensions globally.","code":"# 1. Provide Combined Matrices # The combined Phenotypic-Genomic covariance matrix T_C T_C <- rbind(   cbind(P_matrix, Gamma),   cbind(Gamma, Gamma) )  # The combined Genetic-Genomic covariance matrix Psi_C Psi_C <- rbind(   cbind(C_matrix, Gamma),   cbind(Gamma, Gamma) )  # 2. Define Restriction Matrix U_C # Note: For combined indices of `t` traits, U_C spans exactly 2t rows. # Restricting Trait 1 (Yield) on both empirical and genomic parameters: U_crlgsi <- matrix(0, nrow = 6, ncol = 2) U_crlgsi[1, 1] <- 1 # Trait 1 phenotypic component U_crlgsi[4, 2] <- 1 # Trait 1 genomic component  # 3. Calculate CRLGSI crlgsi_res <- crlgsi(T_C = T_C, Psi_C = Psi_C, wmat = w, U = U_crlgsi)  cat(\"CRLGSI Combined Coefficients (beta_CR):\\n\") #> CRLGSI Combined Coefficients (beta_CR): print(crlgsi_res$b) #> [1] -6.843307e-05 -1.079212e-03 -5.103276e-02  2.017002e-03 -9.892085e-02 #> [6] -4.895374e-02"},{"path":"https://zankrut20.github.io/selection.index/articles/constrained-linear-genomic-selection-indices.html","id":"combined-predetermined-proportional-gain-linear-genomic-selection-index-cppg-lgsi","dir":"Articles","previous_headings":"","what":"6.4 Combined Predetermined Proportional Gain Linear Genomic Selection Index (CPPG-LGSI)","title":"Constrained Linear Genomic Selection Indices","text":"CPPG-LGSI combines dynamic proportional gain vectors TCT_C Œ®C\\Psi_C data blocks identically leveraging cppg_lgsi() logic.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/constrained-linear-genomic-selection-indices.html","id":"cppg-lgsi-implementation-example","dir":"Articles","previous_headings":"6.4 Combined Predetermined Proportional Gain Linear Genomic Selection Index (CPPG-LGSI)","what":"CPPG-LGSI Implementation Example","title":"Constrained Linear Genomic Selection Indices","text":"Suppose arbitrarily evaluate Yield predetermined restriction constants.","code":"# Target Yield using predetermined combined proportions d d_combined <- matrix(c(7.0, 3.5), ncol = 1)  # Calculate CPPG-LGSI dynamically cppg_res <- cppg_lgsi(T_C = T_C, Psi_C = Psi_C, d = d_combined, wmat = w, U = U_crlgsi)  cat(\"CPPG-LGSI Coefficients (beta_CP):\\n\") #> CPPG-LGSI Coefficients (beta_CP): print(cppg_res$b) #> [1]  4.491869e-06  7.083960e-05  3.349690e-03  4.998047e+00 -7.083568e-05 #> [6] -3.350577e-03"},{"path":"https://zankrut20.github.io/selection.index/articles/constrained-linear-genomic-selection-indices.html","id":"summary-comparison","dir":"Articles","previous_headings":"","what":"Summary Comparison","title":"Constrained Linear Genomic Selection Indices","text":"extract standard metrics associated index model (.e Selection Response RR):","code":"comparison_df <- data.frame(   Index = c(\"RLGSI\", \"PPG-LGSI\", \"CRLGSI\", \"CPPG-LGSI\"),   Selection_Response = c(     rlgsi_res$R,     ppg_res$R,     crlgsi_res$R,     cppg_res$R   ),   Overall_Genetic_Advance = c(     rlgsi_res$GA,     ppg_res$GA,     crlgsi_res$GA,     cppg_res$GA   ) )  print(comparison_df) #>       Index Selection_Response Overall_Genetic_Advance #> 1     RLGSI       1490.8413294            1490.8413294 #> 2  PPG-LGSI        102.6128081             102.9592598 #> 3    CRLGSI          0.9390596               0.9390601 #> 4 CPPG-LGSI       2123.2848118            2123.2848118"},{"path":"https://zankrut20.github.io/selection.index/articles/constrained-linear-phenotypic-selection-indices.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Constrained Linear Phenotypic Selection Indices","text":"linear phenotypic selection index (LPSI), null restricted LPSI (RLPSI), predetermined proportional gains LPSI (PPG-LPSI) main phenotypic selection indices used predict net genetic merit select parents next selection cycle. LPSI unrestricted index, whereas RLPSI PPG-LPSI allow restrictions equal zero predetermined proportional gain restrictions respectively imposed expected genetic gain values trait. One additional restricted index desired gains LPSI (DG-LPSI), require economic weights , similar manner PPG-LPSI, allows restrictions imposed expected genetic gain values trait based predetermined level. vignette, demonstrate theory practical application RLPSI, PPG-LPSI, DG-LPSI using selection.index package.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/constrained-linear-phenotypic-selection-indices.html","id":"sample-data-preparation","dir":"Articles","previous_headings":"Introduction","what":"Sample Data Preparation","title":"Constrained Linear Phenotypic Selection Indices","text":"use synthetic maize_pheno dataset built package calculate phenotypic genotypic variance-covariance matrices.","code":"library(selection.index)  # Load the built-in maize phenotype dataset data(\"maize_pheno\")  # Extract the traits of interest traits <- c(\"Yield\", \"PlantHeight\", \"DaysToMaturity\")  # Calculate Genotypic (gmat) and Phenotypic (pmat) covariance matrices gmat <- gen_varcov(maize_pheno[, traits], maize_pheno$Genotype, maize_pheno$Block) pmat <- phen_varcov(maize_pheno[, traits], maize_pheno$Genotype, maize_pheno$Block)  # Define economic weights for the three traits wmat <- weight_mat(data.frame(Trait = traits, Weight = c(1, -1, 1)))"},{"path":"https://zankrut20.github.io/selection.index/articles/constrained-linear-phenotypic-selection-indices.html","id":"the-null-restricted-linear-phenotypic-selection-index-rlpsi","dir":"Articles","previous_headings":"","what":"1. The Null Restricted Linear Phenotypic Selection Index (RLPSI)","title":"Constrained Linear Phenotypic Selection Indices","text":"main objective RLPSI optimize, null restrictions, selection response, predict net genetic merit H=ùê∞‚Ä≤ùê†H = \\mathbf{w}'\\mathbf{g}, select individuals highest net genetic merit values parents next generation. RLPSI allows restrictions equal zero imposed expected genetic gains traits. Assuming want minimize mean squared difference index II merit HH (E[(H‚àí)2]E[(H - )^2]) restriction ùêÇ‚Ä≤ùêõ=ùüé\\mathbf{C}'\\mathbf{b} = \\mathbf{0}, minimize following function: Œ®(ùêõ,ùêØ)=ùêõ‚Ä≤ùêèùêõ+ùê∞‚Ä≤ùêÜùê∞‚àí2ùê∞‚Ä≤ùêÜùêõ+2ùêØ‚Ä≤ùêÇ‚Ä≤ùêõ \\Psi \\left(\\mathbf{b},\\mathbf{v}\\right)={\\mathbf{b}}^{\\prime}\\mathbf{Pb}+{\\mathbf{w}}^{\\prime}\\mathbf{Gw}-2{\\mathbf{w}}^{\\prime}\\mathbf{Gb}+2{\\mathbf{v}}^{\\prime }{\\mathbf{C}}^{\\prime}\\mathbf{b} ùêÇ‚Ä≤=ùêî‚Ä≤ùêÜ\\mathbf{C}' = \\mathbf{U}'\\mathbf{G}, ùêî‚Ä≤\\mathbf{U}' matrix null restrictions, ùêØ\\mathbf{v} vector Lagrange multipliers. solution yields RLPSI vector coefficients: ùêõR=ùêäùêõ {\\mathbf{b}}_R=\\mathbf{Kb} ùêä=[ùêà‚àíùêê]\\mathbf{K} = [\\mathbf{} - \\mathbf{Q}], ùêê=ùêè‚àí1ùêÇ(ùêÇ‚Ä≤ùêè‚àí1ùêÇ)‚àí1ùêÇ‚Ä≤\\mathbf{Q} = \\mathbf{P}^{-1}\\mathbf{C}(\\mathbf{C}'\\mathbf{P}^{-1}\\mathbf{C})^{-1}\\mathbf{C}', ùêõ=ùêè‚àí1ùêÜùê∞\\mathbf{b} = \\mathbf{P}^{-1}\\mathbf{Gw} LPSI vector coefficients.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/constrained-linear-phenotypic-selection-indices.html","id":"practical-application-rlpsi","dir":"Articles","previous_headings":"1. The Null Restricted Linear Phenotypic Selection Index (RLPSI)","what":"Practical Application: RLPSI","title":"Constrained Linear Phenotypic Selection Indices","text":"Using rlpsi function, can constrain genetic gain certain traits strictly zero. instance, may want maximize overall gain ensuring Plant Height (trait #2) change. Notice expected genetic gain (Delta_G) 2nd trait effectively zero.","code":"# Restrict trait 2 (PHT) to have ZERO expected genetic gain rlpsi_res <- rlpsi(   pmat = pmat,   gmat = gmat,   wmat = wmat,   restricted_traits = c(2) )  # View the summary and coefficients print(rlpsi_res$summary) #>      b.1     b.2    b.3       GA      PRE  Delta_G    rHI    hI2 #> 1 0.0551 -3.3075 2.1743 108.2417 10824.17 108.2417 0.3153 0.0994  # View the expected genetic gains (Delta_G) print(rlpsi_res$Delta_G) #>          Yield    PlantHeight DaysToMaturity  #>   1.059783e+02  -1.709497e-08   2.263426e+00"},{"path":"https://zankrut20.github.io/selection.index/articles/constrained-linear-phenotypic-selection-indices.html","id":"the-predetermined-proportional-gains-linear-phenotypic-selection-index-ppg-lpsi","dir":"Articles","previous_headings":"","what":"2. The Predetermined Proportional Gains Linear Phenotypic Selection Index (PPG-LPSI)","title":"Constrained Linear Phenotypic Selection Indices","text":"Unlike RLPSI, predetermined proportional gains phenotypic selection index (PPG-LPSI) allows restrictions different zero imposed, ensuring traits gain strictly predefined proportions . Minimizing E[(H‚àí)2]E[(H - )^2] proportional restriction ùêå‚Ä≤ùêõ=0\\mathbf{M}'\\mathbf{b} = 0, ùêå‚Ä≤=ùêÉ‚Ä≤ùêÇ‚Ä≤\\mathbf{M}' = \\mathbf{D}'\\mathbf{C}' ùêÉ‚Ä≤\\mathbf{D}' Mallard (1972) matrix, leads : Œ¶(ùêõ,ùêØ)=ùêõ‚Ä≤ùêèùêõ+ùê∞‚Ä≤ùêÜùê∞‚àí2ùê∞‚Ä≤ùêÜùêõ+2ùêØ‚Ä≤ùêå‚Ä≤ùêõ \\Phi \\left(\\mathbf{b},\\mathbf{v}\\right)={\\mathbf{b}}^{\\prime}\\mathbf{Pb}+{\\mathbf{w}}^{\\prime}\\mathbf{Gw}-2{\\mathbf{w}}^{\\prime}\\mathbf{Gb}+2{\\mathbf{v}}^{\\prime }{\\mathbf{M}}^{\\prime}\\mathbf{b} vector minimizes mean squared error restriction : ùêõM=ùêäMùêõ {\\mathbf{b}}_M={\\mathbf{K}}_M\\mathbf{b} ùêäM=[ùêà‚àíùêêM]\\mathbf{K}_M = [\\mathbf{} - \\mathbf{Q}_M] ùêêM=ùêè‚àí1ùêå(ùêå‚Ä≤ùêè‚àí1ùêå)‚àí1ùêå‚Ä≤\\mathbf{Q}_M = \\mathbf{P}^{-1}\\mathbf{M}(\\mathbf{M}'\\mathbf{P}^{-1}\\mathbf{M})^{-1}\\mathbf{M}'. Alternatively, Tallis (1985) formulated using proportionality constant Œ∏\\theta: ùêõT=ùêõR+Œ∏ùõÖ {\\mathbf{b}}_{\\mathrm{T}}={\\mathbf{b}}_R+\\uptheta \\boldsymbol{\\updelta}","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/constrained-linear-phenotypic-selection-indices.html","id":"practical-application-ppg-lpsi","dir":"Articles","previous_headings":"2. The Predetermined Proportional Gains Linear Phenotypic Selection Index (PPG-LPSI)","what":"Practical Application: PPG-LPSI","title":"Constrained Linear Phenotypic Selection Indices","text":"ppg_lpsi function enforces desired proportional gains. Suppose want gains across three traits follow proportion 2 : 1 : 1. observe resulting Delta_G values, relative proportions approximate 2 : 1 : 1 ratio dictated k.","code":"# Specify the desired proportions k_proportions <- c(2, 1, 1)  # Calculate the PPG-LPSI ppg_res <- ppg_lpsi(pmat = pmat, gmat = gmat, k = k_proportions, wmat = wmat)  # View the expected genetic gains print(ppg_res$Delta_G) #>          Yield    PlantHeight DaysToMaturity  #>      700636.74       18363.40       10206.29"},{"path":"https://zankrut20.github.io/selection.index/articles/constrained-linear-phenotypic-selection-indices.html","id":"the-desired-gains-linear-phenotypic-selection-index-dg-lpsi","dir":"Articles","previous_headings":"","what":"3. The Desired Gains Linear Phenotypic Selection Index (DG-LPSI)","title":"Constrained Linear Phenotypic Selection Indices","text":"desired gains linear phenotypic selection index (DG-LPSI) unique require economic weights ùê∞\\mathbf{w}. Instead, breeder specifies exact desired target genetic gains ùêù\\mathbf{d} directly. expected genetic gain ùêÑ=kIùêÜùêõœÉI\\mathbf{E} = k_I \\frac{\\mathbf{Gb}}{\\sigma_I}, set ùêÜùêõ=ùêù\\mathbf{Gb} = \\mathbf{d}, want minimize variance index œÉI\\sigma_I subject ùêÜùêõ=ùêù\\mathbf{Gb} = \\mathbf{d} maximize ùêÑ\\mathbf{E}: Œ¶DG(ùêõ,ùêØ)=0.5(ùêõ‚Ä≤ùêèùêõ)+ùêØ‚Ä≤(ùêÜùêõ‚àíùêù) {\\Phi}_{DG}\\left(\\mathbf{b},\\mathbf{v}\\right)=\\mathbf{0.5}\\left({\\mathbf{b}}^{\\prime}\\mathbf{Pb}\\right)+{\\mathbf{v}}^{\\prime}\\left(\\mathbf{Gb}-\\mathbf{d}\\right) Solving yields DG-LPSI vector coefficients: ùêõDG=ùêè‚àí1ùêÜ(ùêÜùêè‚àí1ùêÜ)‚àí1ùêù {\\mathbf{b}}_{DG}={\\mathbf{P}}^{-1}\\mathbf{G}{\\left({\\mathbf{GP}}^{-1}\\mathbf{G}\\right)}^{-1}\\mathbf{d}","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/constrained-linear-phenotypic-selection-indices.html","id":"practical-application-dg-lpsi","dir":"Articles","previous_headings":"3. The Desired Gains Linear Phenotypic Selection Index (DG-LPSI)","what":"Practical Application: DG-LPSI","title":"Constrained Linear Phenotypic Selection Indices","text":"can run dg_lpsi function solely based desired absolute gains. Let‚Äôs aim increase Yield 5 units, decrease Plant Height 2 units, increase Days Maturity 1 unit. output gives us selection index coefficients ùêõ\\mathbf{b} achieve target gains, well implied economic weights showing ‚Äúabsolute cost‚Äù relative importance required achieve gains.","code":"# Explicit vector of desired absolute genetic gains desired_gains <- c(5, -2, 1)  # Calculate DG-LPSI dg_res <- dg_lpsi(pmat = pmat, gmat = gmat, d = desired_gains)  # Check the achieved proportional genetic gains print(dg_res$Delta_G) #>          Yield    PlantHeight DaysToMaturity  #>      3.3431312     -1.3372525      0.6686262  # The DG-LPSI also calculates implied Smith-Hazel economic weights print(dg_res$implied_weights_normalized) #>          Yield    PlantHeight DaysToMaturity  #>    -0.01969999     0.19583750     1.00000000"},{"path":[]},{"path":"https://zankrut20.github.io/selection.index/articles/constrained-linear-phenotypic-selection-indices.html","id":"statistical-properties-and-efficiency-trade-offs","dir":"Articles","previous_headings":"4. Advanced Concepts and Trade-offs","what":"4.1 Statistical Properties and Efficiency Trade-offs","title":"Constrained Linear Phenotypic Selection Indices","text":"Imposing restrictions index inherently limits potential maximize overall selection response RRR_R. selection.index package allows evaluate ‚Äúcost restriction‚Äù calculating relative selection efficiency (PRE - Percentage Response Efficiency) heritability (hI2) constrained index versus unconstrained equivalent. reviewing summary data frame output indices : - rHI: correlation constrained index true net genetic merit (HH). restrictions added, correlation decreases. - PRE: Shows expected genetic advance relative base index. Constrained indices universally show lower PRE unconstrained LPSI counterpart.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/constrained-linear-phenotypic-selection-indices.html","id":"manual-constraint-matrix-construction","dir":"Articles","previous_headings":"4. Advanced Concepts and Trade-offs","what":"4.2 Manual Constraint Matrix Construction","title":"Constrained Linear Phenotypic Selection Indices","text":"default, rlpsi() ppg_lpsi() accept user-friendly arguments like restricted_traits = c(2) k = c(2, 1, 1) automatically construct mathematical constraint matrices behind scenes. However, advanced users may wish manually define matrices, particularly complex scenarios. RLPSI, constraint matrix ùêÇ\\mathbf{C} t√órt \\times r matrix (tt number traits rr number restrictions). column represents restricted trait 1 restricted index 0s elsewhere: ppg_lpsi() function automatically manages complex proportional constraint matrix based inputs ùê§\\mathbf{k}, guaranteeing proportional relationship ŒîùêÜ=œïùê§\\Delta \\mathbf{G} = \\phi\\mathbf{k}.","code":"# Manually restrict traits #1 and #3: # Create a 3x2 constraint matrix C_matrix <- matrix(   c(     1, 0, 0, # Restrict trait 1     0, 0, 1   ), # Restrict trait 3   nrow = 3, ncol = 2 )  # Pass directly to RLPSI rlpsi_manual <- rlpsi(pmat = pmat, gmat = gmat, wmat = wmat, C = C_matrix) print(rlpsi_manual$Delta_G) #>          Yield    PlantHeight DaysToMaturity  #>    -0.01072495    -2.76848253     0.74035593"},{"path":"https://zankrut20.github.io/selection.index/articles/constrained-linear-phenotypic-selection-indices.html","id":"applicability-limitations-hazel-1943","dir":"Articles","previous_headings":"4. Advanced Concepts and Trade-offs","what":"4.3 Applicability Limitations (Hazel, 1943)","title":"Constrained Linear Phenotypic Selection Indices","text":"indices powerful predictive models, real-world applicability operates limitations established classical breeding theory (Hazel, 1943): Economic Variability: Relative economic values (ùê∞\\mathbf{w}) fluctuate location, market demand, enterprise goals. Genetic Context: given genetic covariance matrix (ùêÜ\\mathbf{G}) specific mating system breeding population evaluated. Environmental Variance: Phenotypic standard deviations (ùêè\\mathbf{P}) differ among environments management practices. Sampling Error: Small datasets fail provide reliable genetic variance constants required form precise predictive indices.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/constrained-linear-phenotypic-selection-indices.html","id":"conclusion","dir":"Articles","previous_headings":"","what":"Conclusion","title":"Constrained Linear Phenotypic Selection Indices","text":"selection.index package provides highly flexible options beyond simple unrestricted index. RLPSI useful strictly zero-change bounds needed specific traits. PPG-LPSI caters breeders focusing strict multi-trait improvement ratio. Finally, DG-LPSI provides powerful alternative scenarios economic weights notoriously difficult estimate, ideal target gains known. using constrained models, breeders must continuously balance specific phenotypic goals intrinsic statistical costs overall genetic efficiency.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/getting-started.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Getting Started with selection.index","text":"selection.index package provides optimized suite tools calculate multi-trait phenotypic, genomic, multistage selection indices. simplifies plant animal breeding workflows enabling breeders accurately rank genotypes based user-defined economic weights experimental designs.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/getting-started.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Getting Started with selection.index","text":"First, load package built-phenotypic dataset. package supports standard multi-environment phenotypic data, use included seldata dataset (built-multi-environment trial dataset genotypes) quick-start guide.","code":"library(selection.index)  # Load the built-in phenotypic dataset data(\"seldata\")  # Inspect the structure of the dataset head(seldata) #>   rep treat   sypp     dtf    rpp    ppr     ppp    spp     pw #> 1   1    G1 5.4306 42.5000 2.8333 2.0085  7.5833 2.7020 0.5523 #> 2   2    G1 5.4583 42.5000 3.2000 3.7179  7.8000 2.5152 0.7431 #> 3   3    G1 5.5278 43.3333 3.1250 4.2023  7.6111 3.0976 0.7473 #> 4   1    G2 6.3250 43.3333 1.7500 3.0897  3.1000 2.6515 0.4824 #> 5   2    G2 5.8333 43.3333 3.0500 3.7692 14.6500 3.2121 0.6804 #> 6   3    G2 7.9074 43.3333 3.2778 3.6752 12.0000 3.0640 0.6471"},{"path":"https://zankrut20.github.io/selection.index/articles/getting-started.html","id":"the-basics","dir":"Articles","previous_headings":"","what":"The Basics","title":"Getting Started with selection.index","text":"calculate selection index, must specify traits interest, assign economic weights, compute genotypic phenotypic variance-covariance matrices.","code":"# Define economic weights for the 7 traits of interest weights <- c(10, 8, 6, 4, 2, 1, 1)  # Calculate genotypic and phenotypic variance-covariance matrices # Traits: columns 3:9, Genotypes: column 2, Replication: column 1 gmat <- gen_varcov(data = seldata[, 3:9], genotypes = seldata[, 2], replication = seldata[, 1]) pmat <- phen_varcov(data = seldata[, 3:9], genotypes = seldata[, 2], replication = seldata[, 1])"},{"path":"https://zankrut20.github.io/selection.index/articles/getting-started.html","id":"execution","dir":"Articles","previous_headings":"","what":"Execution","title":"Getting Started with selection.index","text":"matrices weights defined, pass primary selection function. use lpsi() compute Combinatorial Linear Phenotypic Selection Index traits. , setting ncomb = 7 calculates index considering 7 traits simultaneously.","code":"# Calculate the combinatorial selection index for all 7 traits index_results <- lpsi(   ncomb = 7,   pmat = pmat,   gmat = gmat,   wmat = as.matrix(weights),   wcol = 1 )"},{"path":"https://zankrut20.github.io/selection.index/articles/getting-started.html","id":"results","dir":"Articles","previous_headings":"","what":"Results","title":"Getting Started with selection.index","text":"index computed, review genetic advance metrics extract final selection scores identify top-performing genotypes. index_results data frame containing index coefficients (b columns) various genetic metrics (GA, PRE, Delta_G, rHI).","code":"# View the calculated index metrics for our 7-trait combination head(index_results) #>                    ID    b.1    b.2    b.3    b.4    b.5    b.6     b.7      GA #> 1 1, 2, 3, 4, 5, 6, 7 1.0966 1.7309 7.0056 3.2702 0.0596 6.5862 11.5951 21.3233 #>        PRE Delta_G    rHI    hI2 Rank #> 1 2132.327 21.3233 0.5412 0.2689    1  # Extract the final selection scores to rank the genotypes scores <- predict_selection_score(   index_results,   data = seldata[, 3:9],   genotypes = seldata[, 2] )  # View the top ranked genotypes based on their selection scores head(scores) #>   Genotypes I_1_2_3_4_5_6_7 I_1_2_3_4_5_6_7_Rank #> 1        G1        138.8605                   14 #> 2        G2        139.8725                   12 #> 3        G3        134.0505                   21 #> 4        G4        142.2628                    8 #> 5        G5        141.1228                   10 #> 6        G6        136.8680                   18"},{"path":"https://zankrut20.github.io/selection.index/articles/linear-genomic-eigen-selection-index-methods.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Linear Genomic Eigen Selection Index Methods","text":"vignette provides overview linear molecular genomic eigen selection index methods, integrate marker trait data genome-wide marker values calculation. Methods covered include Molecular Eigen Selection Index Method (MESIM), Genomic Eigen Selection Index Method (GESIM), Genome-Wide Linear Eigen Selection Index Method (GW-ESIM), Restricted Genomic Eigen Selection Index Method (RGESIM), Predetermined Proportional Gain Genomic Eigen Selection Index Method (PPG-GESIM).","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/linear-genomic-eigen-selection-index-methods.html","id":"setup-data-matrices","dir":"Articles","previous_headings":"","what":"Setup Data Matrices","title":"Linear Genomic Eigen Selection Index Methods","text":"","code":"library(selection.index)  # Load standard phenotype dataset data(maize_pheno)  # Define traits and design variables traits <- c(\"Yield\", \"PlantHeight\", \"DaysToMaturity\") env_col <- \"Environment\" genotype_col <- \"Genotype\"  # Phenotypic variance-covariance matrix (P) pmat <- phen_varcov(maize_pheno[, traits], maize_pheno[[genotype_col]], maize_pheno[[env_col]])  # Genetic variance-covariance matrix (G) gmat <- gen_varcov(maize_pheno[, traits], maize_pheno[[genotype_col]], maize_pheno[[env_col]])  # For the sake of demonstration within this vignette, we simulate the required molecular/genomic variance components: set.seed(42)  # Simulate Gamma: Covariance between phenotypes and GEBVs Gamma <- gmat * 0.85  # Molecular matrices for MESIM S_M <- gmat * 0.75 # Covariance between phenotypic values and marker scores S_Mg <- gmat * 0.70 # Covariance between genotypic values and marker scores S_var <- gmat * 0.80 # Variance-covariance of marker scores  # Genomic matrices for GW-ESIM G_M <- gmat * 0.82 # Covariance between true genotypic values and marker values M <- gmat * 0.90 # Variance-covariance matrix of markers"},{"path":"https://zankrut20.github.io/selection.index/articles/linear-genomic-eigen-selection-index-methods.html","id":"the-molecular-eigen-selection-index-method-mesim","dir":"Articles","previous_headings":"","what":"The Molecular Eigen Selection Index Method (MESIM)","title":"Linear Genomic Eigen Selection Index Methods","text":"MESIM index integrates marker scores directly: =Œ≤‚Ä≤yùê≤+Œ≤‚Ä≤sùê¨=[Œ≤‚Ä≤yŒ≤‚Ä≤s][ùê≤ùê¨]=Œ≤‚Ä≤ùê≠ = \\beta'_{y}\\mathbf{y} + \\beta'_{s}\\mathbf{s} = \\begin{bmatrix} \\beta'_{y} & \\beta'_{s} \\end{bmatrix} \\begin{bmatrix} \\mathbf{y} \\\\ \\mathbf{s} \\end{bmatrix} = \\beta'\\mathbf{t} optimum coefficients calculated effectively primary eigenvector resulting maximization function: (ùêì‚àí1ùöø‚àíŒªM2ùêà2t)Œ≤M=ùüé (\\mathbf{T}^{-1}\\mathbf{\\Psi} - \\lambda^2_{M}\\mathbf{}_{2t})\\beta_M = \\mathbf{0} Using mesim function:","code":"mes_index <- mesim(pmat, gmat, S_M, S_Mg, S_var) summary(mes_index) #>  #> ============================================================== #> MOLECULAR EIGEN SELECTION INDEX METHOD (MESIM) #> Ceron-Rojas & Crossa (2018) - Chapter 8, Section 8.1 #> ============================================================== #>  #> Selection intensity (k_I): 2.063  #> Number of traits:          3  #>  #> ------------------------------------------------------------- #> INDEX METRICS #> ------------------------------------------------------------- #>   lambda_M^2 (h^2_I):     1.000798 #>   Accuracy (r_HI):        1.000399 #>   Index Std Dev (sigma_I): 6.315343 #>   Selection Response (R_M): 13.028553 #>  #> ------------------------------------------------------------- #> PHENOTYPE COEFFICIENTS (b_y) #> ------------------------------------------------------------- #>           Trait       b_y #>           Yield  0.000162 #>     PlantHeight -0.010260 #>  DaysToMaturity  0.007350 #>  #> ------------------------------------------------------------- #> MARKER SCORE COEFFICIENTS (b_s) #> ------------------------------------------------------------- #>           Trait       b_s #>           Yield -0.012821 #>     PlantHeight  0.812791 #>  DaysToMaturity -0.582277 #>  #> ------------------------------------------------------------- #> EXPECTED GENETIC GAINS PER TRAIT (E_M) #> ------------------------------------------------------------- #>           Trait        E_M #>           Yield 165.154061 #>     PlantHeight  16.311970 #>  DaysToMaturity  -0.538044 #>  #> ============================================================== #> SUMMARY TABLE #> ============================================================== #>  #>     b_y.1    b_y.2   b_y.3     b_s.1    b_s.2     b_s.3      hI2      rHI #>  0.000162 -0.01026 0.00735 -0.012821 0.812791 -0.582277 1.000798 1.000399 #>   sigma_I      R_M  lambda2 #>  6.315343 13.02855 1.000798"},{"path":"https://zankrut20.github.io/selection.index/articles/linear-genomic-eigen-selection-index-methods.html","id":"the-linear-genomic-eigen-selection-index-method-gesim","dir":"Articles","previous_headings":"","what":"The Linear Genomic Eigen Selection Index Method (GESIM)","title":"Linear Genomic Eigen Selection Index Methods","text":"GESIM incorporates Genomic Estimated Breeding Values (GEBVs, denoted Œ≥\\gamma): =Œ≤‚Ä≤yùê≤+Œ≤‚Ä≤Œ≥ùõÑ=[Œ≤‚Ä≤yŒ≤‚Ä≤Œ≥][ùê≤ùõÑ]=Œ≤‚Ä≤ùêü = \\beta'_{y}\\mathbf{y} + \\beta'_{\\gamma}\\mathbf{\\gamma} = \\begin{bmatrix} \\beta'_{y} & \\beta'_{\\gamma} \\end{bmatrix} \\begin{bmatrix} \\mathbf{y} \\\\ \\mathbf{\\gamma} \\end{bmatrix} = \\beta'\\mathbf{f} optimum index coefficients first eigenvector : (ùöΩ‚àí1ùêÄ‚àíŒªG2ùêà2t)Œ≤G=ùüé (\\mathbf{\\Phi}^{-1}\\mathbf{} - \\lambda^2_{G}\\mathbf{}_{2t})\\beta_G = \\mathbf{0} Using gesim function:","code":"ges_index <- gesim(pmat, gmat, Gamma) summary(ges_index) #>  #> ============================================================== #> LINEAR GENOMIC EIGEN SELECTION INDEX METHOD (GESIM) #> Ceron-Rojas & Crossa (2018) - Chapter 8, Section 8.2 #> ============================================================== #>  #> Selection intensity (k_I): 2.063  #> Number of traits:          3  #>  #> ------------------------------------------------------------- #> INDEX METRICS #> ------------------------------------------------------------- #>   lambda_G^2 (h^2_I):     1.000000 #>   Accuracy (r_HI):        1.000000 #>   Index Std Dev (sigma_I): 18221.926505 #>   Selection Response (R_G): 37591.834380 #>  #> ------------------------------------------------------------- #> PHENOTYPE COEFFICIENTS (b_y) #> ------------------------------------------------------------- #>           Trait b_y #>           Yield   0 #>     PlantHeight   0 #>  DaysToMaturity   0 #>  #> ------------------------------------------------------------- #> GEBV COEFFICIENTS (b_gamma) #> ------------------------------------------------------------- #>           Trait b_gamma #>           Yield       1 #>     PlantHeight       0 #>  DaysToMaturity       0 #>  #> ------------------------------------------------------------- #> EXPECTED GENETIC GAINS PER TRAIT (E_G) #> ------------------------------------------------------------- #>           Trait        E_G #>           Yield 37591.8344 #>     PlantHeight   985.3145 #>  DaysToMaturity   547.5454 #>  #> ------------------------------------------------------------- #> IMPLIED ECONOMIC WEIGHTS (w_G) #> ------------------------------------------------------------- #>           Trait Implied_w #>           Yield  0.000255 #>     PlantHeight -0.011029 #>  DaysToMaturity  0.002325 #>  #> ============================================================== #> SUMMARY TABLE #> ============================================================== #>  #>  b_y.1 b_y.2 b_y.3 b_gamma.1 b_gamma.2 b_gamma.3 hI2 rHI  sigma_I      R_G #>      0     0     0         1         0         0   1   1 18221.93 37591.83 #>  lambda2 #>        1"},{"path":"https://zankrut20.github.io/selection.index/articles/linear-genomic-eigen-selection-index-methods.html","id":"the-genome-wide-linear-eigen-selection-index-method-gw-esim","dir":"Articles","previous_headings":"","what":"The Genome-Wide Linear Eigen Selection Index Method (GW-ESIM)","title":"Linear Genomic Eigen Selection Index Methods","text":"high-density markers covering whole genome available, GW-ESIM formulation estimates genetic potential uniformly across entire marker panel. Using gw_esim function:","code":"gw_index <- gw_esim(pmat, gmat, G_M, M) summary(gw_index) #>  #> ============================================================== #> GENOME-WIDE LINEAR EIGEN SELECTION INDEX METHOD (GW-ESIM) #> Ceron-Rojas & Crossa (2018) - Chapter 8, Section 8.3 #> ============================================================== #>  #> Selection intensity (k_I): 2.063  #> Number of traits:          3  #> Number of markers:         3  #>  #> ------------------------------------------------------------- #> INDEX METRICS #> ------------------------------------------------------------- #>   lambda_W^2 (h^2_I):     1.000000 #>   Accuracy (r_HI):        1.000000 #>   Index Std Dev (sigma_I): 18750.207685 #>   Selection Response (R_W): 38681.678454 #>  #> ------------------------------------------------------------- #> PHENOTYPE COEFFICIENTS (b_y) #> ------------------------------------------------------------- #>           Trait b_y #>           Yield   0 #>     PlantHeight   0 #>  DaysToMaturity   0 #>  #> ------------------------------------------------------------- #> MARKER COEFFICIENTS (b_m) - First 10 #> ------------------------------------------------------------- #>  Marker b_m #>       1   1 #>       2   0 #>       3   0 #>  #> ------------------------------------------------------------- #> EXPECTED GENETIC GAINS PER TRAIT (E_W) #> ------------------------------------------------------------- #>           Trait        E_W #>           Yield 35243.3070 #>     PlantHeight   923.7575 #>  DaysToMaturity   513.3379 #>  #> ============================================================== #> SUMMARY TABLE #> ============================================================== #>  #>  n_traits n_markers hI2 rHI  sigma_I      R_W lambda2 #>         3         3   1   1 18750.21 38681.68       1"},{"path":"https://zankrut20.github.io/selection.index/articles/linear-genomic-eigen-selection-index-methods.html","id":"the-restricted-linear-genomic-eigen-selection-index-method-rgesim","dir":"Articles","previous_headings":"","what":"The Restricted Linear Genomic Eigen Selection Index Method (RGESIM)","title":"Linear Genomic Eigen Selection Index Methods","text":"RGESIM enables breeders impose constraints particular traits expected genetic advancements zero, employing genomic capability GESIM. Using rgesim function restrict improvements Ear_Height (second trait):","code":"# Restrict the second trait (PlantHeight) U_mat <- matrix(c(0, 1, 0), nrow = 1) rges_index <- rgesim(pmat, gmat, Gamma, U_mat) summary(rges_index) #>  #> ============================================================== #> RESTRICTED LINEAR GENOMIC EIGEN SELECTION INDEX (RGESIM) #> Ceron-Rojas & Crossa (2018) - Chapter 8, Section 8.4 #> ============================================================== #>  #> Selection intensity (k_I): 2.063  #> Number of traits:          3  #> Number of restrictions:    1  #>  #> ------------------------------------------------------------- #> INDEX METRICS #> ------------------------------------------------------------- #>   lambda_RG^2 (h^2_I):    1.000000 #>   Accuracy (r_HI):        1.000000 #>   Index Std Dev (sigma_I): 6.999294 #>   Selection Response (R_RG): 14.439543 #>  #> ------------------------------------------------------------- #> PHENOTYPE COEFFICIENTS (b_y) #> ------------------------------------------------------------- #>           Trait b_y #>           Yield   0 #>     PlantHeight   0 #>  DaysToMaturity   0 #>  #> ------------------------------------------------------------- #> GEBV COEFFICIENTS (b_gamma) #> ------------------------------------------------------------- #>           Trait   b_gamma #>           Yield -0.026207 #>     PlantHeight  0.999657 #>  DaysToMaturity  0.000000 #>  #> ------------------------------------------------------------- #> EXPECTED GENETIC GAINS PER TRAIT (E_RG) #> ------------------------------------------------------------- #>           Trait       E_RG #>           Yield -550.97005 #>     PlantHeight    0.00000 #>  DaysToMaturity  -10.82068 #>  #> ------------------------------------------------------------- #> CONSTRAINT VERIFICATION #> ------------------------------------------------------------- #> Constrained response (should be near zero): #> [1] 0 #>  #> ------------------------------------------------------------- #> IMPLIED ECONOMIC WEIGHTS (w_RG) #> ------------------------------------------------------------- #>           Trait Implied_w #>           Yield -0.011032 #>     PlantHeight  0.476755 #>  DaysToMaturity -0.100501 #>  #> ============================================================== #> SUMMARY TABLE #> ============================================================== #>  #>  b_y.1 b_y.2 b_y.3 b_gamma.1 b_gamma.2 b_gamma.3 hI2 rHI  sigma_I     R_RG #>      0     0     0 -0.026207  0.999657         0   1   1 6.999294 14.43954 #>  lambda2 #>        1"},{"path":"https://zankrut20.github.io/selection.index/articles/linear-genomic-eigen-selection-index-methods.html","id":"the-predetermined-proportional-gain-linear-genomic-eigen-selection-index-method-ppg-gesim","dir":"Articles","previous_headings":"","what":"The Predetermined Proportional Gain Linear Genomic Eigen Selection Index Method (PPG-GESIM)","title":"Linear Genomic Eigen Selection Index Methods","text":"approach aims acquire customized genetic gains according relative priority proportion assigned distinctly trait. (ùêìPG‚àíŒªPG2ùêà2t)Œ≤PG=ùüé (\\mathbf{T}_{PG} - \\lambda^2_{PG}\\mathbf{}_{2t})\\beta_{PG} = \\mathbf{0} Using ppg_gesim function relative gains heavily weighted towards Yield (trait 3) Days_To_Silking (trait 4):","code":"# Desired genetic gain proportions: 1 for Yield, 0.5 for DaysToMaturity, 0 for others d <- c(1, 0, 0.5) ppg_ges_index <- ppg_gesim(pmat, gmat, Gamma, d) summary(ppg_ges_index) #>  #> ============================================================== #> PREDETERMINED PROPORTIONAL GAIN GENOMIC EIGEN INDEX (PPG-GESIM) #> Ceron-Rojas & Crossa (2018) - Chapter 8, Section 8.5 #> ============================================================== #>  #> Selection intensity (k_I): 2.063  #> Number of traits:          3  #>  #> ------------------------------------------------------------- #> DESIRED PROPORTIONAL GAINS (d) #> ------------------------------------------------------------- #>           Trait   d #>           Yield 1.0 #>     PlantHeight 0.0 #>  DaysToMaturity 0.5 #>  #> ------------------------------------------------------------- #> INDEX METRICS #> ------------------------------------------------------------- #>   lambda_PG^2 (h^2_I):    3.500000 #>   Accuracy (r_HI):        1.870829 #>   Index Std Dev (sigma_I): 2056.464205 #>   Selection Response (R_PG): 4242.485656 #>  #> ------------------------------------------------------------- #> PHENOTYPE COEFFICIENTS (b_y) #> ------------------------------------------------------------- #>           Trait       b_y #>           Yield -0.001616 #>     PlantHeight  0.019492 #>  DaysToMaturity -0.610526 #>  #> ------------------------------------------------------------- #> GEBV COEFFICIENTS (b_gamma) #> ------------------------------------------------------------- #>           Trait  b_gamma #>           Yield 0.111810 #>     PlantHeight 0.002665 #>  DaysToMaturity 0.783816 #>  #> ------------------------------------------------------------- #> EXPECTED GENETIC GAINS PER TRAIT (E_PG) #> ------------------------------------------------------------- #>           Trait       E_PG #>           Yield 37151.3513 #>     PlantHeight   973.7697 #>  DaysToMaturity   541.1297 #>  #> ------------------------------------------------------------- #> PROPORTIONAL GAIN VERIFICATION #> ------------------------------------------------------------- #> Gain ratios (E_PG / d) - should be approximately constant: #>           Trait     Ratio #>           Yield 37151.351 #>     PlantHeight        NA #>  DaysToMaturity  1082.259 #> Standard deviation of ratios: 25504.7  #>  #> ------------------------------------------------------------- #> IMPLIED ECONOMIC WEIGHTS (w_PG) #> ------------------------------------------------------------- #>           Trait Implied_w #>           Yield  0.046996 #>     PlantHeight -0.015539 #>  DaysToMaturity  0.004212 #>  #> ============================================================== #> SUMMARY TABLE #> ============================================================== #>  #>      b_y.1    b_y.2     b_y.3 b_gamma.1 b_gamma.2 b_gamma.3 hI2      rHI #>  -0.001616 0.019492 -0.610526   0.11181  0.002665  0.783816 3.5 1.870829 #>   sigma_I     R_PG lambda2 #>  2056.464 4242.486     3.5"},{"path":"https://zankrut20.github.io/selection.index/articles/linear-genomic-eigen-selection-index-methods.html","id":"statistical-properties-and-efficiency","dir":"Articles","previous_headings":"","what":"Statistical Properties and Efficiency","title":"Linear Genomic Eigen Selection Index Methods","text":"Just phenotypic standard molecular selection indices, efficiency Genomic Eigen Selection Indices can evaluated via accuracy (œÅHI\\rho_{HI}), maximized selection response (RR), expected genetic gain per trait (EE). MESIM index, parameters formulated estimating standard deviations true genetic merit (œÉH\\sigma_H) given index (œÉI\\sigma_I). maximum accuracy obtained canonical correlation (ŒªM\\lambda_M) corresponds directly square root primary eigenvalue: œÅHMIM=Œ≤‚Ä≤MùêìMŒ≤MŒ≤‚Ä≤MùêìMùöøM‚àí1ùêìMŒ≤M=œÉIMœÉHM \\rho_{H_MI_M} = \\frac{\\sqrt{\\beta'_{M}\\mathbf{T}_M\\beta_M}}{\\sqrt{\\beta'_{M}\\mathbf{T}_M\\mathbf{\\Psi}_M^{-1}\\mathbf{T}_M\\beta_M}} = \\frac{\\sigma_{I_M}}{\\sigma_{H_M}} selection response obtained using standardized selection intensity factor (kIk_I): RM=kIŒ≤‚Ä≤M1ùêìMŒ≤M1 R_M = k_I \\sqrt{\\beta'_{M_1}\\mathbf{T}_M\\beta_{M_1}} Expected genetic gain per trait can calculated accordingly: ùêÑM=kIùöøMŒ≤M1Œ≤‚Ä≤M1ùêìMŒ≤M1 \\mathbf{E}_M = k_I \\frac{\\mathbf{\\Psi}_M\\beta_{M_1}}{\\sqrt{\\beta'_{M_1}\\mathbf{T}_M\\beta_{M_1}}}","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/linear-genomic-selection-indices.html","id":"abstract","dir":"Articles","previous_headings":"","what":"Abstract","title":"Linear Genomic Selection Indices","text":"linear genomic selection index (LGSI) linear combination genomic estimated breeding values (GEBVs) used predict individual net genetic merit select individual candidates non-phenotyped testing population parents next selection cycle. LGSI, phenotypic marker data training population fitted statistical model estimate individual genome marker effects; estimates can used subsequent selection cycles obtain GEBVs predictors breeding values testing population marker information. Applying LGSI requires predicting ranking net genetic merit candidates selection using marker information. combined LGSI (CLGSI), conversely, uses phenotypic GEBV information jointly predict net genetic merit. CLGSI typically used training populations estimate true merit. vignette covers calculating LGSI CLGSI using selection.index package.","code":""},{"path":[]},{"path":"https://zankrut20.github.io/selection.index/articles/linear-genomic-selection-indices.html","id":"basic-conditions-for-constructing-the-lgsi","dir":"Articles","previous_headings":"5.1 The Linear Genomic Selection Index","what":"Basic Conditions for Constructing the LGSI","title":"Linear Genomic Selection Indices","text":"construct valid LGSI, four essential conditions must met: 1. marker effects must estimated simultaneously training population. 2. estimated marker effects must used subsequent selection cycles obtain GEBVs act predictors individual breeding values testing population (marker information). 3. GEBV values must composed entirely additive genetic effects. 4. Phenotypes must used estimate marker effects training population, make selections testing population (Heffner et al., 2009; Lorenz et al., 2011).","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/linear-genomic-selection-indices.html","id":"the-lgsi-and-its-parameters","dir":"Articles","previous_headings":"5.1 The Linear Genomic Selection Index","what":"The LGSI and Its Parameters","title":"Linear Genomic Selection Indices","text":"objective LGSI predict net genetic merit H=ùê∞‚Ä≤ùê†H = \\mathbf{w}'\\mathbf{g}, ùê†\\mathbf{g} vector unobservable true breeding values, ùê∞\\mathbf{w} vector economic weights. Let ùõÑ\\mathbf{\\gamma} vector known Genomic Estimated Breeding Values (GEBVs). basic LGSI equation : IG=ùõÉ‚Ä≤ùõÑ {}_{\\mathrm{G}}={\\boldsymbol{\\beta}}^{\\prime}\\boldsymbol{\\gamma} ùõÉ\\boldsymbol{\\beta} unknown variable vector optimal weights. LGSI, shown maximizing accuracy œÅHIG\\rho_{HI_G} results simply ùõÉ=ùê∞\\boldsymbol{\\beta} = \\mathbf{w}. main advantage LGSI conventional Linear Phenotypic Selection Index (LPSI) lies possibility reducing intervals selection cycles roughly 4 years 1.5 years plant breeding. selection response equation adjusts cycle length LGL_G: RIG=kILGùê∞‚Ä≤ùö™ùê∞ {R}_{I_G}=\\frac{k_I}{L_G}\\sqrt{{\\mathbf{w}}^{\\prime}\\boldsymbol{\\Gamma} \\mathbf{w}}  ùö™\\boldsymbol{\\Gamma} covariance matrix GEBVs.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/linear-genomic-selection-indices.html","id":"statistical-lgsi-properties","dir":"Articles","previous_headings":"5.1 The Linear Genomic Selection Index","what":"Statistical LGSI Properties","title":"Linear Genomic Selection Indices","text":"LGSI operates direct genomic extension LPSI theory, retaining exact statistical properties: 1. variance IGI_G (œÉIG2\\sigma_{I_G}^2) covariance HH IGI_G (œÉHIG\\sigma_{HI_G}) equal (œÉIG2=œÉHIG\\sigma_{I_G}^2 = \\sigma_{HI_G}). 2. maximized correlation HH IGI_G (LGSI accuracy) equal œÅHIG=œÉIGœÉH\\rho_{HI_G} = \\frac{\\sigma_{I_G}}{\\sigma_H}. 3. variance predicted error, Var(H‚àíIG)=(1‚àíœÅHIG2)œÉH2Var(H - I_G) = (1 - \\rho_{HI_G}^2)\\sigma_H^2, minimal. 4. total variance HH explained IGI_G œÉIG2=œÅHIG2œÉH2\\sigma_{I_G}^2 = \\rho_{HI_G}^2 \\sigma_H^2.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/linear-genomic-selection-indices.html","id":"lgsi-vs-lpsi-efficiency","dir":"Articles","previous_headings":"5.1 The Linear Genomic Selection Index","what":"LGSI vs LPSI Efficiency","title":"Linear Genomic Selection Indices","text":"formalize efficiency Genomic (LGSI) Phenotypic (LPSI) selection index efficiency, use parameter ŒªG\\lambda_G: pG=100(ŒªG‚àí1) p_G=100\\left(\\lambda_G-1\\right) pG>0p_G > 0, LGSI efficiency greater LPSI efficiency; pG=0p_G = 0, equal, pG<0p_G < 0, LPSI efficient. Additionally, accounting interval lengths selection cycles, LGSI strictly efficient LPSI : LG<œÅHIGhILP L_G < \\frac{\\rho_{HI_G}}{h_I}L_P","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/linear-genomic-selection-indices.html","id":"genomic-estimated-breeding-values-gebvs","dir":"Articles","previous_headings":"5.1 The Linear Genomic Selection Index","what":"Genomic Estimated Breeding Values (GEBVs)","title":"Linear Genomic Selection Indices","text":"selection.index package perform prediction modeling , GEBVs must calculated prior. example, generate GEBVs (ùõÑ\\boldsymbol{\\gamma}) using unpenalized Ridge Regression, markers estimate trait values. rigorous methodology acceptable generate GEBVs using Bayesian Alphabets, rrBLUP, equivalent prediction models. now calculate ùõÑ\\boldsymbol{\\gamma} (gebv_mat):","code":"library(selection.index) library(MASS) # For robust ridge regression implementation (lm.ridge)  # 1. Load the built-in synthetic maize datasets data(\"maize_pheno\") data(\"maize_geno\")  # Ensure markers are numeric matrices X <- as.matrix(maize_geno)  # Ensure pheno lines up perfectly with geno # (Note: maize_pheno contains 4 repetitions per genotype; we take the means) Y_agg <- mean_performance(   data = maize_pheno[, c(\"Yield\", \"PlantHeight\", \"DaysToMaturity\")],   genotypes = maize_pheno$Genotype,   replications = maize_pheno$Block ) #> Warning in sqrt(EMS/r): NaNs produced #> Warning in sqrt(2 * EMS/r): NaNs produced #> Warning in sqrt(2 * EMS/r): NaNs produced #> Warning in sqrt(EMS): NaNs produced #> Warning in sqrt(EMS/r): NaNs produced #> Warning in sqrt(2 * EMS/r): NaNs produced #> Warning in sqrt(2 * EMS/r): NaNs produced #> Warning in sqrt(EMS): NaNs produced #> Warning in sqrt(EMS/r): NaNs produced #> Warning in sqrt(2 * EMS/r): NaNs produced #> Warning in sqrt(2 * EMS/r): NaNs produced #> Warning in sqrt(EMS): NaNs produced  # Sort both datasets to ensure identical ordering Y_agg <- Y_agg[order(Y_agg$Genotypes), ] X <- X[order(rownames(X)), ]  # Ensure overlapping genotypes common_genotypes <- intersect(Y_agg$Genotypes, rownames(X)) Y_agg <- Y_agg[Y_agg$Genotypes %in% common_genotypes, ] X <- X[rownames(X) %in% common_genotypes, ]  # Select only multi-traits relevant to breeding # Yield, PlantHeight, DaysToMaturity Y <- as.matrix(Y_agg[, c(\"Yield\", \"PlantHeight\", \"DaysToMaturity\")]) # Simulate Genomic Estimated Breeding Values (GEBVs) using Ridge Regression # In best practice, you'd use cross-validation or a separate training/testing set # We use lambda = 100 to handle the p >> n dimensionality problem gebv_mat <- matrix(0, nrow = nrow(Y), ncol = ncol(Y)) colnames(gebv_mat) <- colnames(Y)  for (i in seq_len(ncol(Y))) {   # Fit a ridge regression model for trait `i` using markers `X`   model_ridge <- lm.ridge(Y[, i] ~ X, lambda = 100)    # Predict values using coef() which correctly un-scales the coefficients: Include intercept   betas <- coef(model_ridge)   intercept <- betas[1]   beta <- betas[-1] # Exclude intercept    # Calculate the GEBV for the trait   gebv_mat[, i] <- intercept + (X %*% beta) }  head(gebv_mat, 3) #>         Yield PlantHeight DaysToMaturity #> [1,] 8241.151    219.4007       115.8738 #> [2,] 7965.285    208.8754       116.4623 #> [3,] 7832.597    204.5494       116.4592"},{"path":"https://zankrut20.github.io/selection.index/articles/linear-genomic-selection-indices.html","id":"implementing-lgsi","dir":"Articles","previous_headings":"5.1 The Linear Genomic Selection Index","what":"Implementing LGSI","title":"Linear Genomic Selection Indices","text":"gebv_mat hand, simple calculate LGSI metrics using lgsi(): LGSI function output shows calculated standard deviation (œÉI\\sigma_I), index heritability (h2h^2), overall net genetic advance (GAGA), expected gains per trait (ŒîH\\Delta H) associated genomic selection.","code":"# 2. Compute Trait Covariances pmat <- cov(Y) # Phenotypic Covariance (Approximation)  # In optimal practice, the true Genomic Covariance Matrix (\\Gamma) is # estimated using Restricted Maximum Likelihood (REML) utilizing both general # phenotypic and genotypic information. Here, we simulate \\Gamma as proportional # to the phenotypic variance (assuming a high heritability correlation). gmat <- pmat * 0.4 # Approximate Genotypic Covariance (Approximating \\Gamma)  # 3. Define Economic Weights weights <- data.frame(   Trait = c(\"Yield\", \"PlantHeight\", \"DaysToMaturity\"),   Weight = c(5, -0.1, -0.1) ) wmat <- weight_mat(weights)  # 4. Calculate Linear Genomic Selection Index (LGSI) # For the testing population where we only use genomic values lgsi_result <- lgsi(   gebv_mat = gebv_mat,   gmat = gmat,   wmat = wmat )  # Output Summary lgsi_result$summary #>   b.1  b.2  b.3       GA      PRE hI2 rHI #> 1   5 -0.1 -0.1 1718.838 171883.8   1   1"},{"path":"https://zankrut20.github.io/selection.index/articles/linear-genomic-selection-indices.html","id":"the-combined-linear-genomic-selection-index","dir":"Articles","previous_headings":"","what":"5.2 The Combined Linear Genomic Selection Index","title":"Linear Genomic Selection Indices","text":"Combined LGSI (CLGSI) developed Dekkers (2007) slightly modified version LMSI, , instead using raw marker scores, uses GEBVs phenotypic information jointly predict net genetic merit. CLGSI model represents: IC=ùõÉùê≤‚Ä≤ùê≤+ùõÉG‚Ä≤ùõÑ {}_C={\\boldsymbol{\\beta}}_{\\mathbf{y}}^{\\prime}\\mathbf{y}+{\\boldsymbol{\\beta}}_G^{\\prime}\\boldsymbol{\\gamma} ùê≤\\mathbf{y} predicted phenotype ùõÑ\\boldsymbol{\\gamma} subset genetic markers. p‚Üí‚àûp \\rightarrow \\infty, true variance approaches genomic predicted variance, CLGSI becomes identical LGSI. CLGSI uses GEBVs phenotypic information jointly, can ideally complement prediction workflows inside training populations field trials simultaneously held.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/linear-genomic-selection-indices.html","id":"statistical-properties-of-the-clgsi","dir":"Articles","previous_headings":"5.2 The Combined Linear Genomic Selection Index","what":"Statistical Properties of the CLGSI","title":"Linear Genomic Selection Indices","text":"Similar LGSI, CLGSI holds strict conditions ensuring theoretical validation constraints: 1. œÉIC2=œÉHIC\\sigma_{I_C}^2 = \\sigma_{HI_C}, meaning variance ICI_C covariance HH ICI_C unified. 2. maximized correlation HH ICI_C operates strictly œÅHIC=œÉICœÉH\\rho_{HI_C} = \\frac{\\sigma_{I_C}}{\\sigma_H}. 3. variance predicted error, Var(H‚àíIC)=(1‚àíœÅHIC2)œÉH2Var(H - I_C) = (1 - \\rho_{HI_C}^2)\\sigma_H^2, mathematically minimal. 4. total variance HH explained ICI_C scales linearly via œÉIC2=œÅHIC2œÉH2\\sigma_{I_C}^2 = \\rho_{HI_C}^2 \\sigma_H^2.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/linear-genomic-selection-indices.html","id":"implementing-clgsi","dir":"Articles","previous_headings":"5.2 The Combined Linear Genomic Selection Index","what":"Implementing CLGSI","title":"Linear Genomic Selection Indices","text":"can measure CLGSI utilizing clgsi() function feeding observed phenotypes estimated genomic variants. Notice Combined LGSI two sets optimized unitless Œ≤\\beta weightings‚Äîone phenotype values (b_y), one overall marker value (b_g) per trait. Selection Response (RR) represents final expected genetic aggregate improvement.","code":"clgsi_result <- clgsi(   phen_mat = Y, # Observed phenotypic data   gebv_mat = gebv_mat, # Genomic Estimated Breeding Values   pmat = pmat, # Expected Phenotypic traits covariance   gmat = gmat, # Expected Genotypic traits covariance   wmat = wmat )  clgsi_result$summary #>       b_y.1    b_y.2    b_y.3    b_g.1    b_g.2    b_g.3       GA      PRE hI2 #> 1 -241.2056 -69.0278 -11711.7 301.3417 -12.6428 13421.05 9325.477 932547.7   1 #>   rHI #> 1   1"},{"path":"https://zankrut20.github.io/selection.index/articles/linear-genomic-selection-indices.html","id":"limitations-and-caveats","dir":"Articles","previous_headings":"","what":"Limitations and Caveats","title":"Linear Genomic Selection Indices","text":"Dimensionality Problem: Often p‚â´np \\gg n, requiring regularization techniques like Ridge Regression (demonstrated lm.ridge) derive Genomic Estimated Breeding Values without singular/non-invertible covariance anomalies. Cycle Length: genomic methods (LGSI, CLGSI) may occasionally show lower index accuracy unadjusted phenotypic methods initially, typically provide vastly improvement per unit time (LGL_G) heavily compressed cycle iterations phenotyping skipped.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/linear-marker-selection-indices.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Linear Marker and Genome-Wide Selection Indices","text":"two main linear selection indices employed marker-assisted selection (MAS) predict net genetic merit select individual candidates parents next generation: linear marker selection index (LMSI) genome-wide LMSI (GW-LMSI). indices maximize expected genetic gain per trait combining molecular phenotypic data. LMSI requires prior step selecting markers significantly linked quantitative trait loci (QTL) calculate ‚Äúmarker score‚Äù. GW-LMSI single-stage procedure treats information individual marker separate trait, entering markers phenotypic information single index. vignette, demonstrate apply indices using selection.index package phenotypic (maize_pheno) genotypic (maize_geno) data.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/linear-marker-selection-indices.html","id":"sample-data-preparation","dir":"Articles","previous_headings":"Introduction","what":"Sample Data Preparation","title":"Linear Marker and Genome-Wide Selection Indices","text":"use synthetic maize datasets built package calculate phenotypic, genotypic, marker, covariance matrices necessary molecular index modeling.","code":"library(selection.index)  # Load the built-in maize phenotype and genotype datasets data(\"maize_pheno\") data(\"maize_geno\")  # 1. Prepare Phenotypic Data # We select three traits for our demonstration traits <- c(\"Yield\", \"PlantHeight\", \"DaysToMaturity\") phen_mat <- as.matrix(maize_pheno[, traits])  # Calculate Genotypic (gmat) and Phenotypic (pmat) covariance matrices gmat <- gen_varcov(maize_pheno[, traits], maize_pheno$Genotype, maize_pheno$Block) pmat <- phen_varcov(maize_pheno[, traits], maize_pheno$Genotype, maize_pheno$Block)  # Aggregate phenotypic data by Genotype to match marker data dimensions agg_pheno <- aggregate(maize_pheno[, traits], by = list(Genotype = maize_pheno$Genotype), FUN = mean) phen_mat <- as.matrix(agg_pheno[, traits])  # 2. Prepare Genotypic Data # Extract only the marker columns (dropping the Genotype ID column) marker_mat <- as.matrix(maize_geno[, -1])  # 3. Define Economic Weights # Suppose we want to improve Yield strongly, decrease Plant Height, and lightly increase Days to Maturity wmat <- weight_mat(data.frame(Trait = traits, Weight = c(2, -1, 0.5)))"},{"path":"https://zankrut20.github.io/selection.index/articles/linear-marker-selection-indices.html","id":"the-linear-marker-selection-index-lmsi","dir":"Articles","previous_headings":"","what":"1. The Linear Marker Selection Index (LMSI)","title":"Linear Marker and Genome-Wide Selection Indices","text":"Linear Marker Selection Index (LMSI) requires explicit prior step: calculating marker score (ùê¨\\mathbf{s}). Let ùê≤i=ùê†i+ùêûi\\mathbf{y}_i = \\mathbf{g}_i + \\mathbf{e}_i vector phenotypic traits. unobservable genetic value gig_i can predicted using linear combination MM selected markers structurally linked QTL affect iith trait: ùê¨i=‚àëj=1Mùõâjùê±j \\mathbf{s}_i=\\sum \\limits_{j=1}^M \\boldsymbol{\\theta}_j \\mathbf{x}_j ùê¨i\\mathbf{s}_i marker score, ùõâj\\boldsymbol{\\theta}_j regression coefficient, ùê±j\\mathbf{x}_j coded value jjth markers. LMSI combines phenotypic scores (ùê≤\\mathbf{y}) marker scores (ùê¨\\mathbf{s}) predict net genetic merit HH: $$ I_M={\\boldsymbol{\\beta}}_y^{\\prime}\\mathbf{y}+{\\boldsymbol{\\beta}}_s^{\\prime}\\mathbf{s}=\\left[{\\boldsymbol{\\beta}}_y^{\\prime}\\kern0.5em {\\boldsymbol{\\beta}}_s^{\\prime}\\right]\\left[\\begin{array}{c}\\mathbf{y}\\\\ {}\\mathbf{s}\\end{array}\\right] $$","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/linear-marker-selection-indices.html","id":"practical-application-lmsi","dir":"Articles","previous_headings":"1. The Linear Marker Selection Index (LMSI)","what":"Practical Application: LMSI","title":"Linear Marker and Genome-Wide Selection Indices","text":"apply LMSI, must first estimate marker scores trait. simple way perform multiple linear regression phenotypic values marker data, selecting significant markers, using coefficients calculate ùê¨\\mathbf{s}. simplicity tutorial, use markers linear model (ridge regression) predict traits. Now ùê©ùê¶ùêöùê≠\\mathbf{pmat}, ùê†ùê¶ùêöùê≠\\mathbf{gmat}, phenotypic matrix ùê≤\\mathbf{y}, estimated marker score matrix ùê¨\\mathbf{s}, can calculate Linear Marker Selection Index: output yields relative contribution weights phenotypes (b_y.*) versus markers (b_s.*), calculates overall Expected Genetic Advance.","code":"# Calculate marker scores via a simple Ridge Regression # (We use MASS::lm.ridge or glmnet in practice, but for the vignette we approximate # the prediction using the marker matrix directly) library(MASS)  marker_scores <- matrix(0, nrow = nrow(phen_mat), ncol = ncol(phen_mat)) colnames(marker_scores) <- colnames(phen_mat)  for (i in seq_len(ncol(phen_mat))) {   # Fit ridge regression to handle multicollinearity among markers   # Note: A lambda must be chosen carefully in real scenarios   fit <- lm.ridge(phen_mat[, i] ~ marker_mat, lambda = 10)   # Calculate predicted marker scores   marker_scores[, i] <- scale(marker_mat, center = fit$xm, scale = fit$scales) %*% fit$coef + fit$ym } # Calculate the LMSI lmsi_res <- lmsi(   phen_mat = phen_mat,   marker_scores = marker_scores,   pmat = pmat,   gmat = gmat,   wmat = wmat )  # View the LMSI coefficient summary print(lmsi_res$summary) #>            Trait   Component            b    w   Delta_H #> 1          Yield   Phenotype     521.4950  2.0 731752.99 #> 2    PlantHeight   Phenotype    2085.7769 -1.0  19178.95 #> 3 DaysToMaturity   Phenotype  223294.4615  0.5  10659.56 #> 4          Yield MarkerScore    -532.8818  2.0 731752.99 #> 5    PlantHeight MarkerScore   -2003.1664 -1.0  19178.95 #> 6 DaysToMaturity MarkerScore -229077.9808  0.5  10659.56  # Display the expected genetic gains per trait print(lmsi_res$Delta_G) #> NULL"},{"path":"https://zankrut20.github.io/selection.index/articles/linear-marker-selection-indices.html","id":"the-genome-wide-linear-marker-selection-index-gw-lmsi","dir":"Articles","previous_headings":"","what":"2. The Genome-Wide Linear Marker Selection Index (GW-LMSI)","title":"Linear Marker and Genome-Wide Selection Indices","text":"genome-wide linear selection index (GW-LMSI) bypasses two-stage regression scoring step LMSI. Instead, treats information individual marker separate trait. mm marker information enters together phenotypic information single index. GW-LMSI combines trait phenotypic values (ùê≤\\mathbf{y}) molecular information (ùê¶\\mathbf{m}) predict HH: $$ I_W={\\boldsymbol{\\beta}}_y^{\\prime}\\mathbf{y}+{\\boldsymbol{\\beta}}_m^{\\prime}\\mathbf{m}=\\left[{\\boldsymbol{\\beta}}_y^{\\prime}\\kern0.5em {\\boldsymbol{\\beta}}_m^{\\prime}\\right]\\left[\\begin{array}{c}\\mathbf{y}\\\\ {}\\mathbf{m}\\end{array}\\right] $$ number markers mm often wildly exceeds number individuals nn (p‚â´np \\gg n problem), covariance matrix markers (ùêå\\mathbf{M}) covariance phenotypes markers (ùêñ\\mathbf{W}) generally singular. Thus, calculating index coefficients ùõÉy{\\boldsymbol{\\beta}}_y ùõÉm{\\boldsymbol{\\beta}}_m typically requires generalized inverses regularization (e.g.¬†Ridge Regression / Tikhonov regularization applied covariance matrices).","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/linear-marker-selection-indices.html","id":"practical-application-gw-lmsi","dir":"Articles","previous_headings":"2. The Genome-Wide Linear Marker Selection Index (GW-LMSI)","what":"Practical Application: GW-LMSI","title":"Linear Marker and Genome-Wide Selection Indices","text":"selection.index package manages complex construction ùêå\\mathbf{M} ùêñ\\mathbf{W} covariance matrices asymptotically handles singularity issues using Tikhonov regularization (lambda). GW-LMSI automatically models molecular variance one step. requires computationally heavier matrix inversion (often mitigated regularization), tends predict net genetic merit efficiently standard LMSI trait heritability low capturing many small QTL regressions requires immense sample sizes.","code":"# We use all 500 markers in the maize_geno matrix # Since p (500) approaches n (600), we supply a ridge regularization lambda # to ensure the covariance matrices are invertible. gw_lmsi_res <- gw_lmsi(   marker_mat = marker_mat,   trait_mat = phen_mat,   gmat = gmat,   wmat = wmat,   lambda = 0.05 )  # Display the phenotypic weighting coefficients print(gw_lmsi_res$b_y) #> NULL  # We can also check the condition number to observe the matrix stability print(gw_lmsi_res$condition_number) #> [1] 6.629131  # And summarize the overall index statistics print(gw_lmsi_res$summary) #>      Metric    Value #> 1       rHI   0.0252 #> 2       hI2   1.0000 #> 3   sigma_I 397.3752 #> 4         R 819.7850 #> 5        GA 840.7368 #> 6       PRE       NA #> 7 n_markers 499.0000 #> 8    lambda   0.0500"},{"path":[]},{"path":"https://zankrut20.github.io/selection.index/articles/linear-marker-selection-indices.html","id":"basic-conditions-for-constructing-the-lmsi","dir":"Articles","previous_headings":"3. Advanced Concepts and Limitations","what":"3.1 Basic Conditions for Constructing the LMSI","title":"Linear Marker and Genome-Wide Selection Indices","text":"According Lande Thompson (1990), applying LMSI correctly requires several primary statistical biological conditions met breeding population: Linkage Disequilibrium: markers quantitative trait loci (QTL) must linkage disequilibrium (LD). Additivity: QTL effects combined additively within loci (epistasis). Coupling Mode: QTL coupling mode parental lines hold uniformly positive negative alleles. Genetic Architecture: Traits affected QTLs large effects rather exclusively many small-effect QTLs. Heritability: traits must inherently low heritability (h2h^2). heritabilities high, phenotypic selection alone immensely effective. Marker Identification: Markers correlated traits interest must first successfully identified.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/linear-marker-selection-indices.html","id":"the-lmsi-paradox-and-efficiency-comparisons","dir":"Articles","previous_headings":"3. Advanced Concepts and Limitations","what":"3.2 The ‚ÄúLMSI Paradox‚Äù and Efficiency Comparisons","title":"Linear Marker and Genome-Wide Selection Indices","text":"linear marker selection index always dramatically outperform standard phenotypic selection? necessarily. Lande Thompson (1990) showed LMSI efficiency relative basic phenotypic selection (ŒªM\\lambda_M) single trait : ŒªM=RMR=qh2+(1‚àíq)21‚àíqh2 \\lambda_M=\\frac{R_M}{R}=\\sqrt{\\frac{q}{h^2}+\\frac{{\\left(1-q\\right)}^2}{1-{qh}^2}} q=œÉs2œÉg2q = \\frac{\\sigma_s^2}{\\sigma_g^2} proportion additive genetic variance definitively explained markers, h2h^2 trait heritability. equation demonstrates ‚ÄúLMSI Paradox‚Äù mathematically defined Knapp (1998): h2h^2 trends toward zero, ŒªM\\lambda_M approaches infinity. Thus, massive relative advantage marker-assisted selection phenotypic selection occurs explicitly phenotypic trait heritability extremely low, markers successfully capture massive fraction genetic variance. Otherwise, LMSI offers diminishing returns can fix QTLs overly fast rate.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/linear-marker-selection-indices.html","id":"statistical-properties-of-molecular-indices","dir":"Articles","previous_headings":"3. Advanced Concepts and Limitations","what":"3.3 Statistical Properties of Molecular Indices","title":"Linear Marker and Genome-Wide Selection Indices","text":"Assuming HH index IMI_M share bivariate joint normal distribution, statistical properties mirror standard phenotypic LPSI: variance index equals covariance net genetic merit index: œÉIM2=œÉHIM\\sigma_{I_M}^2=\\sigma_{HI_M}. maximized correlation (Accuracy) œÅHIM=œÉIMœÉH\\rho_{HI_M}=\\frac{\\sigma_{I_M}}{\\sigma_H}. Variance Predicted Error Var(H‚àíIM)=(1‚àíœÅHIM2)œÉH2Var\\left(H-{}_M\\right)=\\left(1-{\\rho}_{HI_M}^2\\right){\\sigma}_H^2 uniquely minimized. molecular indices incorporate phenotypic genotypic marker data, LMSI accuracy technically always higher standard LPSI accuracy.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/linear-marker-selection-indices.html","id":"advanced-matrix-estimation-methods","dir":"Articles","previous_headings":"3. Advanced Concepts and Limitations","what":"3.4 Advanced Matrix Estimation Methods","title":"Linear Marker and Genome-Wide Selection Indices","text":"gw_lmsi() lmsi() functions selection.index package abstract away underlying algebra, molecular index computation routinely suffers p‚â´np \\gg n covariance problem (vastly markers recorded individuals). Estimating marker score variances (ùêí\\mathbf{S}) massive ùêå\\mathbf{M} ùêñ\\mathbf{W} covariance matrices using least-squares often leads : 1. Marker covariance values erroneously overestimating true genetic covariance (ùêÇ\\mathbf{C}). 2. Singular, non-positive definite matrices classical inverses fail. standard solution involves regularization techniques (like Ridge penalty lambda built gw_lmsi()), ensuring matrix invertibility cost slight coefficient bias.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/linear-marker-selection-indices.html","id":"conclusion","dir":"Articles","previous_headings":"","what":"Conclusion","title":"Linear Marker and Genome-Wide Selection Indices","text":"selection.index package extends base index selection directly molecular realm. LMSI (lmsi()) allows breeders leverage established pre-calculated marker scorings regression model. GW-LMSI (gw_lmsi()) embraces Genomic Selection paradigm swallowing marker phenotypic data jointly single predictive framework, utilizing ridge regularization bypass classical p‚â´np \\gg n multicollinearity obstacles. implemented traits exhibiting low heritability, marker-assisted pipelines can drastically outcompete standard phenotypic indices maximizing Expected Genetic Gain per selection cycle.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/linear-phenotypic-eigen-selection-index-methods.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Linear Phenotypic Eigen Selection Index Methods","text":"Based canonical correlation, singular value decomposition (SVD), linear phenotypic selection indices theory, Eigen Selection Index Method (ESIM), Restricted ESIM (RESIM), Predetermined Proportional Gain ESIM (PPG-ESIM) use phenotypic information predict net genetic merit select superior genotypes. Linear Phenotypic Selection Index (LPSI) assumes economic weights known, ESIM family estimates selection cycle maximize correlation index net genetic merit (.e., accuracy) selection response. ESIM unrestricted, whereas RESIM fixes specific traits zero genetic gain, PPG-ESIM ensures traits gain strict prefixed proportions. vignette details theoretical foundation three eigen analysis indices alongside practical workflows estimating using selection.index package.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/linear-phenotypic-eigen-selection-index-methods.html","id":"sample-data-preparation","dir":"Articles","previous_headings":"Introduction","what":"Sample Data Preparation","title":"Linear Phenotypic Eigen Selection Index Methods","text":"Throughout vignette, reuse maize_pheno package dataset calculate phenotypic (ùêè\\mathbf{P}) genotypic (ùêÜ\\mathbf{G} ùêÇ\\mathbf{C}) covariance matrices.","code":"library(selection.index)  # Load the built-in maize phenotype dataset data(\"maize_pheno\")  # Extract the traits of interest traits <- c(\"Yield\", \"PlantHeight\", \"DaysToMaturity\")  # Calculate Genotypic (gmat) and Phenotypic (pmat) covariance matrices gmat <- gen_varcov(maize_pheno[, traits], maize_pheno$Genotype, maize_pheno$Block) pmat <- phen_varcov(maize_pheno[, traits], maize_pheno$Genotype, maize_pheno$Block)"},{"path":"https://zankrut20.github.io/selection.index/articles/linear-phenotypic-eigen-selection-index-methods.html","id":"the-linear-phenotypic-eigen-selection-index-method-esim","dir":"Articles","previous_headings":"","what":"1. The Linear Phenotypic Eigen Selection Index Method (ESIM)","title":"Linear Phenotypic Eigen Selection Index Methods","text":"theoretical selection response ESIM can written : RI=kIœÉHœÅHI,(7.1) R_I = k_I \\sigma_H \\rho_{HI}, \\quad (7.1) kIk_I selection intensity, œÉH\\sigma_H standard deviation genetic merit, œÅHI\\rho_{HI} correlation trait index unobservable genetic merit. maximize index selection response without pre-defined economic weights, ESIM translates index estimation generalized eigenvalue problem: (ùêè‚àí1ùêÇ‚àíŒªE2ùêà)ùêõE=ùüé,(7.10) (\\mathbf{P}^{-1} \\mathbf{C} - \\lambda^2_E \\mathbf{}) \\mathbf{b}_E = \\mathbf{0}, \\quad (7.10) ùêè‚àí1ùêÇ\\mathbf{P}^{-1} \\mathbf{C} multi-trait heritability matrix. optimal ESIM vector coefficients ùêõE\\mathbf{b}_E first eigenvector ùêè‚àí1ùêÇ\\mathbf{P}^{-1} \\mathbf{C}, accuracy square root first eigenvalue (ŒªE\\lambda_E). maximized ESIM selection response can written : RE=kIùêõ‚Ä≤EùêèùêõE(7.15) R_E = k_I \\sqrt{ \\mathbf{b}'_E \\mathbf{P} \\mathbf{b}_E } \\quad (7.15)","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/linear-phenotypic-eigen-selection-index-methods.html","id":"practical-application-esim","dir":"Articles","previous_headings":"1. The Linear Phenotypic Eigen Selection Index Method (ESIM)","what":"Practical Application: ESIM","title":"Linear Phenotypic Eigen Selection Index Methods","text":"package, esim maximizes genetic response without pre-defined weights pmat gmat.","code":"# Compute the linear phenotypic eigen selection index esim_res <- esim(   pmat = pmat,   gmat = gmat,   selection_intensity = 2.063 )  # View the summary print(esim_res$summary) #>   Index  lambda2      hI2      rHI  sigma_I Delta_G      b.1      b.2      b.3 #> 1     1 1771.794 1771.794 42.09268 3.286805 6.78068 0.002336 0.009329 0.999954  # View expected genetic gains per trait (Delta_G) print(esim_res$Delta_G) #>          Yield    PlantHeight DaysToMaturity  #>      700636.74       18363.40       10206.29"},{"path":"https://zankrut20.github.io/selection.index/articles/linear-phenotypic-eigen-selection-index-methods.html","id":"the-restricted-eigen-selection-index-method-resim","dir":"Articles","previous_headings":"","what":"2. The Restricted Eigen Selection Index Method (RESIM)","title":"Linear Phenotypic Eigen Selection Index Methods","text":"Similar RLPSI, RESIM fixes certain traits expected genetic gain remains null (zero). Instead modifying known economic weights restrictions, RESIM computes restricted eigenvalues natively. orthogonal set restrictions ùêî‚Ä≤\\mathbf{U}' imposed, optimized eigenvalue equation becomes: (ùêäùêè‚àí1ùêÇ‚àíŒªR2ùêàt)ùêõR=ùüé.(7.31) (\\mathbf{K} \\mathbf{P}^{-1} \\mathbf{C} - \\lambda^2_R \\mathbf{}_t) \\mathbf{b}_R = \\mathbf{0}. \\quad (7.31) ùêä=[ùêà‚àíùêê]\\mathbf{K} = [\\mathbf{} - \\mathbf{Q}], ùêê=ùêè‚àí1ùêÇùêî(ùêî‚Ä≤ùêÇùêè‚àí1ùêÇùêî)‚àí1ùêî‚Ä≤ùêÇ\\mathbf{Q} = \\mathbf{P}^{-1}\\mathbf{C}\\mathbf{U}(\\mathbf{U}'\\mathbf{C}\\mathbf{P}^{-1}\\mathbf{C}\\mathbf{U})^{-1}\\mathbf{U}'\\mathbf{C}. vector ùêõR\\mathbf{b}_R restriction-corrected eigenvector.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/linear-phenotypic-eigen-selection-index-methods.html","id":"practical-application-resim","dir":"Articles","previous_headings":"2. The Restricted Eigen Selection Index Method (RESIM)","what":"Practical Application: RESIM","title":"Linear Phenotypic Eigen Selection Index Methods","text":"use resim restrict PlantHeight (trait #2) strictly zero expected genetic gain. Notice expected genetic gain restricted trait mathematically forced zero.","code":"# We restrict PlantHeight (the second trait in our data frame) resim_res <- resim(   pmat = pmat,   gmat = gmat,   restricted_traits = c(2),   selection_intensity = 2.063 )  # Expected genetic gains per trait print(resim_res$Delta_G) #>          Yield    PlantHeight DaysToMaturity  #>  -1.057493e+02   1.324103e-07  -2.276986e+00"},{"path":"https://zankrut20.github.io/selection.index/articles/linear-phenotypic-eigen-selection-index-methods.html","id":"the-predetermined-proportional-gain-esim-ppg-esim","dir":"Articles","previous_headings":"","what":"3. The Predetermined Proportional Gain ESIM (PPG-ESIM)","title":"Linear Phenotypic Eigen Selection Index Methods","text":"Instead null gains, PPG-ESIM allows breeder pre-set optimal levels growth proportion specific traits maintaining eigen maximization properties non-restricted traits. changes eigen mapping matrix using proportional restrictions Mallard operator ùêå‚Ä≤\\mathbf{M}': (ùêäPùêè‚àí1ùêÇ‚àíŒªP2ùêàt)ùêõP=ùüé,(7.43) (\\mathbf{K}_P \\mathbf{P}^{-1} \\mathbf{C} - \\lambda^2_P \\mathbf{}_t) \\mathbf{b}_P = \\mathbf{0}, \\quad (7.43) ùêäP\\mathbf{K}_P derived predetermined proportional vector parameter ùêù\\mathbf{d}.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/linear-phenotypic-eigen-selection-index-methods.html","id":"practical-application-ppg-esim","dir":"Articles","previous_headings":"3. The Predetermined Proportional Gain ESIM (PPG-ESIM)","what":"Practical Application: PPG-ESIM","title":"Linear Phenotypic Eigen Selection Index Methods","text":"Let‚Äôs assume want strict 5%5\\% gain PlantHeight 10%10\\% reduction DaysToMaturity proportionately compared Yield. mechanism, breeders manipulate genetic covariance paths analytically accurately.","code":"# Provide the vector d of desired predetermined proportional gains # The indices represent non-zero targets. For exactly corresponding target magnitudes, we provide d. d_vector <- c(0, 0.5, -1) # e.g. proportional mapping  # We use the ppg_esim function ppgesim_res <- ppg_esim(   pmat = pmat,   gmat = gmat,   d = d_vector,   selection_intensity = 2.063 )  # View the proportionality of the genetic gains print(ppgesim_res$Delta_G) #>          Yield    PlantHeight DaysToMaturity  #>    -2597.62024      -68.25086      -37.50434"},{"path":[]},{"path":"https://zankrut20.github.io/selection.index/articles/linear-phenotypic-eigen-selection-index-methods.html","id":"variance-of-predicted-error-vpe","dir":"Articles","previous_headings":"4. Statistical Properties of Eigen Selection Indices","what":"Variance of Predicted Error (VPE)","title":"Linear Phenotypic Eigen Selection Index Methods","text":"precision index predicting net genetic merit evaluated Variance Predicted Error: VPE(IE)=œÉHE2‚àíœÉIE2(7.19) VPE(I_E) = \\sigma^2_{H_E} - \\sigma^2_{I_E} \\quad (7.19) relative mean squared effect IEI_E predicting HEH_E equivalent reliability: Var()‚àíVPE(IE)Var()=œÅHEIE2(7.20) \\frac{Var(H_E) - VPE(I_E)}{Var(H_E)} = \\rho^2_{H_E I_E} \\quad (7.20) œÅHEIE2\\rho^2_{H_E I_E} squared accuracy eigen index.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/linear-phenotypic-eigen-selection-index-methods.html","id":"canonical-correlation-connection","dir":"Articles","previous_headings":"4. Statistical Properties of Eigen Selection Indices","what":"Canonical Correlation Connection","title":"Linear Phenotypic Eigen Selection Index Methods","text":"ESIM optimization maps directly Canonical Correlation Theory (Hotelling 1936). objective find linear combination traits maximal correlation net genetic merit. ESIM context, ùêõE\\mathbf{b}_E exactly first canonical vector matrix ùêè‚àí1ùêÇ\\mathbf{P}^{-1}\\mathbf{C}, associated accuracy represents highest achievable canonical correlation phenotypic indices genotypic values.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/linear-phenotypic-selection-index.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"The Linear Phenotypic Selection Index Theory","text":"plant animal breeding, quantitative traits (QTs) expressions genes distributed across genome interacting environment. phenotypic value QTs (yy) can systematically partitioned genotypic component (gg) environmental component (ee): y=g+e y = g + e primary goal breeding maximize individual‚Äôs net genetic merit. net genetic merit (HH) linear combination unobservable true breeding values (ùê†\\mathbf{g}) weighted respective economic values (ùê∞\\mathbf{w}): H=ùê∞‚Ä≤ùê† H = {\\mathbf{w}}^{\\prime}\\mathbf{g} net genetic merit unobservable field trials, breeders construct Linear Phenotypic Selection Index (LPSI) predict . LPSI (II) linear combination observable optimally weighted phenotypic trait values (ùê≤\\mathbf{y}) adjusted index coefficients (ùêõ\\mathbf{b}): =ùêõ‚Ä≤ùê≤ = {\\mathbf{b}}^{\\prime}\\mathbf{y} objective LPSI predict net genetic merit maximize multi-trait selection response.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/linear-phenotypic-selection-index.html","id":"optimizing-the-lpsi","dir":"Articles","previous_headings":"","what":"Optimizing the LPSI","title":"The Linear Phenotypic Selection Index Theory","text":"identify optimal parents next selection cycle, correlation net genetic merit (HH) LPSI (II) must maximized. vector ùêõ\\mathbf{b} simultaneously minimizes mean squared difference II HH perfectly maximizes correlation mathematically derived : ùêõ=ùêè‚àí1ùêÜùê∞ \\mathbf{b} = {\\mathbf{P}}^{-1}\\mathbf{Gw} : * ùêè\\mathbf{P} phenotypic variance-covariance matrix. * ùêÜ\\mathbf{G} genotypic variance-covariance matrix. * ùê∞\\mathbf{w} vector economic weights defining relative trait importance. optimal coefficients derived, can evaluate two fundamental parameters: Maximized Selection Response (RIR_I): expected mean improvement net genetic merit due indirect selection index. RI=kIùêõ‚Ä≤ùêèùêõ {R}_I = {k}_I\\sqrt{{\\mathbf{b}}^{\\prime}\\mathbf{Pb}} Expected Genetic Gain Per Trait (ùêÑ\\mathbf{E}): multi-trait selection response broken per individual trait. ùêÑ=kIùêÜùêõœÉI \\mathbf{E} = {k}_I\\frac{\\mathbf{Gb}}{\\sigma_I} kIk_I standardized selection intensity œÉI\\sigma_I standard deviation index score variance.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/linear-phenotypic-selection-index.html","id":"practical-implementation-in-r","dir":"Articles","previous_headings":"","what":"Practical Implementation in R","title":"The Linear Phenotypic Selection Index Theory","text":"can seamlessly translate text theory rigorous statistical practice using selection.index package. utilize built-synthetic datasets: maize_pheno (containing multi-environment phenotypic records 100 genotypes) maize_geno (500 SNP markers).","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/linear-phenotypic-selection-index.html","id":"estimating-covariance-matrices","dir":"Articles","previous_headings":"Practical Implementation in R","what":"1. Estimating Covariance Matrices","title":"The Linear Phenotypic Selection Index Theory","text":"First, estimate genotypic (ùêÜ\\mathbf{G}) phenotypic (ùêè\\mathbf{P}) variance-covariance matrices raw phenotypic dataset.","code":"library(selection.index)  # Load the synthetic phenotypic multi-environment dataset data(\"maize_pheno\")  # In maize_pheno: Traits are columns 4:6. # Genotypes are in column 1, and Block/Replication is in column 3. gmat <- gen_varcov(data = maize_pheno[, 4:6], genotypes = maize_pheno[, 1], replication = maize_pheno[, 3]) pmat <- phen_varcov(data = maize_pheno[, 4:6], genotypes = maize_pheno[, 1], replication = maize_pheno[, 3])"},{"path":"https://zankrut20.github.io/selection.index/articles/linear-phenotypic-selection-index.html","id":"defining-economic-weights","dir":"Articles","previous_headings":"Practical Implementation in R","what":"2. Defining Economic Weights","title":"The Linear Phenotypic Selection Index Theory","text":"Next, establish relative economic priority trait. Economic weights (ùê∞\\mathbf{w}) explicitly define strategic breeding objectives.","code":"# Define the economic weights for the 3 continuous traits # (e.g., Yield, PlantHeight, DaysToMaturity) weights <- c(10, -5, -5)"},{"path":"https://zankrut20.github.io/selection.index/articles/linear-phenotypic-selection-index.html","id":"calculating-the-lpsi","dir":"Articles","previous_headings":"Practical Implementation in R","what":"3. Calculating the LPSI","title":"The Linear Phenotypic Selection Index Theory","text":"covariance matrices economic weights specified, integrate primary lpsi() function, evaluates combinatorial multi-trait selection indices efficiently.","code":"# Calculate the Optimal Combinatorial Linear Phenotypic Selection Index (LPSI) index_results <- lpsi(   ncomb = 3,   pmat = pmat,   gmat = gmat,   wmat = as.matrix(weights),   wcol = 1 )"},{"path":"https://zankrut20.github.io/selection.index/articles/linear-phenotypic-selection-index.html","id":"evaluating-outcomes-and-selecting-genotypes","dir":"Articles","previous_headings":"Practical Implementation in R","what":"4. Evaluating Outcomes and Selecting Genotypes","title":"The Linear Phenotypic Selection Index Theory","text":"Finally, evaluate theoretical gains. lpsi() function returns structured data frame containing theoretical selection response (RIR_I) parameter estimates requested trait combinations.","code":"# View the top combinatorial indices, including their selection response (R_A) head(index_results) #>        ID      b.1      b.2     b.3      GA       PRE Delta_G     rHI      hI2 #> 1 1, 2, 3 2364.671 9453.933 1012156 6863519 686351898 6863519 42.0899 1771.794 #>   Rank #> 1    1  # Extract the phenotypic selection scores to strategically rank the parental candidates # using the top evaluated combinatorial index scores <- predict_selection_score(   index_results,   data = maize_pheno[, 4:6],   genotypes = maize_pheno[, 1] )  # View the top performing candidates designated for the next breeding cycle head(scores) #>   Genotypes   I_1_2_3 I_1_2_3_Rank #> 1      G001 138639943           78 #> 2      G002 138393284           83 #> 3      G003 138260546           88 #> 4      G004 139442740           46 #> 5      G005 139319528           51 #> 6      G006 139661606           36"},{"path":"https://zankrut20.github.io/selection.index/articles/linear-phenotypic-selection-index.html","id":"extension-linear-marker-selection-index","dir":"Articles","previous_headings":"Practical Implementation in R","what":"5. Extension: Linear Marker Selection Index","title":"The Linear Phenotypic Selection Index Theory","text":"classical linear selection index theories seamlessly extend marker-assisted genomic selection. genome-wide marker profiles genotypes, can incorporate estimate Linear Marker Selection Index (LMSI).","code":"# Load the associated synthetic genomic dataset (500 SNPs for the 100 genotypes) data(\"maize_geno\")  # Calculate the marker-assisted index combining our matrices and raw SNP profiles marker_index_results <- lmsi(   pmat = pmat,   gmat = gmat,   marker_scores = maize_geno,   wmat = weights )  summary(marker_index_results)"},{"path":"https://zankrut20.github.io/selection.index/articles/linear-phenotypic-selection-index.html","id":"the-base-index-and-index-efficiency","dir":"Articles","previous_headings":"Practical Implementation in R","what":"6. The Base Index and Index Efficiency","title":"The Linear Phenotypic Selection Index Theory","text":"scenarios phenotypic (ùêè\\mathbf{P}) genotypic (ùêÜ\\mathbf{G}) matrices poorly estimated (e.g., due limited data), true optimal coefficients (ùêõ\\mathbf{b}) can systematically biased. Base Index provides robust, non-optimized alternative coefficients set strictly equal fixed economic weights (IB=ùê∞‚Ä≤ùê≤I_B = \\mathbf{w}'\\mathbf{y}).","code":"# Calculate the Base Index and automatically compare its efficiency to the LPSI base_results <- base_index(   pmat = pmat,   gmat = gmat,   wmat = weights,   compare_to_lpsi = TRUE )  # Observe the expected genetic gains and efficiency comparison base_results$summary #>   b.1 b.2 b.3      GA       PRE  Delta_G      hI2     rHI #> 1  10  -5  -5 1824121 182412094 14577.53 125.1324 11.1863"},{"path":"https://zankrut20.github.io/selection.index/articles/linear-phenotypic-selection-index.html","id":"heritability-of-the-lpsi","dir":"Articles","previous_headings":"Practical Implementation in R","what":"7. Heritability of the LPSI","title":"The Linear Phenotypic Selection Index Theory","text":"theory demonstrates correlation net genetic merit (HH) expected index (II) differs traditional index heritability mathematically (hI2‚â†œÅHI2h^2_I \\neq \\rho^2_{HI}). lpsi() function intrinsically estimates fundamental statistics:","code":"# Extract the top combinatorial index results top_index <- index_results[1, ]  # h^2_I: Heritability of the optimal index top_index$hI2 #> [1] 1771.794  # \\rho_HI: Correlation between the LPSI and the true underlying Net Genetic Merit top_index$rHI #> [1] 42.0899"},{"path":"https://zankrut20.github.io/selection.index/articles/multistage-linear-selection-indices.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Multistage Phenotypic Selection Indices","text":"crop animal breeding programs, selection rarely performed single stage. Breeders usually evaluate multiple traits across different stages testing, successively discarding inferior genotypes advancing superior ones. multistage approach requires selection indices account changes variances covariances induced selection prior stages. Chapter 9 selection.index package focuses mathematical formulation practical application Multistage Linear Selection Indices. introduce indices properly adjust prior selection using Cochran (1951) Cunningham (1975) method, calculating corrected covariance matrices appropriately predict subsequent selection responses. vignette demonstrate six multistage indices utilizing phenotypic genomic estimated breeding values (GEBVs). use synthetic maize phenotypic genotypic datasets (maize_pheno maize_geno) illustrate complex functions. Let us first prepare covariance matrices.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/multistage-linear-selection-indices.html","id":"data-preparation","dir":"Articles","previous_headings":"Introduction","what":"Data Preparation","title":"Multistage Phenotypic Selection Indices","text":"examples, evaluate 3 quantitative traits dataset: Yield, PlantHeight, DaysToMaturity. assume Stage 1 selection evaluates first two traits (Yield, PlantHeight), Stage 2 evaluates 3 traits (adding DaysToMaturity).","code":"library(selection.index)  # Estimate phenotypic and genotypic covariance matrices for the 3 traits # The traits are Yield, PlantHeight, DaysToMaturity traits <- c(\"Yield\", \"PlantHeight\", \"DaysToMaturity\") pmat <- phen_varcov(maize_pheno[, traits], maize_pheno$Environment, maize_pheno$Genotype) gmat <- gen_varcov(maize_pheno[, traits], maize_pheno$Environment, maize_pheno$Genotype)  # Matrix limits for Stage 1 (Traits 1 to 2) P1 <- pmat[1:2, 1:2] G1 <- gmat[1:2, 1:2]  # Complete Matrices for Stage 2 P <- pmat C <- gmat  # Economic weights for the 3 traits weights <- c(10, -5, -2)"},{"path":"https://zankrut20.github.io/selection.index/articles/multistage-linear-selection-indices.html","id":"multistage-linear-phenotypic-selection-index-mlpsi","dir":"Articles","previous_headings":"","what":"1. Multistage Linear Phenotypic Selection Index (MLPSI)","title":"Multistage Phenotypic Selection Indices","text":"Multistage Linear Phenotypic Selection Index accounts changes phenotypic (ùêè\\mathbf{P}) genotypic (ùêÇ\\mathbf{C}) covariance matrices due previous selection cycles. Stage 1, index coefficients computed just standard Smith-Hazel index: ùêõ1=ùêè1‚àí1ùêÜ1ùê∞1 \\mathbf{b}_1 = \\mathbf{P}_1^{-1}\\mathbf{G}_1\\mathbf{w}_1  ùê∞1\\mathbf{w}_1 contains economic weights Stage 1 traits. Stage 2, coefficients entire set traits : ùêõ2=ùêè‚àí1ùêÇùê∞ \\mathbf{b}_2 = \\mathbf{P}^{-1}\\mathbf{C}\\mathbf{w} However, due selection stage 1, covariances ùêè\\mathbf{P} ùêÇ\\mathbf{C} adjusted stage 2 evaluation: ùêè*=ùêè‚àíuCov(ùê≤,ùê±1)ùêõ1ùêõ1‚Ä≤Cov(ùê±1,ùê≤)ùêõ1‚Ä≤ùêè1ùêõ1 \\mathbf{P}^* = \\mathbf{P} - u \\frac{Cov(\\mathbf{y},\\mathbf{x}_1)\\mathbf{b}_1\\mathbf{b}_1'Cov(\\mathbf{x}_1,\\mathbf{y})}{\\mathbf{b}_1'\\mathbf{P}_1\\mathbf{b}_1} ùêÇ*=ùêÇ‚àíuùêÜ1‚Ä≤ùêõ1ùêõ1‚Ä≤ùêÜ1ùêõ1‚Ä≤ùêè1ùêõ1 \\mathbf{C}^* = \\mathbf{C} - u \\frac{\\mathbf{G}_1'\\mathbf{b}_1\\mathbf{b}_1'\\mathbf{G}_1}{\\mathbf{b}_1'\\mathbf{P}_1\\mathbf{b}_1}  u=k1(k1‚àíœÑ)u = k_1(k_1 - \\tau) calculates effect selection based standardized truncation point œÑ\\tau selection intensity k1k_1. function mlpsi simultaneously performs adjustments metric estimations stages.","code":"# We apply a selection proportion of 10% (0.10) per stage. mlpsi_res <- mlpsi(   P1 = P1, P = P, G1 = G1, C = C,   wmat = weights,   selection_proportion = 0.1 ) #> Warning in .index_correlation(b1, b2, P1, P, stage1_indices): Invalid variance #> for correlation calculation. #> Warning in .adjust_phenotypic_matrix(P, P1, b1, k1, tau, stage1_indices): #> Invalid variance at stage 1 (b1'P1b1 <= 0). Returning unadjusted matrix. #> Warning in .adjust_genotypic_matrix(C, G1, b1, k1, tau, P1, stage1_indices): #> Invalid variance at stage 1 (b1'P1b1 <= 0). Returning unadjusted matrix.  # Stage 1 metrics mlpsi_res$summary_stage1 #>   Stage       Trait             b  E #> 1     1       Yield -527740915826 NA #> 2     1 PlantHeight 4066491692882 NA  # Stage 2 metrics mlpsi_res$summary_stage2 #>   Stage          Trait             b         E #> 1     2          Yield -1.167617e+12 857097221 #> 2     2    PlantHeight  1.254688e+13  22420339 #> 3     2 DaysToMaturity  7.244343e+13  12421006"},{"path":"https://zankrut20.github.io/selection.index/articles/multistage-linear-selection-indices.html","id":"multistage-restricted-linear-phenotypic-selection-index-mrlpsi","dir":"Articles","previous_headings":"","what":"2. Multistage Restricted Linear Phenotypic Selection Index (MRLPSI)","title":"Multistage Phenotypic Selection Indices","text":"MRLPSI method applies breeder aims maintain one quantitative traits without change multistage evaluation (e.g., maintaining constant PlantHeight optimizing variables). restricted coefficient vectors Stage 1 Stage 2 defined : ùêõR1=ùêä1ùêõ1 \\mathbf{b}_{R_1} = \\mathbf{K}_1 \\mathbf{b}_1 ùêõR2=ùêä2ùêõ2 \\mathbf{b}_{R_2} = \\mathbf{K}_2 \\mathbf{b}_2 ùêä1=ùêà1‚àíùêê1\\mathbf{K}_1 = \\mathbf{}_1 - \\mathbf{Q}_1 ùêä2=ùêà2‚àíùêê2\\mathbf{K}_2 = \\mathbf{}_2 - \\mathbf{Q}_2 matrices impose zero genetic gain vectors, derived constraint matrices ùêÇ1\\mathbf{C}_1 ùêÇ2\\mathbf{C}_2.","code":"# We constrain PlantHeight (Trait 2) at Stage 1 C1 <- matrix(0, nrow = 2, ncol = 1) C1[2, 1] <- 1  # We constrain PlantHeight (Trait 2) at Stage 2 C2 <- matrix(0, nrow = 3, ncol = 1) C2[2, 1] <- 1  mrlpsi_res <- mrlpsi(   P1 = P1, P = P, G1 = G1, C = C,   wmat = weights,   C1 = C1, C2 = C2,   selection_proportion = 0.1 ) #> Warning in .index_correlation(b_R1, b_R2, P1, P, stage1_indices): Invalid #> variance for correlation calculation. #> Warning in .adjust_phenotypic_matrix(P, P1, b_R1, k1, tau, stage1_indices): #> Invalid variance at stage 1 (b1'P1b1 <= 0). Returning unadjusted matrix. #> Warning in .adjust_genotypic_matrix(C, G1, b_R1, k1, tau, P1, stage1_indices): #> Invalid variance at stage 1 (b1'P1b1 <= 0). Returning unadjusted matrix.  # Observe that Expected Gain (E) for PlantHeight is approximately 0 mrlpsi_res$summary_stage1 #>   Stage       Trait           b_R  E #> 1     1       Yield -529172810900 NA #> 2     1 PlantHeight 4077525117142 NA"},{"path":"https://zankrut20.github.io/selection.index/articles/multistage-linear-selection-indices.html","id":"multistage-predetermined-proportional-gain-lpsi-mppg-lpsi","dir":"Articles","previous_headings":"","what":"3. Multistage Predetermined Proportional Gain LPSI (MPPG-LPSI)","title":"Multistage Phenotypic Selection Indices","text":"Unlike MRLPSI imposes zero genetic gain bounds, MPPG-LPSI forces proportional changes mapped ùêù1\\mathbf{d}_1 ùêù2\\mathbf{d}_2 restricted-difference vectors. Stage ii, difference vector creates updated target trajectory.","code":"# Target specific proportional gains d1 <- c(2, 1) # Yield gains twice as much as PlantHeight at stage 1 d2 <- c(3, 1, 0.5) # Desired proportions at stage 2  mppg_res <- mppg_lpsi(   P1 = P1, P = P, G1 = G1, C = C,   wmat = weights,   d1 = d1, d2 = d2,   selection_proportion = 0.1 ) #> Warning in .index_correlation(b_M1, b_M2, P1, P, stage1_indices): Invalid #> variance for correlation calculation. #> Warning in .adjust_phenotypic_matrix(P, P1, b_M1, k1, tau, stage1_indices): #> Invalid variance at stage 1 (b1'P1b1 <= 0). Returning unadjusted matrix. #> Warning in .adjust_genotypic_matrix(C, G1, b_M1, k1, tau, P1, stage1_indices): #> Invalid variance at stage 1 (b1'P1b1 <= 0). Returning unadjusted matrix.  # Observe the Expected Gain (E) in the resulting summary stats aligns with d1 proportions mppg_res$summary_stage1 #>   Stage       Trait           b_M d  E Ratio #> 1     1       Yield -522178847351 2 NA    NA #> 2     1 PlantHeight 4023633342185 1 NA    NA"},{"path":"https://zankrut20.github.io/selection.index/articles/multistage-linear-selection-indices.html","id":"multistage-linear-genomic-selection-index-mlgsi","dir":"Articles","previous_headings":"","what":"4. Multistage Linear Genomic Selection Index (MLGSI)","title":"Multistage Phenotypic Selection Indices","text":"modern breeding, Genomic Estimated Breeding Values (GEBVs) computed whole-genome markers accelerate cyclical selection. Multi-Stage Genomic framework, replace phenotypic estimators GEBV matrix derivations: ùö™\\mathbf{\\Gamma} (GEBV variance-covariance) replaces ùêè\\mathbf{P}. ùêÄ\\mathbf{} (Covariance GEBVs true BVs) provides genomic mappings. illustrative purposes, mock simulate arrays via pseudo-reliability scaling genetic matrices:","code":"set.seed(42) reliability <- 0.7 # Simulated genomic prediction reliability  Gamma1 <- reliability * G1 Gamma <- reliability * C A1 <- reliability * G1 A <- C[, 1:2] # n x n1 covariance mapping mlgsi_res <- mlgsi(   Gamma1 = Gamma1, Gamma = Gamma, A1 = A1, A = A,   C = C, G1 = G1, P1 = P1,   wmat = weights,   selection_proportion = 0.1 ) #> Warning in mlgsi(Gamma1 = Gamma1, Gamma = Gamma, A1 = A1, A = A, C = C, : #> Invalid phenotypic variance at stage 1. Using unadjusted C.  mlgsi_res$summary_stage1 #>   Stage       Trait beta         E #> 1     1       Yield   10 4822.1921 #> 2     1 PlantHeight   -5  126.4395"},{"path":"https://zankrut20.github.io/selection.index/articles/multistage-linear-selection-indices.html","id":"multistage-restricted-genomic-selection-index-mrlgsi","dir":"Articles","previous_headings":"","what":"5. Multistage Restricted Genomic Selection Index (MRLGSI)","title":"Multistage Phenotypic Selection Indices","text":"Similarly, traits can biologically constrained multiple genome-assisted breeding cycles.","code":"mrlgsi_res <- mrlgsi(   Gamma1 = Gamma1, Gamma = Gamma, A1 = A1, A = A,   C = C, G1 = G1, P1 = P1,   wmat = weights,   C1 = C1, C2 = C2,   selection_proportion = 0.1 )  mrlgsi_res$summary_stage2 #>   Stage          Trait    beta_R  E #> 1     2          Yield   10.0000 NA #> 2     2    PlantHeight -380.2161 NA #> 3     2 DaysToMaturity   -2.0000 NA"},{"path":"https://zankrut20.github.io/selection.index/articles/multistage-linear-selection-indices.html","id":"multistage-ppg-genomic-selection-index-mppg-lgsi","dir":"Articles","previous_headings":"","what":"6. Multistage PPG Genomic Selection Index (MPPG-LGSI)","title":"Multistage Phenotypic Selection Indices","text":"procedure calculates predetermined gains multiple cycles exclusively utilizing whole-genome predictions.","code":"mppg_lgsi_res <- mppg_lgsi(   Gamma1 = Gamma1, Gamma = Gamma, A1 = A1, A = A,   C = C, G1 = G1, P1 = P1,   wmat = weights,   d1 = d1, d2 = d2,   selection_proportion = 0.1 ) #> Warning in mppg_lgsi(Gamma1 = Gamma1, Gamma = Gamma, A1 = A1, A = A, C = C, : #> Invalid phenotypic variance at stage 1. Using unadjusted C.  mppg_lgsi_res$summary_stage1 #>   Stage       Trait  beta_P d      E  Ratio #> 1     1       Yield -0.4151 2 3.2116 1.6058 #> 2     1 PlantHeight 15.8301 1 1.6058 1.6058"},{"path":"https://zankrut20.github.io/selection.index/articles/multistage-linear-selection-indices.html","id":"statistical-properties","dir":"Articles","previous_headings":"","what":"Statistical Properties","title":"Multistage Phenotypic Selection Indices","text":"multistage indices (Phenotypic Genomic), evaluate statistical properties compare efficiency.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/multistage-linear-selection-indices.html","id":"accuracy","dir":"Articles","previous_headings":"Statistical Properties","what":"Accuracy","title":"Multistage Phenotypic Selection Indices","text":"accuracy (correlation index true breeding value) indicates efficiency index: œÅH=œÉH,IœÉHœÉI=ùêõ‚Ä≤ùêèùêõùê∞‚Ä≤ùêÇùê∞ \\rho_{H} = \\frac{\\sigma_{H, }}{\\sigma_H \\sigma_I} = \\sqrt{ \\frac{\\mathbf{b}'\\mathbf{P}\\mathbf{b}}{\\mathbf{w}'\\mathbf{C}\\mathbf{w}} }  ùêè\\mathbf{P} ùêÇ\\mathbf{C} substituted adjusted equivalents Stage 2 (ùêè*\\mathbf{P}^* ùêÇ*\\mathbf{C}^* ùö™*\\mathbf{\\Gamma}^*).","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/multistage-linear-selection-indices.html","id":"selection-response","dir":"Articles","previous_headings":"Statistical Properties","what":"Selection Response","title":"Multistage Phenotypic Selection Indices","text":"overall selection response generated index evaluates genetic superiority: R=kœÉI=kùêõ‚Ä≤ùêèùêõ R = k \\sigma_{} = k \\sqrt{\\mathbf{b}'\\mathbf{P}\\mathbf{b}}  kk selection intensity.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/multistage-linear-selection-indices.html","id":"expected-genetic-gain","dir":"Articles","previous_headings":"Statistical Properties","what":"Expected Genetic Gain","title":"Multistage Phenotypic Selection Indices","text":"expected genetic gain per individual trait given vector: ùêÑ=kùêÜ‚Ä≤ùêõœÉI=kùêÜ‚Ä≤ùêõùêõ‚Ä≤ùêèùêõ \\mathbf{E} = k \\frac{\\mathbf{G}'\\mathbf{b}}{\\sigma_I} = k \\frac{\\mathbf{G}'\\mathbf{b}}{\\sqrt{\\mathbf{b}'\\mathbf{P}\\mathbf{b}}}  Multistage Genomic Indices, ùêÜ‚Ä≤\\mathbf{G}' replaced marker association mapping matrix ùêÄ‚Ä≤\\mathbf{}'.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/multistage-linear-selection-indices.html","id":"summary","dir":"Articles","previous_headings":"","what":"Summary","title":"Multistage Phenotypic Selection Indices","text":"Multistage Selection Indices effectively manage breeding resources filtering inferior variants sequentially accurately recalibrating covariance parameters using genomic phenotypic variables across progressive evaluations. analytical tools prevent severe variance distortion breeding cycles.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/stochastic-simulation-linear-phenotypic-indices.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Stochastic Simulation of Linear Phenotypic Selection Indices","text":"Stochastic simulation provides breeders comprehensive method evaluate long-term behavior different selection indices across numerous sequential cycles. running silico (computer simulated) models, breeders can evaluate expected genetic gains, selection accuracy, eventual decay genetic variance extended selection timeframe. Chapter 10 selection.index package focuses performance comparison 50 recurrent generic population breeding cycles. package provides stochastic_simulation() function evaluate multiple restricted unrestricted linear phenotypic indices: LPSI (Linear Phenotypic Selection Index - unrestricted Smith-Hazel) ESIM (Eigen Selection Index Method - unrestricted eigen-based method) RLPSI (Restricted Linear Phenotypic Selection Index - restricted Kempthorne-Nordskog method) RESIM (Restricted Eigen Selection Index Method - restricted eigen-based method)","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/stochastic-simulation-linear-phenotypic-indices.html","id":"simulated-breeding-design","dir":"Articles","previous_headings":"Introduction","what":"Simulated Breeding Design","title":"Stochastic Simulation of Linear Phenotypic Selection Indices","text":"stochastic_simulation function mimics forward recurrent selection scheme. Within cycle, simulation performs following biological steps: 1. Recombines parental haplotypes using Haldane‚Äôs mapping function generate double-haploid lines via crossing. 2. Simulates quantitative trait variations assuming full pleiotropic model, applying sampled major/minor QTL effects. 3. Computes phenotypic score progenies applying realistic environmental variances based expected heritabilities (h2h^2). 4. Evaluates linear combinations chosen index select top-performing progenies. 5. Randomly mates selected superior lines act founders next evolutionary cycle.","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/stochastic-simulation-linear-phenotypic-indices.html","id":"running-a-simulation","dir":"Articles","previous_headings":"","what":"Running a Simulation","title":"Stochastic Simulation of Linear Phenotypic Selection Indices","text":"can run customized, small-scale simulation demonstrate tracking functionality. analyze scenario three traits trace behavior across 5 generation cycles.","code":"library(selection.index)  # To ensure reproducibility set.seed(42)"},{"path":"https://zankrut20.github.io/selection.index/articles/stochastic-simulation-linear-phenotypic-indices.html","id":"configuring-the-scenario","dir":"Articles","previous_headings":"Running a Simulation","what":"Configuring the Scenario","title":"Stochastic Simulation of Linear Phenotypic Selection Indices","text":"accordance textbook paradigm, let us analyze three genetically correlated target traits: - Trait 1: Low heritability (h2=0.2h^2 = 0.2), negatively correlated Trait 2. - Trait 2: High heritability (h2=0.5h^2 = 0.5). - Trait 3: Independent trait high heritability (h2=0.5h^2 = 0.5).","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/stochastic-simulation-linear-phenotypic-indices.html","id":"generating-genetic-effects","dir":"Articles","previous_headings":"Running a Simulation > Configuring the Scenario","what":"1. Generating Genetic Effects","title":"Stochastic Simulation of Linear Phenotypic Selection Indices","text":"First, generate known initial phenotypic genotypic covariance matrix serve baseline simulation logic markers. simplicity, simulate rapid 5-cycle breeding program across smaller subset 50 QTL markers.","code":"n_traits <- 3 n_loci <- 50 # Number of segregating sites / markers  # Generate random base QTL effects for the markers across the 3 traits # Negative correlation infused between trait 1 and 2 qtl_eff <- matrix(rnorm(n_loci * n_traits), nrow = n_loci, ncol = n_traits) qtl_eff[, 2] <- -0.5 * qtl_eff[, 1] + 0.5 * qtl_eff[, 2]  # Define heritabilities and corresponding environmental variance heritabilities <- c(0.2, 0.5, 0.5)  # Simulate base genetic variance to deduce correct environmental variance noise base_gv <- apply(qtl_eff, 2, var) * n_loci env_var <- base_gv * (1 - heritabilities) / heritabilities"},{"path":"https://zankrut20.github.io/selection.index/articles/stochastic-simulation-linear-phenotypic-indices.html","id":"formulating-constraints-and-weights","dir":"Articles","previous_headings":"Running a Simulation > Configuring the Scenario","what":"2. Formulating Constraints and Weights","title":"Stochastic Simulation of Linear Phenotypic Selection Indices","text":"indices apply equal starting economic weight. However, Restricted indices (RLPSI RESIM), force constraint onto first trait.","code":"# Equal economic trait weighting weights <- c(1, 1, 1)  # Constraint matrix for RLPSI/RESIM: Constrain Trait 1 U_mat <- matrix(0, nrow = 3, ncol = 1) U_mat[1, 1] <- 1"},{"path":"https://zankrut20.github.io/selection.index/articles/stochastic-simulation-linear-phenotypic-indices.html","id":"executing-the-simulation-routine","dir":"Articles","previous_headings":"Running a Simulation > Configuring the Scenario","what":"3. Executing the Simulation Routine","title":"Stochastic Simulation of Linear Phenotypic Selection Indices","text":"simulate_selection_cycles routine requires various inputs covering biological configuration (individuals, cycles) selection configurations (weights, restricted traits, selection proportion). Note: performance within vignette, use minimal cyclic/generational values. real breeding scenarios, set n_cycles = 50 n_individuals = 10000 mirror book‚Äôs 35,000 double-haploid evaluations.","code":"# Run the stochastic selection (may take a moment) sim_results <- simulate_selection_cycles(   n_cycles = 5,   n_individuals = 200,   n_loci = n_loci,   n_traits = n_traits,   qtl_effects = qtl_eff,   heritability = heritabilities,   economic_weights = weights,   selection_proportion = 0.25, # Select upper 25% progeny   restricted_traits = 1 )"},{"path":"https://zankrut20.github.io/selection.index/articles/stochastic-simulation-linear-phenotypic-indices.html","id":"interpreting-results","dir":"Articles","previous_headings":"","what":"Interpreting Results","title":"Stochastic Simulation of Linear Phenotypic Selection Indices","text":"simulation tracks comprehensive metrics computed methods (LPSI, ESIM, RLPSI, RESIM) across generated cycles. return object provides tracking arrays : 1. Genetic Gain (*_gain) 2. Genetic Variance (*_var) 3. Estimated Heritabilities (*_heritability) 4. Mean Phenotypic Value (*_mean)","code":""},{"path":"https://zankrut20.github.io/selection.index/articles/stochastic-simulation-linear-phenotypic-indices.html","id":"genetic-gain-trajectories","dir":"Articles","previous_headings":"Interpreting Results","what":"Genetic Gain Trajectories","title":"Stochastic Simulation of Linear Phenotypic Selection Indices","text":"can extract continuous genetic gain trajectories map success applied phenotypic criteria across multiple sequential cycles. Let‚Äôs observe restricted indices: clearly demonstrated, selection gain mapped Trait 1 drops immediately towards effectively 00, verifying restricted Kempthorne-Nordskog properties hold systematically across stochastic evaluations. comparison, unrestricted indices (LPSI) map increasing steady gains across associated traits.","code":"# Expected: Because Trait 1 was constrained via the U_mat for the RLPSI metric, # its expected generational gain should stabilize at 0. print(sim_results$rlpsi_gain) #>             [,1]       [,2]     [,3] #> [1,]  0.00000000  0.0000000 0.000000 #> [2,] -0.07991849  0.3576849 4.396779 #> [3,]  0.09595190  0.7166170 2.927811 #> [4,]  0.44428982 -0.2318664 2.712902 #> [5,]  1.14420568 -0.4358615 3.740713 print(sim_results$lpsi_gain) #>           [,1]       [,2]     [,3] #> [1,] 0.0000000  0.0000000 0.000000 #> [2,] 0.1607943 -0.4824810 3.821722 #> [3,] 1.9171279 -1.3258871 3.435662 #> [4,] 1.0369927 -0.5201380 4.007482 #> [5,] 1.1104539 -0.7914383 2.622570"},{"path":"https://zankrut20.github.io/selection.index/articles/stochastic-simulation-linear-phenotypic-indices.html","id":"decay-of-variance","dir":"Articles","previous_headings":"Interpreting Results","what":"Decay of Variance","title":"Stochastic Simulation of Linear Phenotypic Selection Indices","text":"Additionally, intense generational selection logically extinguishes raw genetic variability. selection index consistently applies extreme thresholds, available allelic variance diminishes, making subsequent trait improvements plateau.","code":"# Observe the diminishing variance arrays for the LPSI evaluations print(sim_results$lpsi_var) #> NULL"},{"path":"https://zankrut20.github.io/selection.index/articles/stochastic-simulation-linear-phenotypic-indices.html","id":"summary","dir":"Articles","previous_headings":"","what":"Summary","title":"Stochastic Simulation of Linear Phenotypic Selection Indices","text":"evaluating cyclic genetic simulations across stochastic marker environments, breeders identify crucial plateau mechanisms multidimensional indices. Specifically: - Restricted indices properly maintain prevent target constraints multi-generational limits, albeit slightly reducing overarching expected gains. - Independence traits limits associative ‚Äúride-along‚Äù gains obtained via pleiotropy highly positive correlated setups. - Accuracies degrade linearly available variant variance diminishes, confirming limits built simple additive pleiotropic models.","code":""},{"path":"https://zankrut20.github.io/selection.index/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Zankrut Goyani. Author, maintainer, copyright holder.","code":""},{"path":"https://zankrut20.github.io/selection.index/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Goyani Z (2026). selection.index: Analysis Selection Index Plant Breeding. R package version 2.0.0, https://github.com/zankrut20/selection.index.","code":"@Manual{,   title = {selection.index: Analysis of Selection Index in Plant Breeding},   author = {Zankrut Goyani},   year = {2026},   note = {R package version 2.0.0},   url = {https://github.com/zankrut20/selection.index}, }"},{"path":"https://zankrut20.github.io/selection.index/index.html","id":"selectionindex","dir":"","previous_headings":"","what":"Analysis of Selection Index in Plant Breeding","title":"Analysis of Selection Index in Plant Breeding","text":"Stop wasting days manually assembling complex variance-covariance matrices resolving selection weights. selection.index definitive, production-ready R package built specifically agricultural statisticians quantitative geneticists instantly calculate optimal multi-trait selection indices. Whether running classical phenotypic field trials building advanced genomic evaluations, package provides fully integrated mathematical engine directly maximizes genetic advance substantially accelerates breeding pipeline. üìö Read Official Documentation & Vignettes pkgdown Website","code":""},{"path":"https://zankrut20.github.io/selection.index/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Analysis of Selection Index in Plant Breeding","text":"Install stable release CRAN: Install development version GitHub:","code":"install.packages(\"selection.index\") # install.packages(\"devtools\") devtools::install_github(\"zankrut20/selection.index\")"},{"path":"https://zankrut20.github.io/selection.index/index.html","id":"quick-start-optimizing-phenotypic-selection","dir":"","previous_headings":"","what":"Quick Start: Optimizing Phenotypic Selection","title":"Analysis of Selection Index in Plant Breeding","text":"package includes several pre-configured structural datasets (seldata, maize_pheno, maize_geno) test models. , demonstrate fundamental phenotypic index evaluating multiple field traits simultaneously. combining traits unified index, breeders must cleanly partition total phenotypic variation. first use variance-covariance functions (phen_varcov() gen_varcov()) extract precise phenotypic genotypic matrices directly replicated trial data. Next, establish strict economic objectives evaluated traits. weight_mat() function rapidly converts raw economic weight arrays formalized mathematical format required core index calculation. covariance structures economic priorities firmly defined, must evaluate baseline potential population. calculate expected genetic gain primary target trait (e.g., yield) using gen_advance() function. Finally, make definitive selection decisions, dynamically evaluate trait combinations. lpsi() function constructs robust combinatorial selection indices immediately ranks predicted relative efficiency, allowing confidently select mathematically superior combination. (advanced modeling involving marker-assisted indices, multistage selection, genomic predictions, please load included maize_pheno maize_geno datasets consult pkgdown vignettes.)","code":"# Using the built-in 'seldata' dataset (Replication in Col 1, Genotype in Col 2) p_mat <- phen_varcov(data = seldata[, 3:9], genotypes = seldata[, 2], replication = seldata[, 1]) g_mat <- gen_varcov(data = seldata[, 3:9], genotypes = seldata[, 2], replication = seldata[, 1]) # Convert the built-in 'weight' configuration matrix w_mat <- weight_mat(weight) # Calculate expected genetic advance for the primary trait base_advance <- gen_advance(phen_mat = p_mat[1, 1], gen_mat = g_mat[1, 1], weight_mat = w_mat[1, 1]) base_advance #>        [,1] #> [1,] 1.2009 # Calculate and rank combinatorial selection indices optimal_index <- lpsi(   ncomb = 1, pmat = p_mat, gmat = g_mat,   wmat = weight[, 2:3], wcol = 1, GAY = base_advance ) head(optimal_index) #>   ID    b.1     GA      PRE Delta_G    rHI    hI2 Rank #> 1  1 0.6316 2.8125 234.2021  2.8125 0.4825 0.2697    1 #> 2  2 0.2396 1.3036 108.5481  1.3036 0.2237 0.2242    4 #> 3  3 1.4869 2.1526 179.2462  2.1526 0.3693 0.2690    2 #> 4  4 0.4507 0.9084  75.6402  0.9084 0.1558 0.2549    6 #> 5  5 0.3164 1.6236 135.1988  1.6236 0.2786 0.1553    3 #> 6  6 1.4499 1.0292  85.7009  1.0292 0.1766 0.1471    5"},{"path":"https://zankrut20.github.io/selection.index/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Analysis of Selection Index in Plant Breeding","text":"rely directly academic citations maintain justify continued development software ecosystem. use selection.index publication, breeding pipeline, research project, imperative cite :","code":"citation(\"selection.index\")"},{"path":[]},{"path":"https://zankrut20.github.io/selection.index/index.html","id":"direct-to-client-consulting","dir":"","previous_headings":"Support & Consulting","what":"Direct-to-Client Consulting","title":"Analysis of Selection Index in Plant Breeding","text":"scaling commercial breeding operation standardizing massive academic quantitative pipeline? offer dedicated, expert consulting researchers tailored custom selection index development, stochastic simulation modeling, full software pipeline integration. Note: operate strictly direct--client. absolutely middlemen, generic agencies, intermediaries involved. work directly package creator. discuss consulting scope availability, contact: zankrut20@gmail.com","code":""},{"path":"https://zankrut20.github.io/selection.index/index.html","id":"tip-jar","dir":"","previous_headings":"Support & Consulting","what":"Tip Jar","title":"Analysis of Selection Index in Plant Breeding","text":"package saved substantial time, simplified data pipeline, helped publish faster, please consider supporting independent development! Monetary contributions directly fund repository maintenance addition modern quantitative genetic models. Indian Users (UPI): zankrut20@oksbi International Users: Available Soon","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/base_index.html","id":null,"dir":"Reference","previous_headings":"","what":"Base Index (Williams, 1962) ‚Äî base_index","title":"Base Index (Williams, 1962) ‚Äî base_index","text":"Implements Base Index coefficients set equal economic weights. simple, non-optimized approach serves baseline comparison. Unlike Smith-Hazel index requires matrix inversion, Base Index computationally trivial robust covariance estimates unreliable.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/base_index.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Base Index (Williams, 1962) ‚Äî base_index","text":"","code":"base_index(   pmat,   gmat,   wmat,   wcol = 1,   selection_intensity = 2.063,   compare_to_lpsi = TRUE,   GAY = NULL )"},{"path":"https://zankrut20.github.io/selection.index/reference/base_index.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Base Index (Williams, 1962) ‚Äî base_index","text":"pmat Phenotypic variance-covariance matrix (n_traits x n_traits) gmat Genotypic variance-covariance matrix (n_traits x n_traits) wmat Economic weights matrix (n_traits x k), vector wcol Weight column use wmat multiple columns (default: 1) selection_intensity Selection intensity constant (default: 2.063) compare_to_lpsi Logical. TRUE, compares Base Index efficiency optimal LPSI (default: TRUE) GAY Optional. Genetic advance comparative trait PRE calculation","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/base_index.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Base Index (Williams, 1962) ‚Äî base_index","text":"List : summary - Data frame coefficients metrics b - Vector Base Index coefficients (equal w) w - Named vector economic weights Delta_G - Named vector expected genetic gains per trait lpsi_comparison - Optional comparison Smith-Hazel LPSI","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/base_index.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Base Index (Williams, 1962) ‚Äî base_index","text":"Mathematical Formulation: Index coefficients: \\(b = w\\) Base Index appropriate : - Covariance estimates unreliable - Computational simplicity required - baseline comparison needed","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/base_index.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Base Index (Williams, 1962) ‚Äî base_index","text":"","code":"if (FALSE) { # \\dontrun{ gmat <- gen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) pmat <- phen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) weights <- c(10, 8, 6, 4, 2, 1, 1)  result <- base_index(pmat, gmat, weights, compare_to_lpsi = TRUE) print(result) } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/clgsi.html","id":null,"dir":"Reference","previous_headings":"","what":"Combined Linear Genomic Selection Index (CLGSI) ‚Äî clgsi","title":"Combined Linear Genomic Selection Index (CLGSI) ‚Äî clgsi","text":"Implements Combined Linear Genomic Selection Index selection combines phenotypic observations Genomic Estimated Breeding Values (GEBVs). used selecting candidates phenotype genotype data (e.g., training population).","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/clgsi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combined Linear Genomic Selection Index (CLGSI) ‚Äî clgsi","text":"","code":"clgsi(   phen_mat = NULL,   gebv_mat = NULL,   pmat,   gmat,   wmat,   wcol = 1,   P_y = NULL,   P_g = NULL,   P_yg = NULL,   reliability = NULL,   selection_intensity = 2.063,   GAY = NULL )"},{"path":"https://zankrut20.github.io/selection.index/reference/clgsi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combined Linear Genomic Selection Index (CLGSI) ‚Äî clgsi","text":"phen_mat Matrix phenotypes (n_genotypes x n_traits). Can NULL P_y P_yg provided. gebv_mat Matrix GEBVs (n_genotypes x n_traits). Can NULL P_g P_yg provided. pmat Phenotypic variance-covariance matrix (n_traits x n_traits) gmat Genotypic variance-covariance matrix (n_traits x n_traits) wmat Economic weights matrix (n_traits x k), vector wcol Weight column use wmat multiple columns (default: 1) P_y Optional. Phenotypic variance-covariance matrix computed data (n_traits x n_traits). NULL (default), uses pmat computes phen_mat using cov(). P_g Optional. GEBV variance-covariance matrix (n_traits x n_traits). NULL (default), computed gebv_mat using cov(). P_yg Optional. Covariance matrix phenotypes GEBVs (n_traits x n_traits). NULL (default), computed phen_mat gebv_mat using cov(). reliability Optional. Reliability GEBVs (r^2, squared correlation). See lgsi() details. selection_intensity Selection intensity (default: 2.063 10% selection) GAY Optional. Genetic advance comparative trait PRE calculation","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/clgsi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combined Linear Genomic Selection Index (CLGSI) ‚Äî clgsi","text":"List components: b_y - Coefficients phenotypes b_g - Coefficients GEBVs b_combined - Full coefficient vector [b_y; b_g] P_combined - Combined variance matrix Delta_H - Expected genetic advance per trait GA - Overall genetic advance PRE - Percent relative efficiency hI2 - Index heritability rHI - Index accuracy summary - Data frame metrics","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/clgsi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Combined Linear Genomic Selection Index (CLGSI) ‚Äî clgsi","text":"Mathematical Formulation: CLGSI combines phenotypic genomic information: $$= \\mathbf{b}_y' \\mathbf{y} + \\mathbf{b}_g' \\hat{\\mathbf{g}}$$ Coefficients obtained solving partitioned system: $$\\begin{bmatrix} \\mathbf{b}_y \\\\ \\mathbf{b}_g \\end{bmatrix} =       \\begin{bmatrix} \\mathbf{P} & \\mathbf{P}_{y\\hat{g}} \\\\                       \\mathbf{P}_{y\\hat{g}}' & \\mathbf{P}_{\\hat{g}} \\end{bmatrix}^{-1}       \\begin{bmatrix} \\mathbf{G} \\\\ \\mathbf{C}_{\\hat{g}g} \\end{bmatrix} \\mathbf{w}$$ : - \\(\\mathbf{P}\\) = Var(phenotypes) - \\(\\mathbf{P}_{\\hat{g}}\\) = Var(GEBVs) - \\(\\mathbf{P}_{y\\hat{g}}\\) = Cov(phenotypes, GEBVs) - \\(\\mathbf{G}\\) = Genotypic variance-covariance - \\(\\mathbf{C}_{\\hat{g}g}\\) = Cov(GEBV, true BV)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/clgsi.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Combined Linear Genomic Selection Index (CLGSI) ‚Äî clgsi","text":"Cer√≥n-Rojas, J. J., & Crossa, J. (2018). Linear Selection Indices Modern Plant Breeding. Springer International Publishing.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/clgsi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Combined Linear Genomic Selection Index (CLGSI) ‚Äî clgsi","text":"","code":"if (FALSE) { # \\dontrun{ # Generate example data gmat <- gen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) pmat <- phen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1])  # Simulate phenotypes and GEBVs set.seed(123) n_genotypes <- 100 n_traits <- ncol(gmat)  phen_mat <- matrix(rnorm(n_genotypes * n_traits, mean = 15, sd = 3),   nrow = n_genotypes, ncol = n_traits ) gebv_mat <- matrix(rnorm(n_genotypes * n_traits, mean = 10, sd = 2),   nrow = n_genotypes, ncol = n_traits ) colnames(phen_mat) <- colnames(gmat) colnames(gebv_mat) <- colnames(gmat)  # Economic weights weights <- c(10, 5, 3, 3, 5, 8, 4)  # Calculate CLGSI result <- clgsi(phen_mat, gebv_mat, pmat, gmat, weights, reliability = 0.7) print(result$summary) } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/constants.html","id":null,"dir":"Reference","previous_headings":"","what":"Package Constants ‚Äî constants","title":"Package Constants ‚Äî constants","text":"Central location package-wide constants including design codes, numerical tolerances, configuration values.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/constrained_genomic_indices.html","id":null,"dir":"Reference","previous_headings":"","what":"Constrained Genomic Selection Indices ‚Äî constrained_genomic_indices","title":"Constrained Genomic Selection Indices ‚Äî constrained_genomic_indices","text":"Implements constrained genomic selection index methods using GEBVs. methods allow breeders impose restrictions genetic gains maintaining genomic selection efficiency. Methods included: - Restricted Linear Genomic Selection Index (RLGSI) - Predetermined Proportional Gains Linear Genomic Selection Index (PPG-LGSI) - Combined Restricted Linear Genomic Selection Index (CRLGSI) - Combined Predetermined Proportional Gains Linear Genomic Selection Index (CPPG-LGSI)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/constrained_genomic_indices.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Constrained Genomic Selection Indices ‚Äî constrained_genomic_indices","text":"Cer√≥n-Rojas, J. J., & Crossa, J. (2018). Linear Selection Indices Modern Plant Breeding. Springer International Publishing. Chapter 6.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/constrained_indices.html","id":null,"dir":"Reference","previous_headings":"","what":"Constrained Phenotypic Selection Indices (Chapter 3) ‚Äî constrained_indices","title":"Constrained Phenotypic Selection Indices (Chapter 3) ‚Äî constrained_indices","text":"Implements constrained phenotypic selection index methods Chapter 3. methods allow breeders impose restrictions genetic gains specify target gains maintaining selection efficiency. Methods included: - Restricted Linear Phenotypic Selection Index (RLPSI) - Kempthorne & Nordskog (1959) - Predetermined Proportional Gains (PPG-LPSI) - Tallis (1962) - Desired Gains Index (DG-LPSI) - Pesek & Baker (1969) implementations use C++ primitives mathematical operations.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/constrained_indices.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Constrained Phenotypic Selection Indices (Chapter 3) ‚Äî constrained_indices","text":"Kempthorne, O., & Nordskog, . W. (1959). Restricted selection indices. Biometrics, 15(1), 10-19. Tallis, G. M. (1962). selection index optimum genotype. Biometrics, 18(1), 120-122. Pesek, J., & Baker, R. J. (1969). Desired improvement relation selection indices. Canadian Journal Plant Science, 49(6), 803-804. Ceron-Rojas, J. J., & Crossa, J. (2018). Linear Selection Indices Modern Plant Breeding. Springer International Publishing. Chapter 3.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/cpp_math_primitives.html","id":null,"dir":"Reference","previous_headings":"","what":"Generic C++ Math Primitives for Experimental Design Statistics ‚Äî cpp_math_primitives","title":"Generic C++ Math Primitives for Experimental Design Statistics ‚Äî cpp_math_primitives","text":"Generic mathematical operations optimized C++/Eigen. design-specific logic - purely mathematical primitives can orchestrated R code implement experimental design. architecture allows: - Easy addition new experimental designs (R ) - C++ speed heavy computation - Single source truth (design_stats.R) - Better maintainability testability","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/cpp_wrappers.html","id":null,"dir":"Reference","previous_headings":"","what":"C++ Function Wrappers with Uniform Validation ‚Äî cpp_wrappers","title":"C++ Function Wrappers with Uniform Validation ‚Äî cpp_wrappers","text":"Thin R wrapper functions call cpp_* functions uniform input validation, type checking, error handling. Centralizes validation logic provides consistent error messages across package.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/cppg_lgsi.html","id":null,"dir":"Reference","previous_headings":"","what":"Combined Predetermined Proportional Gains Linear Genomic Selection Index (CPPG-LGSI) ‚Äî cppg_lgsi","title":"Combined Predetermined Proportional Gains Linear Genomic Selection Index (CPPG-LGSI) ‚Äî cppg_lgsi","text":"Implements CPPG-LGSI combines phenotypic genomic information achieving predetermined proportional gains traits. general constrained genomic index.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/cppg_lgsi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combined Predetermined Proportional Gains Linear Genomic Selection Index (CPPG-LGSI) ‚Äî cppg_lgsi","text":"","code":"cppg_lgsi(   T_C = NULL,   Psi_C = NULL,   d,   phen_mat = NULL,   gebv_mat = NULL,   pmat = NULL,   gmat = NULL,   wmat = NULL,   wcol = 1,   U = NULL,   reliability = NULL,   k_I = 2.063,   L_I = 1,   GAY = NULL )"},{"path":"https://zankrut20.github.io/selection.index/reference/cppg_lgsi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combined Predetermined Proportional Gains Linear Genomic Selection Index (CPPG-LGSI) ‚Äî cppg_lgsi","text":"T_C Combined variance-covariance matrix (2t x 2t) Psi_C Combined genetic covariance matrix (2t x t) d Vector desired proportional gains (length n_traits n_constraints) phen_mat Optional. Matrix phenotypes automatic T_C computation gebv_mat Optional. Matrix GEBVs automatic T_C computation pmat Optional. Phenotypic variance-covariance matrix gmat Optional. Genotypic variance-covariance matrix wmat Optional. Economic weights GA/PRE calculation wcol Weight column use wmat multiple columns (default: 1) U Optional. Constraint matrix (n_traits x n_constraints) reliability Optional. Reliability GEBVs (r^2) k_I Selection intensity (default: 2.063) L_I Standardization constant (default: 1) GAY Optional. Genetic advance comparative trait PRE calculation","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/cppg_lgsi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combined Predetermined Proportional Gains Linear Genomic Selection Index (CPPG-LGSI) ‚Äî cppg_lgsi","text":"List : summary - Data frame coefficients metrics b - Vector CPPG-LGSI coefficients (\\(\\beta_{CP}\\)) b_y - Coefficients phenotypes b_g - Coefficients GEBVs E - Expected genetic gains per trait theta_CP - Proportionality constant gain_ratios - Ratios achieved desired gains","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/cppg_lgsi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Combined Predetermined Proportional Gains Linear Genomic Selection Index (CPPG-LGSI) ‚Äî cppg_lgsi","text":"Mathematical Formulation (Chapter 6, Section 6.4): Coefficient vector: \\(beta_CP = beta_CR + theta_CP * delta_CP\\) beta_CR CRLGSI : $$theta_CP = (beta_C' * Phi_C * (Phi_C' * T_C^{-1} * Phi_C)^{-1} * d_C) / (d_C' * (Phi_C' * T_C^{-1} * Phi_C)^{-1} * d_C)$$ Selection response: \\(R_CP = (k_I / L_I) * sqrt(beta_CP' * T_C * beta_CP)\\)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/cppg_lgsi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Combined Predetermined Proportional Gains Linear Genomic Selection Index (CPPG-LGSI) ‚Äî cppg_lgsi","text":"","code":"if (FALSE) { # \\dontrun{ # Simulate data set.seed(123) n_genotypes <- 100 n_traits <- 5  phen_mat <- matrix(rnorm(n_genotypes * n_traits, 15, 3), n_genotypes, n_traits) gebv_mat <- matrix(rnorm(n_genotypes * n_traits, 10, 2), n_genotypes, n_traits)  gmat <- cov(phen_mat) * 0.6 pmat <- cov(phen_mat)  # Desired proportional gains d <- c(2, 1, 1, 0.5, 0)  w <- c(10, 8, 6, 4, 2)  result <- cppg_lgsi(   phen_mat = phen_mat, gebv_mat = gebv_mat,   pmat = pmat, gmat = gmat, d = d, wmat = w,   reliability = 0.7 ) print(result$summary) print(result$gain_ratios) } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/crlgsi.html","id":null,"dir":"Reference","previous_headings":"","what":"Combined Restricted Linear Genomic Selection Index (CRLGSI) ‚Äî crlgsi","title":"Combined Restricted Linear Genomic Selection Index (CRLGSI) ‚Äî crlgsi","text":"Implements CRLGSI combines phenotypic genomic information restrictions genetic gains. extends CLGSI include constraints.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/crlgsi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combined Restricted Linear Genomic Selection Index (CRLGSI) ‚Äî crlgsi","text":"","code":"crlgsi(   T_C = NULL,   Psi_C = NULL,   phen_mat = NULL,   gebv_mat = NULL,   pmat = NULL,   gmat = NULL,   wmat,   wcol = 1,   restricted_traits = NULL,   U = NULL,   reliability = NULL,   k_I = 2.063,   L_I = 1,   GAY = NULL )"},{"path":"https://zankrut20.github.io/selection.index/reference/crlgsi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combined Restricted Linear Genomic Selection Index (CRLGSI) ‚Äî crlgsi","text":"T_C Combined variance-covariance matrix (2t x 2t) t = n_traits. Structure: [P, P_yg; P_yg', P_g] P = phenotypic var, P_g = GEBV var, P_yg = covariance phenotypes GEBVs. Can computed automatically phen_mat gebv_mat provided. Psi_C Combined genetic covariance matrix (2t x t). Structure: [G; C_gebv_g] G = genetic var, C_gebv_g = Cov(GEBV, g). Can computed automatically gmat reliability provided. phen_mat Optional. Matrix phenotypes (n_genotypes x n_traits) gebv_mat Optional. Matrix GEBVs (n_genotypes x n_traits) pmat Optional. Phenotypic variance-covariance matrix gmat Optional. Genotypic variance-covariance matrix wmat Economic weights matrix (n_traits x k), vector wcol Weight column use wmat multiple columns (default: 1) restricted_traits Vector trait indices restrict (default: NULL) U Constraint matrix (2t x n_constraints combined traits). Alternative restricted_traits. Ignored restricted_traits provided. reliability Optional. Reliability GEBVs (r^2) k_I Selection intensity (default: 2.063) L_I Standardization constant (default: 1) GAY Optional. Genetic advance comparative trait PRE calculation","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/crlgsi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combined Restricted Linear Genomic Selection Index (CRLGSI) ‚Äî crlgsi","text":"List : summary - Data frame coefficients metrics b - Vector CRLGSI coefficients (\\(\\beta_{CR}\\)) b_y - Coefficients phenotypes b_g - Coefficients GEBVs E - Expected genetic gains per trait R - Overall selection response","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/crlgsi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Combined Restricted Linear Genomic Selection Index (CRLGSI) ‚Äî crlgsi","text":"Mathematical Formulation (Chapter 6, Section 6.3): CRLGSI combines phenotypic genomic data restrictions. Coefficient vector: \\(beta_CR = K_C * beta_C\\) K_C incorporates restriction matrix. Selection response: \\(R_CR = (k_I / L_I) * sqrt(beta_CR' * T_C * beta_CR)\\) Expected gains: \\(E_CR = (k_I / L_I) * (Psi_C * beta_CR) / sqrt(beta_CR' * T_C * beta_CR)\\)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/crlgsi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Combined Restricted Linear Genomic Selection Index (CRLGSI) ‚Äî crlgsi","text":"","code":"if (FALSE) { # \\dontrun{ # Simulate data set.seed(123) n_genotypes <- 100 n_traits <- 5  phen_mat <- matrix(rnorm(n_genotypes * n_traits, 15, 3), n_genotypes, n_traits) gebv_mat <- matrix(rnorm(n_genotypes * n_traits, 10, 2), n_genotypes, n_traits)  gmat <- cov(phen_mat) * 0.6 # Genotypic component pmat <- cov(phen_mat)  w <- c(10, 8, 6, 4, 2)  # Restrict traits 2 and 4 result <- crlgsi(   phen_mat = phen_mat, gebv_mat = gebv_mat,   pmat = pmat, gmat = gmat, wmat = w,   restricted_traits = c(2, 4), reliability = 0.7 ) print(result$summary) } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/dg_lpsi.html","id":null,"dir":"Reference","previous_headings":"","what":"Desired Gains Index (DG-LPSI) ‚Äî dg_lpsi","title":"Desired Gains Index (DG-LPSI) ‚Äî dg_lpsi","text":"Implements Pesek & Baker (1969) Desired Gains Index breeders specify target genetic gains instead economic weights. enhanced version includes calculation implied economic weights feasibility checking.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/dg_lpsi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Desired Gains Index (DG-LPSI) ‚Äî dg_lpsi","text":"","code":"dg_lpsi(   pmat,   gmat,   d,   return_implied_weights = TRUE,   check_feasibility = TRUE,   selection_intensity = 2.063 )"},{"path":"https://zankrut20.github.io/selection.index/reference/dg_lpsi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Desired Gains Index (DG-LPSI) ‚Äî dg_lpsi","text":"pmat Phenotypic variance-covariance matrix (n_traits x n_traits) gmat Genotypic variance-covariance matrix (n_traits x n_traits) d Vector desired genetic gains (length n_traits). Example: d = c(1.5, 0.8, -0.2) means gain +1.5 trait 1, +0.8 trait 2, -0.2 trait 3. return_implied_weights Logical - calculate implied economic weights? (default: TRUE) check_feasibility Logical - warn desired gains unrealistic? (default: TRUE) selection_intensity Selection intensity (default: 2.063)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/dg_lpsi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Desired Gains Index (DG-LPSI) ‚Äî dg_lpsi","text":"List : summary - Data frame coefficients, metrics, implied weights b - Vector selection index coefficients Delta_G - Named vector achieved genetic gains per trait desired_gains - Named vector desired gains (input d) gain_errors - Difference desired achieved gains implied_weights - Economic weights achieve gains Smith-Hazel LPSI implied_weights_normalized - Normalized implied weights (max absolute = 1) feasibility - Data frame feasibility analysis per trait hI2 - Index heritability rHI - Index accuracy","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/dg_lpsi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Desired Gains Index (DG-LPSI) ‚Äî dg_lpsi","text":"Mathematical Formulation: 1. Index coefficients: \\(\\mathbf{b} = \\mathbf{G}^{-1}\\mathbf{d}\\) 2. Expected response: \\(\\Delta \\mathbf{G} = (/\\sigma_I) \\mathbf{G}\\mathbf{b}\\) CRITICAL: Scale Invariance Property achieved gains \\(\\Delta\\mathbf{G}\\) determined selection intensity (), genetic variance (G), phenotypic variance (P), scaling \\(\\mathbf{b}\\). multiply \\(\\mathbf{b}\\) constant c, \\(\\sigma_I\\) also scales c, causing complete cancellation \\(\\Delta\\mathbf{G} = (/(c\\sigma_I))\\mathbf{G}(c\\mathbf{b}) = (/\\sigma_I)\\mathbf{G}\\mathbf{b}\\). DG-LPSI Actually Achieves: - Proportional gains matching RATIOS d (absolute magnitudes) - Achieved magnitude depends biological/genetic constraints - Use feasibility checking verify desired gains realistic 3. Implied economic weights (Section 1.4 Chapter 4):    $$\\hat{\\mathbf{w}} = \\mathbf{G}^{-1} \\mathbf{P} \\mathbf{b}$$ implied weights represent economic values needed Smith-Hazel index achieve desired gain PROPORTIONS. Large implied weights indicate traits \"expensive\" improve (low heritability unfavorable correlations), small weights indicate traits \"cheap\" improve. Feasibility Checking: function estimates maximum possible gains approximately 3.0 * sqrt(G_ii) (assuming intense selection ~ 3.0) warns desired gains exceed 80% theoretical maxima.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/dg_lpsi.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Desired Gains Index (DG-LPSI) ‚Äî dg_lpsi","text":"Pesek, J., & Baker, R. J. (1969). Desired improvement relation selection indices. Canadian Journal Plant Science, 49(6), 803-804.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/dg_lpsi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Desired Gains Index (DG-LPSI) ‚Äî dg_lpsi","text":"","code":"# Load data gmat <- gen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) pmat <- phen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1])  # Specify desired gains (e.g., increase each trait by 1 unit) desired_gains <- rep(1, ncol(gmat))  # Calculate Desired Gains Index with all enhancements result <- dg_lpsi(pmat, gmat, d = desired_gains) #> Warning: Desired gains may be unrealistic for trait(s): rpp, ppr, spp, pw #> Desired gains exceed 80% of theoretical maximum (i = 2.06). #> Consider reducing targets or using higher selection intensity.  # View summary print(result$summary) #>       b.1    b.2     b.3      b.4    b.5       b.6     b.7 Delta_G     hI2 rHI #> 1 11.4784 3.8899 -17.521 -17.3052 0.5096 -115.2781 71.4102 53.5871 -0.0931  NA #>   implied_w.1 implied_w.2 implied_w.3 implied_w.4 implied_w.5 implied_w.6 #> 1    -46.6372     14.1965    178.2319     72.9888    -26.4785   -256.3287 #>   implied_w.7 implied_w_norm.1 implied_w_norm.2 implied_w_norm.3 #> 1    738.7446          -0.0631           0.0192           0.2413 #>   implied_w_norm.4 implied_w_norm.5 implied_w_norm.6 implied_w_norm.7 #> 1           0.0988          -0.0358           -0.347                1  # Extract implied weights to understand relative \"cost\" of gains print(result$implied_weights_normalized) #>        sypp         dtf         rpp         ppr         ppp         spp  #> -0.06313034  0.01921701  0.24126326  0.09880111 -0.03584256 -0.34697876  #>          pw  #>  1.00000000   # Check feasibility print(result$feasibility) #>      trait desired_gain achieved_gain genetic_sd max_possible_gain #> sypp  sypp            1    0.07942154  1.1209826            2.3126 #> dtf    dtf            1    0.07942154  1.2490710            2.5768 #> rpp    rpp            1    0.07942154  0.3639840            0.7509 #> ppr    ppr            1    0.07942154  0.4931853            1.0174 #> ppp    ppp            1    0.07942154  0.9801869            2.0221 #> spp    spp            1    0.07942154  0.1319506            0.2722 #> pw      pw            1    0.07942154  0.1015121            0.2094 #>      feasibility_ratio is_realistic #> sypp            0.4324         TRUE #> dtf             0.3881         TRUE #> rpp             1.3317        FALSE #> ppr             0.9829        FALSE #> ppp             0.4945         TRUE #> spp             3.6736        FALSE #> pw              4.7751        FALSE"},{"path":"https://zankrut20.github.io/selection.index/reference/eigen_indices.html","id":null,"dir":"Reference","previous_headings":"","what":"Linear Phenotypic Eigen Selection Index Methods (Chapter 7) ‚Äî eigen_indices","title":"Linear Phenotypic Eigen Selection Index Methods (Chapter 7) ‚Äî eigen_indices","text":"Implements Linear Phenotypic Eigen Selection Index methods Chapter 7. methods resolve index coefficients maximizing accuracy squared (rho_HI^2) eigenvalue problem rather requiring pre-specified economic weights. Methods included: - ESIM   : Linear Phenotypic Eigen Selection Index (Section 7.1) - RESIM  : Linear Phenotypic Restricted Eigen Selection Index (Section 7.2) - PPG-ESIM: Predetermined Proportional Gain Eigen Selection Index (Section 7.3) implementations use C++ primitives (math_primitives.cpp) quadratic forms symmetric solves, eigendecompositions use R's eigen() correctness compatibility existing package architecture.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/eigen_indices.html","id":"mathematical-foundation","dir":"Reference","previous_headings":"","what":"Mathematical Foundation","title":"Linear Phenotypic Eigen Selection Index Methods (Chapter 7) ‚Äî eigen_indices","text":"Unlike classical LPSI requires economic weights w, ESIM family resolves index vector b_E maximizing squared accuracy: $$\\rho_{HI}^2 = \\frac{b'Cb}{b'Pb}$$ leading generalized eigenproblem \\((\\mathbf{P}^{-1}\\mathbf{C} - \\lambda^2 )b = 0\\). largest eigenvalue lambda_E^2 equals maximum achievable index heritability, corresponding eigenvector b_E contains optimal index coefficients.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/eigen_indices.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Linear Phenotypic Eigen Selection Index Methods (Chapter 7) ‚Äî eigen_indices","text":"Ceron-Rojas, J. J., & Crossa, J. (2018). Linear Selection Indices Modern Plant Breeding. Springer International Publishing. Chapter 7. Ceron-Rojas, J. J., Crossa, J., Sahagun-Castellanos, J., Castillo-Gonzalez, F., & Santacruz-Varela, . (2006). selection index method based eigen analysis. Crop Science, 46(4), 1711-1721.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/esim.html","id":null,"dir":"Reference","previous_headings":"","what":"Linear Phenotypic Eigen Selection Index (ESIM) ‚Äî esim","title":"Linear Phenotypic Eigen Selection Index (ESIM) ‚Äî esim","text":"Implements ESIM maximising squared accuracy \\(\\rho_{HI}^2\\) generalised eigenproblem multi-trait heritability matrix \\(\\mathbf{P}^{-1}\\mathbf{C}\\). Unlike Smith-Hazel LPSI, **economic weights required**.  net genetic merit vector \\(\\mathbf{w}_E\\) instead implied solution.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/esim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Linear Phenotypic Eigen Selection Index (ESIM) ‚Äî esim","text":"","code":"esim(pmat, gmat, selection_intensity = 2.063, n_indices = 1L)"},{"path":"https://zankrut20.github.io/selection.index/reference/esim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Linear Phenotypic Eigen Selection Index (ESIM) ‚Äî esim","text":"pmat Phenotypic variance-covariance matrix (n_traits x n_traits). gmat Genotypic variance-covariance matrix (n_traits x n_traits). Corresponds C Chapter 7 notation. selection_intensity Selection intensity constant \\(k_I\\) (default: 2.063 10% selection). n_indices Number leading ESIM vectors return (default: 1). Returning >1 provides ranked set indices comparative analysis.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/esim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Linear Phenotypic Eigen Selection Index (ESIM) ‚Äî esim","text":"Object class \"esim\", list : summary Data frame b coefficients, hI2, rHI, sigma_I,     Delta_G, lambda2 index requested. b Named numeric vector optimal ESIM coefficients (1st index). Delta_G Named numeric vector expected genetic gains per trait. sigma_I Standard deviation index \\(\\sigma_I\\). hI2 Index heritability \\(h^2_{I_E}\\) (= leading eigenvalue). rHI Accuracy \\(r_{HI_E}\\). lambda2 Leading eigenvalue (maximised index heritability). implied_w Implied economic weights \\(\\mathbf{w}_E\\). all_eigenvalues eigenvalues \\(\\mathbf{P}^{-1}\\mathbf{C}\\). selection_intensity Selection intensity used.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/esim.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Linear Phenotypic Eigen Selection Index (ESIM) ‚Äî esim","text":"Eigenproblem (Section 7.1): $$(\\mathbf{P}^{-1}\\mathbf{C} - \\lambda_E^2 \\mathbf{})\\mathbf{b}_E = 0$$ solution \\(\\lambda_E^2\\) (largest eigenvalue) equals maximum achievable index heritability \\(h^2_{I_E}\\). Key metrics: $$R_E = k_I \\sqrt{\\mathbf{b}_E^{\\prime}\\mathbf{P}\\mathbf{b}_E}$$ $$\\mathbf{E}_E = k_I \\frac{\\mathbf{C}\\mathbf{b}_E}{\\sqrt{\\mathbf{b}_E^{\\prime}\\mathbf{P}\\mathbf{b}_E}}$$ Implied economic weights: $$\\mathbf{w}_E = \\frac{\\sqrt{\\lambda_E^2}}{\\mathbf{b}_E^{\\prime}\\mathbf{P}\\mathbf{b}_E} \\mathbf{C}^{-1}\\mathbf{P}\\mathbf{b}_E$$ Uses cpp_symmetric_solve cpp_quadratic_form_sym math_primitives.cpp efficient matrix operations, R's eigen() eigendecomposition.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/esim.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Linear Phenotypic Eigen Selection Index (ESIM) ‚Äî esim","text":"Ceron-Rojas, J. J., & Crossa, J. (2018). Linear Selection Indices Modern Plant Breeding. Springer International Publishing. Section 7.1.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/esim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Linear Phenotypic Eigen Selection Index (ESIM) ‚Äî esim","text":"","code":"if (FALSE) { # \\dontrun{ gmat <- gen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) pmat <- phen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1])  result <- esim(pmat, gmat) print(result) summary(result) } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/estimate_missing_values.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Missing Values in Experimental Data ‚Äî estimate_missing_values","title":"Estimate Missing Values in Experimental Data ‚Äî estimate_missing_values","text":"Estimates imputes missing values randomized complete block design (RCBD), Latin square design (LSD), split plot design (SPD) experimental data. Uses one six methods: REML, Yates, Healy, Regression, Mean, Bartlett.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/estimate_missing_values.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Missing Values in Experimental Data ‚Äî estimate_missing_values","text":"","code":"estimate_missing_values(   data,   genotypes,   replications,   columns = NULL,   main_plots = NULL,   design = c(\"RCBD\", \"LSD\", \"SPD\"),   method = c(\"REML\", \"Yates\", \"Healy\", \"Regression\", \"Mean\", \"Bartlett\"),   tolerance = 1e-06 )"},{"path":"https://zankrut20.github.io/selection.index/reference/estimate_missing_values.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Missing Values in Experimental Data ‚Äî estimate_missing_values","text":"data Matrix data.frame observations (rows) traits (columns). May contain missing values (NA, NaN, Inf). genotypes Vector indicating genotype/treatment observation (sub-plot treatments SPD). replications Vector indicating replication/block (RCBD) row (LSD) observation. columns Vector indicating column index observation (required Latin Square Design ). main_plots Vector indicating main plot treatment observation (required Split Plot Design ). design Character string specifying experimental design: \"RCBD\" - Randomized Complete Block Design (default) \"LSD\" - Latin Square Design \"SPD\" - Split Plot Design method Character string specifying estimation method: REML - Restricted Maximum Likelihood BLUP. robust     complex missing patterns. (RCBD, LSD ) Yates - Traditional iterative formula. Simple fast.     Good simple missing patterns. (RCBD, LSD ) Healy - Healy & Westmacott weighted adjustment method.     stable Yates multiple missing values. (RCBD, LSD ) Regression - Linear regression QR decomposition.     Non-iterative, fast stable. (RCBD, LSD ) Mean - Mean substitution using treatment block effects.     Non-iterative, fastest. (RCBD, LSD, SPD) Bartlett - ANCOVA using traits covariates.     Best traits correlated. (RCBD, LSD ) tolerance Numeric convergence criterion iterative methods. Iteration stops maximum change estimated values falls threshold. Default: 1e-6.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/estimate_missing_values.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Missing Values in Experimental Data ‚Äî estimate_missing_values","text":"Matrix dimensions data missing values   replaced estimates.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/estimate_missing_values.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate Missing Values in Experimental Data ‚Äî estimate_missing_values","text":"function handles missing values iteratively estimating based experimental design structure: **RCBD:** 2-way blocking (genotypes √ó blocks) **LSD:** 3-way blocking (genotypes √ó rows √ó columns) **SPD:** Nested structure (blocks > main plots > sub-plots) Method Availability: RCBD: methods (REML, Yates, Healy, Regression, Mean, Bartlett) LSD: methods (REML, Yates, Healy, Regression, Mean, Bartlett) SPD: Mean (methods fall back Mean) Method Selection Guide: Use REML complex missing patterns precision critical Use Yates balanced designs missing values Use Healy multiple values missing treatment/block Use Regression fast, deterministic estimation Use Mean quick estimation precision less critical Use Bartlett traits highly correlated function uses centralized design_stats engine ANOVA computations, ensuring consistency gen_varcov(), phen_varcov(), mean_performance().","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/estimate_missing_values.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Estimate Missing Values in Experimental Data ‚Äî estimate_missing_values","text":"Yates, F. (1933). analysis replicated experiments field results incomplete. Empire Journal Experimental Agriculture, 1, 129-142. Healy, M. J. R., & Westmacott, M. (1956). Missing values experiments analysed automatic computers. Applied Statistics, 5(3), 203-206. Bartlett, M. S. (1937). examples statistical methods research agriculture applied biology. Supplement Journal Royal Statistical Society, 4(2), 137-183.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/estimate_missing_values.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate Missing Values in Experimental Data ‚Äî estimate_missing_values","text":"","code":"# RCBD example with missing values data(seldata) test_data <- seldata[, 3:5] test_data[c(1, 10, 25), 1] <- NA test_data[c(5, 15), 2] <- NA  # Impute using Yates method imputed <- estimate_missing_values(test_data, seldata$treat, seldata$rep, method = \"Yates\")  # Check that no NA remain anyNA(imputed) # Should be FALSE #> [1] FALSE  if (FALSE) { # \\dontrun{ # Latin Square Design example # lsd_data should have genotypes, rows, and columns imputed_lsd <- estimate_missing_values(   data = lsd_data[, 3:7],   genotypes = lsd_data$treat,   replications = lsd_data$row,   columns = lsd_data$col,   design = \"LSD\",   method = \"REML\" )  # Split Plot Design example # spd_data should have sub-plots, blocks, and main plots imputed_spd <- estimate_missing_values(   data = spd_data[, 3:7],   genotypes = spd_data$subplot,   replications = spd_data$block,   main_plots = spd_data$mainplot,   design = \"SPD\",   method = \"Mean\" ) } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/gen_advance.html","id":null,"dir":"Reference","previous_headings":"","what":"Genetic Advance for PRE ‚Äî gen_advance","title":"Genetic Advance for PRE ‚Äî gen_advance","text":"Genetic Advance PRE","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/gen_advance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Genetic Advance for PRE ‚Äî gen_advance","text":"","code":"gen_advance(phen_mat, gen_mat, weight_mat)"},{"path":"https://zankrut20.github.io/selection.index/reference/gen_advance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Genetic Advance for PRE ‚Äî gen_advance","text":"phen_mat phenotypic matrix value desired characters gen_mat genotypic matrix value desired characters weight_mat weight matrix value desired characters","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/gen_advance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Genetic Advance for PRE ‚Äî gen_advance","text":"Genetic advance character character combinations","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/gen_advance.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Genetic Advance for PRE ‚Äî gen_advance","text":"","code":"gmat <- gen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) pmat <- phen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) gen_advance(phen_mat = pmat[1, 1], gen_mat = gmat[1, 1], weight_mat = weight[1, 2]) #>        [,1] #> [1,] 1.2009"},{"path":"https://zankrut20.github.io/selection.index/reference/gen_varcov.html","id":null,"dir":"Reference","previous_headings":"","what":"Genotypic Variance-Covariance Analysis ‚Äî gen_varcov","title":"Genotypic Variance-Covariance Analysis ‚Äî gen_varcov","text":"Genotypic Variance-Covariance Analysis","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/gen_varcov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Genotypic Variance-Covariance Analysis ‚Äî gen_varcov","text":"","code":"gen_varcov(   data,   genotypes,   replication,   columns = NULL,   main_plots = NULL,   design_type = c(\"RCBD\", \"LSD\", \"SPD\"),   method = c(\"REML\", \"Yates\", \"Healy\", \"Regression\", \"Mean\", \"Bartlett\") )"},{"path":"https://zankrut20.github.io/selection.index/reference/gen_varcov.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Genotypic Variance-Covariance Analysis ‚Äî gen_varcov","text":"data traits analyzed genotypes vector containing genotypes/treatments (sub-plot treatments SPD) replication vector containing replication/blocks (RCBD) rows (LSD) columns vector containing columns (required Latin Square Design ) main_plots vector containing main plot treatments (required Split Plot Design ) design_type experimental design type: \"RCBD\" (default), \"LSD\" (Latin Square), \"SPD\" (Split Plot) method Method missing value imputation: \"REML\" (default), \"Yates\", \"Healy\", \"Regression\", \"Mean\", \"Bartlett\"","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/gen_varcov.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Genotypic Variance-Covariance Analysis ‚Äî gen_varcov","text":"Genotypic Variance-Covariance Matrix","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/gen_varcov.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Genotypic Variance-Covariance Analysis ‚Äî gen_varcov","text":"","code":"# RCBD example gen_varcov(data = seldata[, 3:9], genotypes = seldata$treat, replication = seldata$rep) #>            sypp         dtf          rpp          ppr         ppp          spp #> sypp 1.25660210  0.32936305  0.158785900  0.242981986  0.73499020  0.127571993 #> dtf  0.32936305  1.56017847  0.173388420 -0.312908175 -0.23310004  0.116790239 #> rpp  0.15878590  0.17338842  0.132484364 -0.031596521  0.32014873 -0.008643769 #> ppr  0.24298199 -0.31290818 -0.031596521  0.243231727  0.30192365 -0.020860985 #> ppp  0.73499020 -0.23310004  0.320148725  0.301923650  0.96076644 -0.069172364 #> spp  0.12757199  0.11679024 -0.008643769 -0.020860985 -0.06917236  0.017410958 #> pw   0.09261588  0.03298807 -0.012353519  0.007352443 -0.05824420  0.008560105 #>                pw #> sypp  0.092615879 #> dtf   0.032988075 #> rpp  -0.012353519 #> ppr   0.007352443 #> ppp  -0.058244197 #> spp   0.008560105 #> pw    0.010304709  # Latin Square Design example (requires columns parameter) # gen_varcov(data=lsd_data[,3:7], genotypes=lsd_data$treat, #           replication=lsd_data$row, columns=lsd_data$col, design_type=\"LSD\")  # Split Plot Design example (requires main_plots parameter) # gen_varcov(data=spd_data[,3:7], genotypes=spd_data$subplot, #           replication=spd_data$block, main_plots=spd_data$mainplot, design_type=\"SPD\")"},{"path":"https://zankrut20.github.io/selection.index/reference/genetic_genomic_varcov.html","id":null,"dir":"Reference","previous_headings":"","what":"Genetic-Genomic Variance-Covariance Matrix (A) ‚Äî genetic_genomic_varcov","title":"Genetic-Genomic Variance-Covariance Matrix (A) ‚Äî genetic_genomic_varcov","text":"Computes genetic-genomic covariance matrix () defined Chapter 8 (Equation 8.12) GESIM related genomic eigen selection indices. Structure: = [[C, C_g-gamma], [C_gamma-g, \\(\\Gamma\\)]]  (2t x 2t, square symmetric) : - C = Var(g) = true genotypic variance-covariance (t x t) - \\(\\Gamma\\) = Var(\\(\\gamma\\)) = genomic variance-covariance (t x t) - C_g-gamma = Cov(g, \\(\\gamma\\)) = covariance true BVs GEBVs (t x t) - C_gamma-g = Cov(\\(\\gamma\\), g) = transpose C_g-gamma (t x t)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/genetic_genomic_varcov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Genetic-Genomic Variance-Covariance Matrix (A) ‚Äî genetic_genomic_varcov","text":"","code":"genetic_genomic_varcov(   gmat,   Gamma = NULL,   reliability = NULL,   C_gebv_g = NULL,   square = TRUE )"},{"path":"https://zankrut20.github.io/selection.index/reference/genetic_genomic_varcov.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Genetic-Genomic Variance-Covariance Matrix (A) ‚Äî genetic_genomic_varcov","text":"gmat Genotypic variance-covariance matrix (n_traits x n_traits) Gamma Genomic variance-covariance matrix (n_traits x n_traits). NULL, assumed equal gmat (perfect prediction). reliability Optional. Reliability GEBVs (r¬≤ = squared correlation GEBV true BV). Can : - Single value (applied traits) - Vector length n_traits (one per trait) - NULL (default): assumes C_g,\\(\\gamma\\) = Gamma (unbiased GEBVs reliability = 1) C_gebv_g Optional. Direct specification Cov(\\(\\gamma\\), g) matrix (t x t). provided, overrides reliability parameter. square Logical. TRUE (default), returns (2t √ó 2t) square matrix required GESIM. FALSE, returns (2t √ó t) rectangular form LMSI.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/genetic_genomic_varcov.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Genetic-Genomic Variance-Covariance Matrix (A) ‚Äî genetic_genomic_varcov","text":"Genetic-genomic covariance matrix:   - square = TRUE: (2t √ó 2t) symmetric matrix GESIM/eigen indices   - square = FALSE: (2t √ó t) rectangular matrix LMSI   t number traits","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/genetic_genomic_varcov.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Genetic-Genomic Variance-Covariance Matrix (A) ‚Äî genetic_genomic_varcov","text":"genetic-genomic matrix relates selection phenotypes + GEBVs expected genetic gains. **GESIM (Chapter 8):** Requires full (2t √ó 2t) square matrix eigenproblem: (\\(\\Phi\\)^(-1) - \\(\\lambda\\))b = 0 **LMSI/CLGSI (Chapter 4):** Can use rectangular (2t √ó t) form equation: b = P^(-1) G w, G (2t √ó t). reliability provided: - \\(C_{\\gamma g}\\) = diag(\\(\\sqrt{r^2}\\)) reliability NULL: - \\(C_{\\gamma g}\\) = Gamma (assumes unbiased GEBVs, perfect prediction)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/genetic_genomic_varcov.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Genetic-Genomic Variance-Covariance Matrix (A) ‚Äî genetic_genomic_varcov","text":"Cer√≥n-Rojas, J. J., & Crossa, J. (2018). Linear Selection Indices Modern Plant Breeding. Springer International Publishing. Chapters 4 & 8.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/genetic_genomic_varcov.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Genetic-Genomic Variance-Covariance Matrix (A) ‚Äî genetic_genomic_varcov","text":"","code":"if (FALSE) { # \\dontrun{ # Generate example data gmat <- gen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1])  # Simulate genomic covariance Gamma <- gmat * 0.8  # For GESIM: Get square (2t √ó 2t) matrix A_square <- genetic_genomic_varcov(gmat, Gamma, reliability = 0.7) print(dim(A_square)) # Should be 14 x 14 (2t √ó 2t)  # For LMSI: Get rectangular (2t √ó t) matrix A_rect <- genetic_genomic_varcov(gmat, Gamma, reliability = 0.7, square = FALSE) print(dim(A_rect)) # Should be 14 x 7 (2t √ó t) } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/genomic-varcov.html","id":null,"dir":"Reference","previous_headings":"","what":"Genomic Variance-Covariance Functions ‚Äî genomic-varcov","title":"Genomic Variance-Covariance Functions ‚Äî genomic-varcov","text":"Functions computing genomic variance-covariance matrices GEBVs combined phenomic-genomic matrices genomic selection indices.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/genomic_eigen_indices.html","id":null,"dir":"Reference","previous_headings":"","what":"Linear Molecular and Genomic Eigen Selection Index Methods (Chapter 8) ‚Äî genomic_eigen_indices","title":"Linear Molecular and Genomic Eigen Selection Index Methods (Chapter 8) ‚Äî genomic_eigen_indices","text":"Implements Linear Molecular Genomic Eigen Selection Index methods Chapter 8. methods extend eigen-based selection genomic/molecular data, maximizing accuracy squared (rho_HI^2) eigenvalue problems without requiring pre-specified economic weights. Methods included: - MESIM    : Molecular Eigen Selection Index Method (Section 8.1) - GESIM    : Linear Genomic Eigen Selection Index Method (Section 8.2) - GW-ESIM  : Genome-Wide Linear Eigen Selection Index Method (Section 8.3) - RGESIM   : Restricted Linear Genomic Eigen Selection Index Method (Section 8.4) - PPG-GESIM: Predetermined Proportional Gain Genomic Eigen Selection Index (Section 8.5) implementations use C++ primitives (math_primitives.cpp) quadratic forms symmetric solves, eigendecompositions use R's eigen() correctness compatibility existing package architecture.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/genomic_eigen_indices.html","id":"mathematical-foundation","dir":"Reference","previous_headings":"","what":"Mathematical Foundation","title":"Linear Molecular and Genomic Eigen Selection Index Methods (Chapter 8) ‚Äî genomic_eigen_indices","text":"Like phenotypic ESIM (Chapter 7), genomic eigen methods maximize squared accuracy index net genetic merit, incorporate molecular markers, GEBVs, genome-wide marker scores. general approach solves generalized eigenproblem find optimal index coefficients maximize heritability without requiring economic weights.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/genomic_eigen_indices.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Linear Molecular and Genomic Eigen Selection Index Methods (Chapter 8) ‚Äî genomic_eigen_indices","text":"Ceron-Rojas, J. J., & Crossa, J. (2018). Linear Selection Indices Modern Plant Breeding. Springer International Publishing. Chapter 8.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/genomic_indices.html","id":null,"dir":"Reference","previous_headings":"","what":"Genomic Selection Indices ‚Äî genomic_indices","title":"Genomic Selection Indices ‚Äî genomic_indices","text":"Implements genomic selection indices using GEBVs (Genomic Estimated Breeding Values). Methods included: - Linear Genomic Selection Index (LGSI) - Combined Linear Genomic Selection Index (CLGSI - phenotypes + GEBVs)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/genomic_varcov.html","id":null,"dir":"Reference","previous_headings":"","what":"Genomic Variance-Covariance Matrix (\\(\\Gamma\\)) ‚Äî genomic_varcov","title":"Genomic Variance-Covariance Matrix (\\(\\Gamma\\)) ‚Äî genomic_varcov","text":"Computes genomic variance-covariance matrix (\\(\\Gamma\\) Gamma) matrix Genomic Estimated Breeding Values (GEBVs). \\(\\gamma\\) (gamma) represents GEBV vectors obtained genomic prediction models (e.g., GBLUP, rrBLUP, Genomic BLUP). function computes Var(\\(\\gamma\\)) = \\(\\Gamma\\).","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/genomic_varcov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Genomic Variance-Covariance Matrix (\\(\\Gamma\\)) ‚Äî genomic_varcov","text":"","code":"genomic_varcov(gebv_mat, method = \"pearson\", use = \"complete.obs\")"},{"path":"https://zankrut20.github.io/selection.index/reference/genomic_varcov.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Genomic Variance-Covariance Matrix (\\(\\Gamma\\)) ‚Äî genomic_varcov","text":"gebv_mat Matrix GEBVs (n_genotypes x n_traits) method Character string specifying correlation method: \"pearson\" (default), \"kendall\", \"spearman\" use Character string specifying handle missing values: \"everything\" (default), \"complete.obs\", \"pairwise.complete.obs\", etc. See cov details.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/genomic_varcov.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Genomic Variance-Covariance Matrix (\\(\\Gamma\\)) ‚Äî genomic_varcov","text":"Symmetric genomic variance-covariance matrix (n_traits x n_traits)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/genomic_varcov.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Genomic Variance-Covariance Matrix (\\(\\Gamma\\)) ‚Äî genomic_varcov","text":"genomic variance-covariance matrix \\(\\Gamma\\) captures genetic variation predicted molecular markers. computed : \\(\\gamma_i\\) GEBV vector genotype \\(\\mu_{\\gamma}\\) mean GEBV vector. **Missing Value Handling:** - \"complete.obs\": Uses complete observations (recommended) - \"pairwise.complete.obs\": Uses pairwise-complete observations (may PSD) - \"everything\": Fails NA present using pairwise deletion, resulting matrix may positive semi-definite (PSD), can cause numerical issues selection indices. **Applications:** selection index theory: - Used LGSI (Linear Genomic Selection Index) - Component \\(\\Phi\\) (phenomic-genomic covariance) - Component (genetic-genomic covariance)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/genomic_varcov.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Genomic Variance-Covariance Matrix (\\(\\Gamma\\)) ‚Äî genomic_varcov","text":"Cer√≥n-Rojas, J. J., & Crossa, J. (2018). Linear Selection Indices Modern Plant Breeding. Springer International Publishing. Chapters 4 & 8.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/genomic_varcov.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Genomic Variance-Covariance Matrix (\\(\\Gamma\\)) ‚Äî genomic_varcov","text":"","code":"if (FALSE) { # \\dontrun{ # Simulate GEBVs set.seed(123) n_genotypes <- 100 n_traits <- 5 gebv_mat <- matrix(rnorm(n_genotypes * n_traits),   nrow = n_genotypes, ncol = n_traits ) colnames(gebv_mat) <- paste0(\"Trait\", 1:n_traits)  # Compute genomic variance-covariance Gamma <- genomic_varcov(gebv_mat) print(Gamma) } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/gesim.html","id":null,"dir":"Reference","previous_headings":"","what":"Linear Genomic Eigen Selection Index Method (GESIM) ‚Äî gesim","title":"Linear Genomic Eigen Selection Index Method (GESIM) ‚Äî gesim","text":"Implements GESIM maximising squared accuracy generalised eigenproblem combining phenotypic data GEBVs (Genomic Estimated Breeding Values). economic weights required.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/gesim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Linear Genomic Eigen Selection Index Method (GESIM) ‚Äî gesim","text":"","code":"gesim(pmat, gmat, Gamma, selection_intensity = 2.063)"},{"path":"https://zankrut20.github.io/selection.index/reference/gesim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Linear Genomic Eigen Selection Index Method (GESIM) ‚Äî gesim","text":"pmat Phenotypic variance-covariance matrix (n_traits x n_traits). gmat Genotypic variance-covariance matrix (n_traits x n_traits). Gamma Covariance phenotypes GEBVs (n_traits x n_traits). represents Cov(y, gamma) gamma GEBVs. selection_intensity Selection intensity constant \\(k_I\\) (default: 2.063 10% selection).","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/gesim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Linear Genomic Eigen Selection Index Method (GESIM) ‚Äî gesim","text":"Object class \"gesim\", list : summary Data frame coefficients metrics. b_y Coefficients phenotypic data. b_gamma Coefficients GEBVs. b_combined Combined coefficient vector. E_G Expected genetic gains per trait. sigma_I Standard deviation index. hI2 Index heritability (= leading eigenvalue). rHI Accuracy \\(r_{HI}\\). R_G Selection response. lambda2 Leading eigenvalue. implied_w Implied economic weights. selection_intensity Selection intensity used.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/gesim.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Linear Genomic Eigen Selection Index Method (GESIM) ‚Äî gesim","text":"Eigenproblem (Section 8.2): $$(\\mathbf{\\Phi}^{-1}\\mathbf{} - \\lambda_G^2 \\mathbf{}_{2t})\\boldsymbol{\\beta}_G = 0$$ : $$\\mathbf{\\Phi} = \\begin{bmatrix} \\mathbf{P} & \\mathbf{\\Gamma} \\\\ \\mathbf{\\Gamma} & \\mathbf{\\Gamma} \\end{bmatrix}$$ $$\\mathbf{} = \\begin{bmatrix} \\mathbf{C} & \\mathbf{\\Gamma} \\\\ \\mathbf{\\Gamma} & \\mathbf{\\Gamma} \\end{bmatrix}$$ Implied economic weights: $$\\mathbf{w}_G = \\mathbf{}^{-1}\\mathbf{\\Phi}\\boldsymbol{\\beta}$$ Selection response: $$R_G = k_I \\sqrt{\\boldsymbol{\\beta}_G^{\\prime}\\mathbf{\\Phi}\\boldsymbol{\\beta}_G}$$ Expected genetic gain per trait: $$\\mathbf{E}_G = k_I \\frac{\\mathbf{}\\boldsymbol{\\beta}_G}{\\sqrt{\\boldsymbol{\\beta}_G^{\\prime}\\mathbf{\\Phi}\\boldsymbol{\\beta}_G}}$$","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/gesim.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Linear Genomic Eigen Selection Index Method (GESIM) ‚Äî gesim","text":"Ceron-Rojas, J. J., & Crossa, J. (2018). Linear Selection Indices Modern Plant Breeding. Springer International Publishing. Section 8.2.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/gesim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Linear Genomic Eigen Selection Index Method (GESIM) ‚Äî gesim","text":"","code":"if (FALSE) { # \\dontrun{ gmat <- gen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) pmat <- phen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1])  # Simulate GEBV covariance (in practice, compute from genomic predictions) Gamma <- gmat * 0.8 # Assume 80% GEBV-phenotype covariance  result <- gesim(pmat, gmat, Gamma) print(result) } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/gw_esim.html","id":null,"dir":"Reference","previous_headings":"","what":"Genome-Wide Linear Eigen Selection Index Method (GW-ESIM) ‚Äî gw_esim","title":"Genome-Wide Linear Eigen Selection Index Method (GW-ESIM) ‚Äî gw_esim","text":"Implements GW-ESIM incorporating genome-wide marker effects directly eigen selection index framework. Uses N marker scores alongside phenotypic data.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/gw_esim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Genome-Wide Linear Eigen Selection Index Method (GW-ESIM) ‚Äî gw_esim","text":"","code":"gw_esim(pmat, gmat, G_M, M, selection_intensity = 2.063)"},{"path":"https://zankrut20.github.io/selection.index/reference/gw_esim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Genome-Wide Linear Eigen Selection Index Method (GW-ESIM) ‚Äî gw_esim","text":"pmat Phenotypic variance-covariance matrix (n_traits x n_traits). gmat Genotypic variance-covariance matrix (n_traits x n_traits). G_M Covariance phenotypes marker scores (n_traits x N_markers). M Variance-covariance matrix marker scores (N_markers x N_markers). selection_intensity Selection intensity constant \\(k_I\\) (default: 2.063 10% selection).","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/gw_esim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Genome-Wide Linear Eigen Selection Index Method (GW-ESIM) ‚Äî gw_esim","text":"Object class \"gw_esim\", list : summary Data frame key metrics. b_y Coefficients phenotypic data. b_m Coefficients marker scores. b_combined Combined coefficient vector. E_W Expected genetic gains per trait. sigma_I Standard deviation index. hI2 Index heritability (= leading eigenvalue). rHI Accuracy. R_W Selection response. lambda2 Leading eigenvalue. selection_intensity Selection intensity used.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/gw_esim.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Genome-Wide Linear Eigen Selection Index Method (GW-ESIM) ‚Äî gw_esim","text":"Eigenproblem (Section 8.3): $$(\\mathbf{Q}^{-1}\\mathbf{X} - \\lambda_W^2 \\mathbf{}_{(t+N)})\\boldsymbol{\\beta}_W = 0$$ : $$\\mathbf{Q} = \\begin{bmatrix} \\mathbf{P} & \\mathbf{G}_M \\\\ \\mathbf{G}_M^{\\prime} & \\mathbf{M} \\end{bmatrix}$$ $$\\mathbf{X} = \\begin{bmatrix} \\mathbf{C} & \\mathbf{G}_M \\\\ \\mathbf{G}_M^{\\prime} & \\mathbf{M} \\end{bmatrix}$$ Selection response: $$R_W = k_I \\sqrt{\\boldsymbol{\\beta}_W^{\\prime}\\mathbf{Q}\\boldsymbol{\\beta}_W}$$ Expected genetic gain per trait: $$\\mathbf{E}_W = k_I \\frac{\\mathbf{X}\\boldsymbol{\\beta}_W}{\\sqrt{\\boldsymbol{\\beta}_W^{\\prime}\\mathbf{Q}\\boldsymbol{\\beta}_W}}$$","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/gw_esim.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Genome-Wide Linear Eigen Selection Index Method (GW-ESIM) ‚Äî gw_esim","text":"Ceron-Rojas, J. J., & Crossa, J. (2018). Linear Selection Indices Modern Plant Breeding. Springer International Publishing. Section 8.3.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/gw_esim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Genome-Wide Linear Eigen Selection Index Method (GW-ESIM) ‚Äî gw_esim","text":"","code":"if (FALSE) { # \\dontrun{ gmat <- gen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) pmat <- phen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1])  # Simulate marker data N_markers <- 100 n_traits <- nrow(gmat) G_M <- matrix(rnorm(n_traits * N_markers, sd = 0.5), n_traits, N_markers) M <- diag(N_markers) + matrix(rnorm(N_markers^2, sd = 0.1), N_markers, N_markers) M <- (M + t(M)) / 2 # Make symmetric  result <- gw_esim(pmat, gmat, G_M, M) print(result) } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/gw_lmsi.html","id":null,"dir":"Reference","previous_headings":"","what":"Genome-Wide Linear Marker Selection Index (GW-LMSI) ‚Äî gw_lmsi","title":"Genome-Wide Linear Marker Selection Index (GW-LMSI) ‚Äî gw_lmsi","text":"Implements GW-LMSI uses available genome-wide markers directly predictors selection index. Unlike LMSI uses aggregated marker scores per trait, GW-LMSI treats individual marker separate predictor.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/gw_lmsi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Genome-Wide Linear Marker Selection Index (GW-LMSI) ‚Äî gw_lmsi","text":"","code":"gw_lmsi(   marker_mat,   trait_mat = NULL,   gmat,   P_GW = NULL,   G_GW = NULL,   wmat,   wcol = 1,   lambda = 0,   selection_intensity = 2.063,   GAY = NULL )"},{"path":"https://zankrut20.github.io/selection.index/reference/gw_lmsi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Genome-Wide Linear Marker Selection Index (GW-LMSI) ‚Äî gw_lmsi","text":"marker_mat Matrix marker genotypes (n_genotypes x n_markers). Typically coded -1, 0, 1 0, 1, 2. trait_mat Matrix trait values (n_genotypes x n_traits). Used compute G_GW provided. gmat Genotypic variance-covariance matrix (n_traits x n_traits). P_GW Marker covariance matrix (n_markers x n_markers). NULL, computed Var(marker_mat). G_GW Covariance markers traits (n_markers x n_traits). NULL, computed Cov(marker_mat, trait_mat). wmat Economic weights matrix (n_traits x k), vector. wcol Weight column use wmat multiple columns (default: 1). lambda Ridge regularization parameter (default: 0). lambda > 0, uses P_GW + lambda*regularization. Automatic warnings issued n_markers > n_genotypes (high-dimensional case) P_GW ill-conditioned. Recommended values: 0.01-0.1 times mean(diag(P_GW)). selection_intensity Selection intensity k (default: 2.063 10% selection). GAY Optional. Genetic advance comparative trait PRE calculation.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/gw_lmsi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Genome-Wide Linear Marker Selection Index (GW-LMSI) ‚Äî gw_lmsi","text":"List class \"gw_lmsi\" components: b Index coefficients markers (n_markers). P_GW Marker covariance matrix (n_markers x n_markers). G_GW Covariance markers traits (n_markers x n_traits). rHI Index accuracy (correlation index breeding objective). sigma_I Standard deviation index. R Selection response (k * sigma_I). Delta_H Expected genetic gain per trait (vector length n_traits). GA Overall genetic advance breeding objective. PRE Percent relative efficiency (GAY provided). hI2 Index heritability. lambda Ridge regularization parameter used. n_markers Number markers. high_dimensional Logical indicating n_markers > n_genotypes. condition_number Condition number P_GW (computed). summary Data frame metrics.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/gw_lmsi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Genome-Wide Linear Marker Selection Index (GW-LMSI) ‚Äî gw_lmsi","text":"Mathematical Formulation: GW-LMSI maximizes correlation index \\(I_{GW} = \\mathbf{b}_{GW}^{\\prime}\\mathbf{m}\\) breeding objective \\(H = \\mathbf{w}^{\\prime}\\mathbf{g}\\). Marker covariance matrix: $$\\mathbf{P}_{GW} = Var(\\mathbf{m})$$ Covariance markers traits: $$\\mathbf{G}_{GW} = Cov(\\mathbf{m}, \\mathbf{g})$$ Index coefficients (optional Ridge regularization): $$\\mathbf{b}_{GW} = (\\mathbf{P}_{GW} + \\lambda \\mathbf{})^{-1} \\mathbf{G}_{GW} \\mathbf{w}$$ Accuracy: $$\\rho_{HI} = \\sqrt{\\frac{\\mathbf{b}_{GW}^{\\prime} \\mathbf{G}_{GW} \\mathbf{w}}{\\mathbf{w}^{\\prime} \\mathbf{G} \\mathbf{w}}}$$ Selection response: $$R_{GW} = k \\sqrt{\\mathbf{b}_{GW}^{\\prime} \\mathbf{P}_{GW} \\mathbf{b}_{GW}}$$ Expected genetic gain per trait: $$\\mathbf{E}_{GW} = k \\frac{\\mathbf{G}_{GW}^{\\prime} \\mathbf{b}_{GW}}{\\sigma_{I_{GW}}}$$ Note Singularity Detection Regularization: function automatically detects problematic cases: 1. **High-dimensional case**: n_markers > n_genotypes, P_GW mathematically    singular (rank-deficient). function issues warning suggests    appropriate lambda value. 2. **Ill-conditioned case**: P_GW high condition number (> 1e10),    indicating numerical instability. 3. **Numerical singularity**: P_GW eigenvalues near zero. Ridge regularization adds \\(\\lambda\\)P_GW, ensuring positive definiteness. Recommended lambda values 0.01-0.1 times average diagonal element P_GW. Users can also set lambda = 0 force generalized inverse (less stable sometimes needed).","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/gw_lmsi.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Genome-Wide Linear Marker Selection Index (GW-LMSI) ‚Äî gw_lmsi","text":"Lande, R., & Thompson, R. (1990). Efficiency marker-assisted selection improvement quantitative traits. Genetics, 124(3), 743-756. Cer√≥n-Rojas, J. J., & Crossa, J. (2018). Linear Selection Indices Modern Plant Breeding. Springer International Publishing. Chapter 4.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/gw_lmsi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Genome-Wide Linear Marker Selection Index (GW-LMSI) ‚Äî gw_lmsi","text":"","code":"if (FALSE) { # \\dontrun{ # Load data data(seldata) gmat <- gen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1])  # Simulate marker data set.seed(123) n_genotypes <- 100 n_markers <- 200 n_traits <- ncol(gmat)  # Marker matrix (coded as 0, 1, 2) marker_mat <- matrix(sample(0:2, n_genotypes * n_markers, replace = TRUE),   nrow = n_genotypes, ncol = n_markers )  # Trait matrix trait_mat <- matrix(rnorm(n_genotypes * n_traits, mean = 15, sd = 3),   nrow = n_genotypes, ncol = n_traits )  # Economic weights weights <- c(10, 5, 3, 3, 5, 8, 4)  # Calculate GW-LMSI with Ridge regularization result <- gw_lmsi(marker_mat, trait_mat, gmat,   wmat = weights, lambda = 0.01 ) print(result$summary) } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/haldane_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Haldane's Mapping Function ‚Äî haldane_mapping","title":"Haldane's Mapping Function ‚Äî haldane_mapping","text":"Converts genetic distance (Morgans) recombination fraction using Haldane's mapping function. function models relationship genetic distance probability recombination loci.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/haldane_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Haldane's Mapping Function ‚Äî haldane_mapping","text":"","code":"haldane_mapping(distance)"},{"path":"https://zankrut20.github.io/selection.index/reference/haldane_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Haldane's Mapping Function ‚Äî haldane_mapping","text":"distance Genetic distance Morgans (scalar vector). One Morgan corresponds 50% recombination frequency.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/haldane_mapping.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Haldane's Mapping Function ‚Äî haldane_mapping","text":"Recombination fraction (r) ranging 0 0.5.   - r = 0 indicates complete linkage (recombination)   - r = 0.5 indicates independent assortment (unlinked loci)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/haldane_mapping.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Haldane's Mapping Function ‚Äî haldane_mapping","text":"Mathematical Formula (Chapter 10, Section 10.1): relationship recombination fraction (r) genetic distance (d): $$r = \\frac{1}{2}(1 - e^{-2d})$$ : - d = Genetic distance Morgans - r = Recombination fraction (probability recombination per meiosis) function assumes crossover interference beyond implied mapping function .","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/haldane_mapping.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Haldane's Mapping Function ‚Äî haldane_mapping","text":"","code":"# Zero distance means complete linkage (no recombination) haldane_mapping(0) # Returns 0 #> [1] 0  # 1 Morgan distance haldane_mapping(1) # Returns ~0.43 #> [1] 0.4323324  # Large distance approaches 0.5 (independent assortment) haldane_mapping(10) # Returns ~0.5 #> [1] 0.5  # Vector of distances distances <- c(0, 0.1, 0.5, 1.0, 2.0) haldane_mapping(distances) #> [1] 0.00000000 0.09063462 0.31606028 0.43233236 0.49084218"},{"path":"https://zankrut20.github.io/selection.index/reference/inverse_haldane_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverse Haldane Mapping Function ‚Äî inverse_haldane_mapping","title":"Inverse Haldane Mapping Function ‚Äî inverse_haldane_mapping","text":"Converts recombination fraction back genetic distance (Morgans). inverse Haldane's mapping function.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/inverse_haldane_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverse Haldane Mapping Function ‚Äî inverse_haldane_mapping","text":"","code":"inverse_haldane_mapping(recombination_fraction)"},{"path":"https://zankrut20.github.io/selection.index/reference/inverse_haldane_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverse Haldane Mapping Function ‚Äî inverse_haldane_mapping","text":"recombination_fraction Recombination fraction (r) 0 0.5.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/inverse_haldane_mapping.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inverse Haldane Mapping Function ‚Äî inverse_haldane_mapping","text":"Genetic distance Morgans.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/inverse_haldane_mapping.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Inverse Haldane Mapping Function ‚Äî inverse_haldane_mapping","text":"Mathematical Formula: Solving Haldane's equation d: $$d = -\\frac{1}{2} \\ln(1 - 2r)$$","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/inverse_haldane_mapping.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Inverse Haldane Mapping Function ‚Äî inverse_haldane_mapping","text":"","code":"# Convert recombination fraction to distance inverse_haldane_mapping(0.25) # Returns ~0.347 Morgans #> [1] 0.3465736 inverse_haldane_mapping(0.5) # Returns Inf (unlinked) #> Warning: recombination_fraction = 0.5 corresponds to infinite genetic distance #> [1] Inf"},{"path":"https://zankrut20.github.io/selection.index/reference/lgsi.html","id":null,"dir":"Reference","previous_headings":"","what":"Linear Genomic Selection Index (LGSI) ‚Äî lgsi","title":"Linear Genomic Selection Index (LGSI) ‚Äî lgsi","text":"Implements Linear Genomic Selection Index selection based solely Genomic Estimated Breeding Values (GEBVs). used selecting candidates genotyped phenotyped (e.g., testing population).","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/lgsi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Linear Genomic Selection Index (LGSI) ‚Äî lgsi","text":"","code":"lgsi(   gebv_mat,   gmat,   wmat,   wcol = 1,   reliability = NULL,   selection_intensity = 2.063,   GAY = NULL )"},{"path":"https://zankrut20.github.io/selection.index/reference/lgsi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Linear Genomic Selection Index (LGSI) ‚Äî lgsi","text":"gebv_mat Matrix GEBVs (n_genotypes x n_traits) gmat Genotypic variance-covariance matrix (n_traits x n_traits) wmat Economic weights matrix (n_traits x k), vector wcol Weight column use wmat multiple columns (default: 1) reliability Optional. Reliability GEBVs (correlation GEBV true BV). Can : - Single value (applied traits) - Vector length n_traits (one per trait) - NULL (default): estimated GEBV variance (assumes reliability = GEBV_var / G_var) selection_intensity Selection intensity (default: 2.063 10% selection) GAY Optional. Genetic advance comparative trait PRE calculation","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/lgsi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Linear Genomic Selection Index (LGSI) ‚Äî lgsi","text":"List components: b - Index coefficients P_gebv - GEBV variance-covariance matrix reliability - Reliability values used Delta_H - Expected genetic advance per trait GA - Overall genetic advance index PRE - Percent relative efficiency (GAY provided) hI2 - Index heritability rHI - Index accuracy sigma_I - Standard deviation index summary - Data frame metrics","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/lgsi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Linear Genomic Selection Index (LGSI) ‚Äî lgsi","text":"Mathematical Formulation: LGSI maximizes correlation index = b' * gebv Index coefficients: \\(\\mathbf{b} = \\mathbf{P}_{\\hat{g}}^{-1} \\mathbf{C}_{\\hat{g}g} \\mathbf{w}\\) : - \\(\\mathbf{P}_{\\hat{g}}\\) = Var(gebv) - variance-covariance GEBVs - \\(\\mathbf{C}_{\\hat{g}g}\\) = Cov(gebv, g) - covariance GEBVs true breeding values reliability (r) known: \\(\\mathbf{C}_{\\hat{g}g} = \\text{diag}(r) \\mathbf{P}_{\\hat{g}}\\) Expected response: \\(\\Delta \\mathbf{H} = \\frac{}{\\sigma_I} \\mathbf{C}_{\\hat{g}g} \\mathbf{b}\\)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/lgsi.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Linear Genomic Selection Index (LGSI) ‚Äî lgsi","text":"Cer√≥n-Rojas, J. J., & Crossa, J. (2018). Linear Selection Indices Modern Plant Breeding. Springer International Publishing.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/lgsi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Linear Genomic Selection Index (LGSI) ‚Äî lgsi","text":"","code":"if (FALSE) { # \\dontrun{ # Generate example data gmat <- gen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1])  # Simulate GEBVs (in practice, these come from genomic prediction) set.seed(123) n_genotypes <- 100 n_traits <- ncol(gmat) gebv_mat <- matrix(rnorm(n_genotypes * n_traits, mean = 10, sd = 2),   nrow = n_genotypes, ncol = n_traits ) colnames(gebv_mat) <- colnames(gmat)  # Economic weights weights <- c(10, 5, 3, 3, 5, 8, 4)  # Calculate LGSI result <- lgsi(gebv_mat, gmat, weights, reliability = 0.7) print(result$summary) } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/lmsi.html","id":null,"dir":"Reference","previous_headings":"","what":"Linear Marker Selection Index (LMSI) ‚Äî lmsi","title":"Linear Marker Selection Index (LMSI) ‚Äî lmsi","text":"Implements LMSI combines phenotypic information molecular marker scores statistically significant markers (Lande & Thompson, 1990). index = b_y' * y + b_s' * s, y phenotypes s marker scores.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/lmsi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Linear Marker Selection Index (LMSI) ‚Äî lmsi","text":"","code":"lmsi(   phen_mat = NULL,   marker_scores = NULL,   pmat,   gmat,   G_s = NULL,   wmat,   wcol = 1,   selection_intensity = 2.063,   GAY = NULL )"},{"path":"https://zankrut20.github.io/selection.index/reference/lmsi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Linear Marker Selection Index (LMSI) ‚Äî lmsi","text":"phen_mat Matrix phenotypes (n_genotypes x n_traits). Can NULL G_s provided directly (theoretical case covariance structure known without needing empirical data). marker_scores Matrix marker scores (n_genotypes x n_traits). computed s_j = sum(x_jk * beta_jk) x_jk coded marker value beta_jk estimated marker effect trait j. Can NULL G_s provided directly. pmat Phenotypic variance-covariance matrix (n_traits x n_traits). gmat Genotypic variance-covariance matrix (n_traits x n_traits). G_s Genomic covariance matrix explained markers (n_traits x n_traits). represents Var(s) approximates Cov(y, s) markers fully explain genetic variance. provided, phen_mat marker_scores become optional covariance structure specified directly. NULL, computed empirically marker_scores phen_mat. wmat Economic weights matrix (n_traits x k), vector. wcol Weight column use wmat multiple columns (default: 1). selection_intensity Selection intensity k (default: 2.063 10% selection). GAY Optional. Genetic advance comparative trait PRE calculation.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/lmsi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Linear Marker Selection Index (LMSI) ‚Äî lmsi","text":"List class \"lmsi\" components: b_y Coefficients phenotypes (n_traits vector). b_s Coefficients marker scores (n_traits vector). b_combined Combined coefficient vector [b_y; b_s] (2*n_traits vector). P_L Combined phenotypic-marker covariance matrix (2*n_traits x 2*n_traits). G_L Combined genetic-marker covariance matrix (2*n_traits x n_traits). G_s Genomic covariance matrix explained markers (n_traits x n_traits). rHI Index accuracy (correlation index breeding objective). sigma_I Standard deviation index. R Selection response (k * sigma_I). Delta_H Expected genetic gain per trait (vector length n_traits). GA Overall genetic advance breeding objective. PRE Percent relative efficiency (GAY provided). hI2 Index heritability. summary Data frame coefficients metrics (combined view). phenotype_coeffs Data frame phenotype coefficients . marker_coeffs Data frame marker score coefficients . coeff_analysis Data frame coefficient distribution analysis.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/lmsi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Linear Marker Selection Index (LMSI) ‚Äî lmsi","text":"Mathematical Formulation: LMSI maximizes correlation index \\(I_{LMSI} = \\mathbf{b}_y^{\\prime}\\mathbf{y} + \\mathbf{b}_s^{\\prime}\\mathbf{s}\\) breeding objective \\(H = \\mathbf{w}^{\\prime}\\mathbf{g}\\). Combined covariance matrices: $$\\mathbf{P}_L = \\begin{bmatrix} \\mathbf{P} & \\text{Cov}(\\mathbf{y}, \\mathbf{s}) \\\\ \\text{Cov}(\\mathbf{y}, \\mathbf{s})^{\\prime} & \\text{Var}(\\mathbf{s}) \\end{bmatrix}$$ $$\\mathbf{G}_L = \\begin{bmatrix} \\mathbf{G} \\\\ \\mathbf{G}_s \\end{bmatrix}$$ \\(\\mathbf{P}\\) phenotypic variance, \\(\\text{Cov}(\\mathbf{y}, \\mathbf{s})\\) covariance phenotypes marker scores (computed data), \\(\\text{Var}(\\mathbf{s})\\) variance marker scores, \\(\\mathbf{G}\\) genotypic variance, \\(\\mathbf{G}_s\\) represents genetic covariance explained markers. Index coefficients: $$\\mathbf{b}_{LMSI} = \\mathbf{P}_L^{-1} \\mathbf{G}_L \\mathbf{w}$$ Accuracy: $$\\rho_{HI} = \\sqrt{\\frac{\\mathbf{b}_{LMSI}^{\\prime} \\mathbf{G}_L \\mathbf{w}}{\\mathbf{w}^{\\prime} \\mathbf{G} \\mathbf{w}}}$$ Selection response: $$R_{LMSI} = k \\sigma_{I_{LMSI}} = k \\sqrt{\\mathbf{b}_{LMSI}^{\\prime} \\mathbf{P}_L \\mathbf{b}_{LMSI}}$$ Expected genetic gain per trait: $$\\mathbf{E}_{LMSI} = k \\frac{\\mathbf{G}_L^{\\prime} \\mathbf{b}_{LMSI}}{\\sigma_{I_{LMSI}}}$$","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/lmsi.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Linear Marker Selection Index (LMSI) ‚Äî lmsi","text":"Lande, R., & Thompson, R. (1990). Efficiency marker-assisted selection improvement quantitative traits. Genetics, 124(3), 743-756. Cer√≥n-Rojas, J. J., & Crossa, J. (2018). Linear Selection Indices Modern Plant Breeding. Springer International Publishing. Chapter 4.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/lmsi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Linear Marker Selection Index (LMSI) ‚Äî lmsi","text":"","code":"if (FALSE) { # \\dontrun{ # Load data data(seldata) pmat <- phen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) gmat <- gen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1])  # Simulate marker scores (in practice, computed from QTL mapping) set.seed(123) n_genotypes <- 100 n_traits <- ncol(gmat) marker_scores <- matrix(rnorm(n_genotypes * n_traits, mean = 5, sd = 1.5),   nrow = n_genotypes, ncol = n_traits ) colnames(marker_scores) <- colnames(gmat)  # Simulate phenotypes phen_mat <- matrix(rnorm(n_genotypes * n_traits, mean = 15, sd = 3),   nrow = n_genotypes, ncol = n_traits ) colnames(phen_mat) <- colnames(gmat)  # Economic weights weights <- c(10, 5, 3, 3, 5, 8, 4)  # Calculate LMSI result <- lmsi(phen_mat, marker_scores, pmat, gmat,   G_s = NULL, wmat = weights ) print(result$summary) } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/lpsi.html","id":null,"dir":"Reference","previous_headings":"","what":"Combinatorial Linear Phenotypic Selection Index ‚Äî lpsi","title":"Combinatorial Linear Phenotypic Selection Index ‚Äî lpsi","text":"Build possible Smith-Hazel selection indices trait combinations, optional exclusion specific traits. function systematically evaluates indices combinations ncomb traits, useful identifying efficient subset traits selection.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/lpsi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combinatorial Linear Phenotypic Selection Index ‚Äî lpsi","text":"","code":"lpsi(ncomb, pmat, gmat, wmat, wcol = 1, GAY, excluding_trait = NULL)"},{"path":"https://zankrut20.github.io/selection.index/reference/lpsi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combinatorial Linear Phenotypic Selection Index ‚Äî lpsi","text":"ncomb Number traits per combination pmat Phenotypic variance-covariance matrix gmat Genotypic variance-covariance matrix wmat Weight matrix wcol Weight column number one weight set (default: 1) GAY Genetic advance comparative trait (optional) excluding_trait Optional. Traits exclude combinations. Can : (1) numeric vector trait indices (e.g., c(1, 3)), (2) character vector trait names (e.g., c(\"sypp\", \"dtf\")), (3) data frame/matrix columns trait data (trait names extracted column names). specified, combinations contain traits returned.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/lpsi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Combinatorial Linear Phenotypic Selection Index ‚Äî lpsi","text":"Data frame possible selection indices metrics (GA, PRE, Delta_G, rHI, hI2)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/lpsi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Combinatorial Linear Phenotypic Selection Index ‚Äî lpsi","text":"","code":"if (FALSE) { # \\dontrun{ gmat <- gen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) pmat <- phen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) wmat <- weight_mat(weight)  # Build all 3-trait indices result <- lpsi(ncomb = 3, pmat = pmat, gmat = gmat, wmat = wmat, wcol = 1)  # Exclude specific traits result <- lpsi(   ncomb = 3, pmat = pmat, gmat = gmat, wmat = wmat,   excluding_trait = c(1, 3) ) } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/maize_geno.html","id":null,"dir":"Reference","previous_headings":"","what":"Synthetic Maize Genomic Data ‚Äî maize_geno","title":"Synthetic Maize Genomic Data ‚Äî maize_geno","text":"synthetic dataset containing Single Nucleotide Polymorphism (SNP) marker data 100 maize genotypes found maize_pheno. Designed testing genomic selection indices (GESIM/RGESIM) relationship matrices.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/maize_geno.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Synthetic Maize Genomic Data ‚Äî maize_geno","text":"","code":"data(maize_geno)"},{"path":"https://zankrut20.github.io/selection.index/reference/maize_geno.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Synthetic Maize Genomic Data ‚Äî maize_geno","text":"numeric matrix 100 rows (genotypes) 500 columns (SNP markers): Rows 100 genotypes, matching Genotype column maize_pheno. Columns 500 simulated SNP markers, coded 0, 1, 2.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/maize_geno.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Synthetic Maize Genomic Data ‚Äî maize_geno","text":"Simulated selection.index package provide reproducible examples.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/maize_geno.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Synthetic Maize Genomic Data ‚Äî maize_geno","text":"","code":"data(maize_geno) dim(maize_geno) #> [1] 100 500"},{"path":"https://zankrut20.github.io/selection.index/reference/maize_pheno.html","id":null,"dir":"Reference","previous_headings":"","what":"Synthetic Maize Phenotypic Data ‚Äî maize_pheno","title":"Synthetic Maize Phenotypic Data ‚Äî maize_pheno","text":"synthetic dataset containing multi-environment phenotypic records 100 maize genotypes. Designed demonstrate phenotypic selection index calculations variance-covariance matrix estimations.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/maize_pheno.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Synthetic Maize Phenotypic Data ‚Äî maize_pheno","text":"","code":"data(maize_pheno)"},{"path":"https://zankrut20.github.io/selection.index/reference/maize_pheno.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Synthetic Maize Phenotypic Data ‚Äî maize_pheno","text":"data frame 600 rows 6 variables: Genotype Factor representing 100 unique maize genotypes. Environment Factor representing 2 distinct growing environments. Block Factor representing 3 replicate blocks within environment. Yield Numeric vector grain yield kg/ha. PlantHeight Numeric vector plant height centimeters. DaysToMaturity Numeric vector days physiological maturity.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/maize_pheno.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Synthetic Maize Phenotypic Data ‚Äî maize_pheno","text":"Simulated selection.index package provide reproducible examples.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/maize_pheno.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Synthetic Maize Phenotypic Data ‚Äî maize_pheno","text":"","code":"data(maize_pheno) head(maize_pheno) #>   Genotype Environment Block   Yield PlantHeight DaysToMaturity #> 1     G001        Env1    B1 8260.29      224.83            117 #> 2     G002        Env1    B1 7460.15      197.42            119 #> 3     G003        Env1    B1 8069.62      211.43            117 #> 4     G004        Env1    B1 7957.63      214.27            116 #> 5     G005        Env1    B1 7666.68      198.77            119 #> 6     G006        Env1    B1 6741.96      182.73            116"},{"path":"https://zankrut20.github.io/selection.index/reference/marker_indices.html","id":null,"dir":"Reference","previous_headings":"","what":"Linear Marker and Genome-Wide Selection Indices (Chapter 4) ‚Äî marker_indices","title":"Linear Marker and Genome-Wide Selection Indices (Chapter 4) ‚Äî marker_indices","text":"Implements marker-based selection indices Chapter 4 (Lande & Thompson, 1990). methods incorporate molecular marker information directly selection indices. Methods included: - LMSI    : Linear Marker Selection Index (Section 4.1) - GW-LMSI : Genome-Wide Linear Marker Selection Index (Section 4.2)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mean_performance.html","id":null,"dir":"Reference","previous_headings":"","what":"Mean performance of phenotypic data ‚Äî mean_performance","title":"Mean performance of phenotypic data ‚Äî mean_performance","text":"Mean performance phenotypic data","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mean_performance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mean performance of phenotypic data ‚Äî mean_performance","text":"","code":"mean_performance(   data,   genotypes,   replications,   columns = NULL,   main_plots = NULL,   design_type = c(\"RCBD\", \"LSD\", \"SPD\"),   method = c(\"REML\", \"Yates\", \"Healy\", \"Regression\", \"Mean\", \"Bartlett\") )"},{"path":"https://zankrut20.github.io/selection.index/reference/mean_performance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Mean performance of phenotypic data ‚Äî mean_performance","text":"data data analysis genotypes genotypes vector (sub-plot treatments SPD) replications replication vector columns vector containing columns (required Latin Square Design ) main_plots vector containing main plot treatments (required Split Plot Design ) design_type experimental design type: \"RCBD\" (default), \"LSD\" (Latin Square), \"SPD\" (Split Plot) method Method missing value imputation: \"REML\" (default), \"Yates\", \"Healy\", \"Regression\", \"Mean\", \"Bartlett\"","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mean_performance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Mean performance of phenotypic data ‚Äî mean_performance","text":"Dataframe mean performance analysis","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mean_performance.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Mean performance of phenotypic data ‚Äî mean_performance","text":"","code":"mean_performance(data = seldata[, 3:9], genotypes = seldata[, 2], replications = seldata[, 1]) #>          Genotypes    sypp     dtf     rpp     ppr       ppp       spp      pw #> 1               G1  5.4722 42.7778  3.0528  3.3096    7.6648    2.7716  0.6809 #> 2               G2  6.6886 43.3333  2.6926  3.5114    9.9167    2.9759  0.6033 #> 3               G3  4.5523 45.0000  1.9405  2.4756    5.3135     3.189  0.7036 #> 4               G4  7.0072 44.1667  2.5500  3.3149    9.1233    3.2364  0.6526 #> 5               G5  7.0139 43.8889  2.5517  3.4179    9.0833    3.0849  0.6513 #> 6               G6  6.1368 43.0555  2.0667  2.8366    6.6375    3.3055  0.8359 #> 7               G7  4.9012 43.0555  2.1806  2.6361    5.9431    2.9613  0.6761 #> 8               G8  5.5278 45.8333  2.4417  3.1168    7.6875     2.883  0.5705 #> 9               G9  8.5787 43.0556  2.2639  3.9815    7.4282    3.0415  0.9469 #> 10             G10  3.8491 43.8889  1.9444  3.0413    5.8222     2.633  0.6218 #> 11             G11  7.0748 44.7222  2.1620  3.4081    6.4491    3.1748  0.9267 #> 12             G12  6.6061 43.0555  1.7379  3.7300    5.9402    3.0557  0.8817 #> 13             G13  6.7768 43.3333  1.9926  3.5000    6.3241    3.0185  0.8398 #> 14             G14  8.1632 43.0555  2.6083  4.2528    8.4208    3.0795  0.7400 #> 15             G15  4.2917 44.4444  1.3056  3.9732    5.4815    2.9307  0.6044 #> 16             G16  6.5927 43.6111  2.7672  3.4045    9.4709    3.0198  0.6834 #> 17             G17  6.9761 43.6111  2.5000  3.1718    8.9793     2.997  0.6490 #> 18             G18  6.2523 43.0555  2.4924  4.0041    8.5348    2.9679  0.6435 #> 19             G19  7.7929 46.6667  2.5204  2.5698    6.6426    3.5118  0.9076 #> 20             G20  7.6460 42.2222  1.6481  4.2279    7.0185     3.459  0.9427 #> 21             G21  7.8182 45.8333  2.3352  3.1918    8.1148    3.2166  0.7387 #> 22             G22  7.6370 49.1666  2.8333  2.9459    6.3555     3.266  0.8327 #> 23             G23  5.2694 43.8889  2.3185  2.8056    5.9037    3.2192  0.6252 #> 24             G24  5.4680 43.0555  1.9778  2.3801    4.8652    3.0723  0.6928 #> 25             G25  6.7222 45.2778  2.5741  2.3148    6.4852    3.2884  0.8429 #> 26             Min  3.8491 42.2222  1.3056  2.3148    4.8652     2.633  0.5705 #> 27             Max  8.5787 49.1666  3.0528  4.2528    9.9167    3.5118  0.9469 #> 28              GM  6.4326 44.1222  2.2983  3.2609    7.1843    3.0944  0.7398 #> 29          CV (%) 14.6650  3.4200 13.4103 14.5324   25.2971    8.3125 14.9911 #> 30             SEm  0.5446  0.8712  0.1779  0.2736    1.0493    0.1485  0.0640 #> 31           CD 5%  1.5487  2.4772  0.5060  0.7780    2.9836    0.4223  0.1821 #> 32           CD 1%  2.0659  3.3047  0.6750  1.0378 3.9801 NS 0.5633 NS  0.2429 #> 33    Heritability  0.5854  0.4066  0.5824  0.5200    0.2253    0.2083  0.4559 #> 34 Heritability(%) 58.5422 40.6596 58.2402 51.9951   22.5334   20.8333 45.5894"},{"path":"https://zankrut20.github.io/selection.index/reference/mesim.html","id":null,"dir":"Reference","previous_headings":"","what":"Molecular Eigen Selection Index Method (MESIM) ‚Äî mesim","title":"Molecular Eigen Selection Index Method (MESIM) ‚Äî mesim","text":"Implements MESIM maximising squared accuracy generalised eigenproblem combining phenotypic data molecular marker scores. Unlike Smith-Hazel LPSI, **economic weights required**.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mesim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Molecular Eigen Selection Index Method (MESIM) ‚Äî mesim","text":"","code":"mesim(pmat, gmat, S_M, S_Mg = NULL, S_var = NULL, selection_intensity = 2.063)"},{"path":"https://zankrut20.github.io/selection.index/reference/mesim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Molecular Eigen Selection Index Method (MESIM) ‚Äî mesim","text":"pmat Phenotypic variance-covariance matrix (n_traits x n_traits). gmat Genotypic variance-covariance matrix (n_traits x n_traits). S_M Covariance phenotypes marker scores (n_traits x n_traits). represents Cov(y, s) s marker scores. Used phenotypic variance matrix T_M. S_Mg Covariance genetic values marker scores (n_traits x n_traits). represents Cov(g, s). Used genetic variance matrix Psi_M. NULL (default), uses S_M, appropriate assuming Cov(e, s) ~= 0 (errors uncorrelated markers), Cov(y,s) ~= Cov(g,s). S_var Variance-covariance matrix marker scores (n_traits x n_traits). Represents Var(s). NULL (default), uses S_M backward compatibility, providing actual Var(s) statistically rigorous. selection_intensity Selection intensity constant \\(k_I\\) (default: 2.063 10% selection).","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mesim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Molecular Eigen Selection Index Method (MESIM) ‚Äî mesim","text":"Object class \"mesim\", list : summary Data frame coefficients metrics. b_y Coefficients phenotypic data. b_s Coefficients marker scores. b_combined Combined coefficient vector. E_M Expected genetic gains per trait. sigma_I Standard deviation index. hI2 Index heritability (= leading eigenvalue). rHI Accuracy \\(r_{HI}\\). R_M Selection response. lambda2 Leading eigenvalue (maximised index heritability). selection_intensity Selection intensity used.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mesim.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Molecular Eigen Selection Index Method (MESIM) ‚Äî mesim","text":"Eigenproblem (Section 8.1): $$(\\mathbf{T}_M^{-1}\\mathbf{\\Psi}_M - \\lambda_M^2 \\mathbf{}_{2t})\\boldsymbol{\\beta}_M = 0$$ : $$\\mathbf{T}_M = \\begin{bmatrix} \\mathbf{P} & \\mathrm{Cov}(\\mathbf{y},\\mathbf{s}) \\\\ \\mathrm{Cov}(\\mathbf{s},\\mathbf{y}) & \\mathrm{Var}(\\mathbf{s}) \\end{bmatrix}$$ $$\\mathbf{\\Psi}_M = \\begin{bmatrix} \\mathbf{C} & \\mathrm{Cov}(\\mathbf{g},\\mathbf{s}) \\\\ \\mathrm{Cov}(\\mathbf{s},\\mathbf{g}) & \\mathrm{Var}(\\mathbf{s}) \\end{bmatrix}$$ Theoretical distinction: T_M uses phenotypic covariances: Cov(y, s) provided via S_M Psi_M uses genetic covariances: Cov(g, s) provided via S_Mg Since y = g + e, Cov(e, s) ~= 0, Cov(y, s) ~= Cov(g, s) Chapter 8.1 assumes marker scores pure genetic predictors,         S_M can used (default behavior S_Mg = NULL) solution \\(\\lambda_M^2\\) (largest eigenvalue) equals maximum achievable index heritability. Key metrics: $$R_M = k_I \\sqrt{\\boldsymbol{\\beta}_{M}^{\\prime}\\mathbf{T}_M\\boldsymbol{\\beta}_{M}}$$ $$\\mathbf{E}_M = k_I \\frac{\\mathbf{\\Psi}_M\\boldsymbol{\\beta}_{M}}{\\sqrt{\\boldsymbol{\\beta}_{M}^{\\prime}\\mathbf{T}_M\\boldsymbol{\\beta}_{M}}}$$","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mesim.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Molecular Eigen Selection Index Method (MESIM) ‚Äî mesim","text":"Ceron-Rojas, J. J., & Crossa, J. (2018). Linear Selection Indices Modern Plant Breeding. Springer International Publishing. Section 8.1.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mesim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Molecular Eigen Selection Index Method (MESIM) ‚Äî mesim","text":"","code":"if (FALSE) { # \\dontrun{ gmat <- gen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) pmat <- phen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1])  # Simulate marker score matrices (in practice, compute from data) S_M <- gmat * 0.7 # Cov(y, s) - phenotype-marker covariance S_Mg <- gmat * 0.65 # Cov(g, s) - genetic-marker covariance S_var <- gmat * 0.8 # Var(s) - marker score variance  # Most rigorous: Provide all three covariance matrices result <- mesim(pmat, gmat, S_M, S_Mg = S_Mg, S_var = S_var) print(result)  # Standard usage: Cov(g,s) defaults to Cov(y,s) when errors uncorrelated result_standard <- mesim(pmat, gmat, S_M, S_var = S_var)  # Backward compatible: Chapter 8.1 simplified notation result_simple <- mesim(pmat, gmat, S_M) } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/missing-value.html","id":null,"dir":"Reference","previous_headings":"","what":"Missing Value Imputation for Experimental Designs ‚Äî missing-value","title":"Missing Value Imputation for Experimental Designs ‚Äî missing-value","text":"Exported wrapper missing value estimation RCBD, Latin Square, Split Plot designs. Calls centralized design_stats engine ANOVA computations.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mlgsi.html","id":null,"dir":"Reference","previous_headings":"","what":"Multistage Linear Genomic Selection Index (MLGSI) ‚Äî mlgsi","title":"Multistage Linear Genomic Selection Index (MLGSI) ‚Äî mlgsi","text":"Implements two-stage Linear Genomic Selection Index selection based GEBVs stages covariance adjustments due selection effects.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mlgsi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multistage Linear Genomic Selection Index (MLGSI) ‚Äî mlgsi","text":"","code":"mlgsi(   Gamma1,   Gamma,   A1,   A,   C,   G1,   P1,   wmat,   wcol = 1,   selection_proportion = 0.1,   use_young_method = FALSE,   k1_manual = 2.063,   k2_manual = 2.063,   tau = NULL,   reliability = NULL )"},{"path":"https://zankrut20.github.io/selection.index/reference/mlgsi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multistage Linear Genomic Selection Index (MLGSI) ‚Äî mlgsi","text":"Gamma1 GEBV variance-covariance matrix stage 1 traits (n1 x n1) Gamma GEBV variance-covariance matrix traits stage 2 (n x n) A1 Covariance matrix GEBVs true breeding values stage 1 (n1 x n1) Covariance matrix GEBVs true breeding values stage 2 (n x n1) C Genotypic variance-covariance matrix traits (n x n) G1 Genotypic variance-covariance matrix stage 1 traits (n1 x n1) P1 Phenotypic variance-covariance matrix stage 1 traits (n1 x n1) wmat Economic weights vector matrix (n x k) wcol Weight column use wmat multiple columns (default: 1) selection_proportion Proportion selected stage (default: 0.1) use_young_method Logical. Use Young's method selection intensities (default: FALSE). Young's method tends overestimate intensities; manual intensities recommended. k1_manual Manual selection intensity stage 1 k2_manual Manual selection intensity stage 2 tau Standardized truncation point reliability Optional reliability vector computing matrices","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mlgsi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multistage Linear Genomic Selection Index (MLGSI) ‚Äî mlgsi","text":"List components: beta1 - Stage 1 genomic index coefficients w - Economic weights (stage 2 coefficients) stage1_metrics - List stage 1 metrics (R1, E1, rho_HI1) stage2_metrics - List stage 2 metrics (R2, E2, rho_HI2) Gamma_star - Adjusted genomic covariance matrix stage 2 C_star - Adjusted genotypic covariance matrix stage 2 rho_I1I2 - Correlation stage 1 stage 2 indices k1 - Selection intensity stage 1 k2 - Selection intensity stage 2 summary_stage1 - Data frame stage 1 summary summary_stage2 - Data frame stage 2 summary","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mlgsi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Multistage Linear Genomic Selection Index (MLGSI) ‚Äî mlgsi","text":"Mathematical Formulation: Stage 1: genomic index \\(I_1 = \\mathbf{\\beta}_1' \\mathbf{\\gamma}_1\\) Coefficients: \\(\\mathbf{\\beta}_1 = \\mathbf{\\Gamma}_1^{-1}\\mathbf{}_1\\mathbf{w}_1\\) Stage 2: index uses economic weights directly: \\(I_2 = \\mathbf{w}' \\mathbf{\\gamma}\\) Adjusted genomic covariance matrix: $$\\mathbf{\\Gamma}^* = \\mathbf{\\Gamma} - u \\frac{\\mathbf{}_1'\\mathbf{\\beta}_1\\mathbf{\\beta}_1'\\mathbf{}_1}{\\mathbf{\\beta}_1'\\mathbf{\\Gamma}_1\\mathbf{\\beta}_1}$$ Adjusted genotypic covariance matrix: $$\\mathbf{C}^* = \\mathbf{C} - u \\frac{\\mathbf{G}_1'\\mathbf{b}_1\\mathbf{b}_1'\\mathbf{G}_1}{\\mathbf{b}_1'\\mathbf{P}_1\\mathbf{b}_1}$$ \\(u = k_1(k_1 - \\tau)\\) Accuracy stage 1: \\(\\rho_{HI_1} = \\sqrt{\\frac{\\mathbf{\\beta}_1'\\mathbf{\\Gamma}_1\\mathbf{\\beta}_1}{\\mathbf{w}'\\mathbf{C}\\mathbf{w}}}\\) Accuracy stage 2: \\(\\rho_{HI_2} = \\sqrt{\\frac{\\mathbf{w}'\\mathbf{\\Gamma}^*\\mathbf{w}}{\\mathbf{w}'\\mathbf{C}^*\\mathbf{w}}}\\)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mlgsi.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Multistage Linear Genomic Selection Index (MLGSI) ‚Äî mlgsi","text":"Ceron-Rojas, J. J., & Crossa, J. (2018). Linear Selection Indices Modern Plant Breeding. Springer International Publishing. Chapter 9, Section 9.4.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mlgsi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Multistage Linear Genomic Selection Index (MLGSI) ‚Äî mlgsi","text":"","code":"if (FALSE) { # \\dontrun{ # Two-stage genomic selection example # Stage 1: Select based on GEBVs for 3 traits # Stage 2: Select based on GEBVs for all 7 traits  # Compute covariance matrices gmat <- gen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) pmat <- phen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1])  # Simulate GEBV covariances (in practice, compute from genomic prediction) set.seed(123) reliability <- 0.7 Gamma1 <- reliability * gmat[1:3, 1:3] Gamma <- reliability * gmat A1 <- reliability * gmat[1:3, 1:3] A <- gmat[, 1:3]  # Economic weights weights <- c(10, 8, 6, 4, 3, 2, 1)  # Run MLGSI result <- mlgsi(   Gamma1 = Gamma1, Gamma = Gamma, A1 = A1, A = A,   C = gmat, G1 = gmat[1:3, 1:3], P1 = pmat[1:3, 1:3],   wmat = weights, selection_proportion = 0.1 )  print(result$summary_stage1) print(result$summary_stage2) } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/mlpsi.html","id":null,"dir":"Reference","previous_headings":"","what":"Multistage Linear Phenotypic Selection Index (MLPSI) ‚Äî mlpsi","title":"Multistage Linear Phenotypic Selection Index (MLPSI) ‚Äî mlpsi","text":"Implements two-stage Linear Phenotypic Selection Index selection occurs two different stages covariance adjustments due selection effects using Cochran/Cunningham's method.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mlpsi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multistage Linear Phenotypic Selection Index (MLPSI) ‚Äî mlpsi","text":"","code":"mlpsi(   P1,   P,   G1,   C,   wmat,   wcol = 1,   stage1_indices = NULL,   selection_proportion = 0.1,   use_young_method = FALSE,   k1_manual = 2.063,   k2_manual = 2.063,   tau = NULL )"},{"path":"https://zankrut20.github.io/selection.index/reference/mlpsi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multistage Linear Phenotypic Selection Index (MLPSI) ‚Äî mlpsi","text":"P1 Phenotypic variance-covariance matrix stage 1 traits (n1 x n1) P Phenotypic variance-covariance matrix traits stage 2 (n x n) G1 Genotypic variance-covariance matrix stage 1 traits (n1 x n1) C Genotypic variance-covariance matrix traits (n x n) wmat Economic weights vector matrix (n x k) wcol Weight column use wmat multiple columns (default: 1) stage1_indices Integer vector specifying traits (columns P C) correspond stage 1. Default 1:nrow(P1), assuming stage 1 traits first n1 traits. Use specify non-contiguous traits, e.g., c(1, 3, 5) traits 1, 3, 5. selection_proportion Proportion selected stage (default: 0.1) use_young_method Logical. Use Young's method selection intensities (default: FALSE). Young's method tends overestimate intensities; manual intensities recommended. k1_manual Manual selection intensity stage 1 (used use_young_method = FALSE) k2_manual Manual selection intensity stage 2 (used use_young_method = FALSE) tau Standardized truncation point (default: computed selection_proportion)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mlpsi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multistage Linear Phenotypic Selection Index (MLPSI) ‚Äî mlpsi","text":"List components: b1 - Stage 1 index coefficients b2 - Stage 2 index coefficients stage1_metrics - List stage 1 metrics (R1, E1, rho_H1) stage2_metrics - List stage 2 metrics (R2, E2, rho_H2) P_star - Adjusted phenotypic covariance matrix stage 2 C_star - Adjusted genotypic covariance matrix stage 2 rho_12 - Correlation stage 1 stage 2 indices k1 - Selection intensity stage 1 k2 - Selection intensity stage 2 summary_stage1 - Data frame stage 1 summary summary_stage2 - Data frame stage 2 summary","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mlpsi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Multistage Linear Phenotypic Selection Index (MLPSI) ‚Äî mlpsi","text":"Mathematical Formulation: Stage 1 index coefficients: $$\\mathbf{b}_1 = \\mathbf{P}_1^{-1}\\mathbf{G}_1\\mathbf{w}$$ Stage 2 index coefficients: $$\\mathbf{b}_2 = \\mathbf{P}^{-1}\\mathbf{G}\\mathbf{w}$$ Adjusted phenotypic covariance matrix (Cochran/Cunningham): $$\\mathbf{P}^* = \\mathbf{P} - u \\frac{Cov(\\mathbf{y},\\mathbf{x}_1)\\mathbf{b}_1\\mathbf{b}_1'Cov(\\mathbf{x}_1,\\mathbf{y})}{\\mathbf{b}_1'\\mathbf{P}_1\\mathbf{b}_1}$$ Adjusted genotypic covariance matrix: $$\\mathbf{C}^* = \\mathbf{C} - u \\frac{\\mathbf{G}_1'\\mathbf{b}_1\\mathbf{b}_1'\\mathbf{G}_1}{\\mathbf{b}_1'\\mathbf{P}_1\\mathbf{b}_1}$$ \\(u = k_1(k_1 - \\tau)\\) Selection response: \\(R_1 = k_1 \\sqrt{\\mathbf{b}_1'\\mathbf{P}_1\\mathbf{b}_1}\\), \\(R_2 = k_2 \\sqrt{\\mathbf{b}_2'\\mathbf{P}^*\\mathbf{b}_2}\\)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mlpsi.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Multistage Linear Phenotypic Selection Index (MLPSI) ‚Äî mlpsi","text":"Cochran, W. G. (1951). Improvement means selection. Proceedings Second Berkeley Symposium Mathematical Statistics Probability, 449-470. Cunningham, E. P. (1975). Multi-stage index selection. Theoretical Applied Genetics, 46(2), 55-61. Young, S. S. Y. (1964). Multi-stage selection genetic gain. Heredity, 19(1), 131-144.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mlpsi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Multistage Linear Phenotypic Selection Index (MLPSI) ‚Äî mlpsi","text":"","code":"if (FALSE) { # \\dontrun{ # Two-stage selection example # Stage 1: Select based on 3 traits # Stage 2: Select based on all 7 traits  # Compute variance-covariance matrices pmat <- phen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) gmat <- gen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1])  # Stage 1 uses first 3 traits P1 <- pmat[1:3, 1:3] G1 <- gmat[1:3, 1:3]  # Stage 2 uses all 7 traits P <- pmat C <- gmat  # Economic weights weights <- c(10, 8, 6, 4, 3, 2, 1)  # Run MLPSI (default: stage1_indices = 1:3) result <- mlpsi(   P1 = P1, P = P, G1 = G1, C = C, wmat = weights,   selection_proportion = 0.1 )  # Or with non-contiguous traits (e.g., traits 1, 3, 5 at stage 1): # P1 <- pmat[c(1,3,5), c(1,3,5)] # G1 <- gmat[c(1,3,5), c(1,3,5)] # result <- mlpsi(P1 = P1, P = P, G1 = G1, C = C, wmat = weights, #                 stage1_indices = c(1, 3, 5))  print(result$summary_stage1) print(result$summary_stage2) } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/mppg_lgsi.html","id":null,"dir":"Reference","previous_headings":"","what":"Multistage Predetermined Proportional Gain Linear Genomic Selection Index (MPPG-LGSI) ‚Äî mppg_lgsi","title":"Multistage Predetermined Proportional Gain Linear Genomic Selection Index (MPPG-LGSI) ‚Äî mppg_lgsi","text":"Implements two-stage Predetermined Proportional Gain LGSI breeders specify desired proportional gains traits stage using GEBVs.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mppg_lgsi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multistage Predetermined Proportional Gain Linear Genomic Selection Index (MPPG-LGSI) ‚Äî mppg_lgsi","text":"","code":"mppg_lgsi(   Gamma1,   Gamma,   A1,   A,   C,   G1,   P1,   wmat,   wcol = 1,   d1,   d2,   U1 = NULL,   U2 = NULL,   selection_proportion = 0.1,   use_young_method = FALSE,   k1_manual = 2.063,   k2_manual = 2.063,   tau = NULL )"},{"path":"https://zankrut20.github.io/selection.index/reference/mppg_lgsi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multistage Predetermined Proportional Gain Linear Genomic Selection Index (MPPG-LGSI) ‚Äî mppg_lgsi","text":"Gamma1 GEBV variance-covariance matrix stage 1 traits (n1 x n1) Gamma GEBV variance-covariance matrix traits stage 2 (n x n) A1 Covariance matrix GEBVs true breeding values stage 1 (n1 x n1) Covariance matrix GEBVs true breeding values stage 2 (n x n1) C Genotypic variance-covariance matrix traits (n x n) G1 Genotypic variance-covariance matrix stage 1 traits (n1 x n1) P1 Phenotypic variance-covariance matrix stage 1 traits (n1 x n1) wmat Economic weights vector matrix (n x k) wcol Weight column use wmat multiple columns (default: 1) d1 Vector desired proportional gains stage 1 (length n1) d2 Vector desired proportional gains stage 2 (length n) U1 Constraint matrix stage 1 (n1 x r1), optional U2 Constraint matrix stage 2 (n x r2), optional selection_proportion Proportion selected stage (default: 0.1) use_young_method Logical. Use Young's method selection intensities (default: FALSE). Young's method tends overestimate intensities; manual intensities recommended. k1_manual Manual selection intensity stage 1 k2_manual Manual selection intensity stage 2 tau Standardized truncation point","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mppg_lgsi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multistage Predetermined Proportional Gain Linear Genomic Selection Index (MPPG-LGSI) ‚Äî mppg_lgsi","text":"List components similar mlgsi, plus: beta_P1 - PPG genomic stage 1 coefficients beta_P2 - PPG genomic stage 2 coefficients b_P1 - PPG phenotypic stage 1 coefficients (used C* adjustment) theta1 - Proportionality constant stage 1 theta2 - Proportionality constant stage 2 gain_ratios_1 - Achieved gain ratios stage 1 gain_ratios_2 - Achieved gain ratios stage 2","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mppg_lgsi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Multistage Predetermined Proportional Gain Linear Genomic Selection Index (MPPG-LGSI) ‚Äî mppg_lgsi","text":"Mathematical Formulation: PPG genomic coefficients : $$\\mathbf{\\beta}_{P_1} = \\mathbf{\\beta}_{R_1} + \\theta_1 \\mathbf{U}_1(\\mathbf{U}_1'\\mathbf{\\Gamma}_1\\mathbf{U}_1)^{-1}\\mathbf{d}_1$$ $$\\mathbf{\\beta}_{P_2} = \\mathbf{\\beta}_{R_2} + \\theta_2 \\mathbf{U}_2(\\mathbf{U}_2'\\mathbf{\\Gamma}\\mathbf{U}_2)^{-1}\\mathbf{d}_2$$ proportionality constants : $$\\theta_1 = \\frac{\\mathbf{d}_1'(\\mathbf{U}_1'\\mathbf{\\Gamma}_1\\mathbf{U}_1)^{-1}\\mathbf{U}_1'\\mathbf{}_1\\mathbf{w}}{\\mathbf{d}_1'(\\mathbf{U}_1'\\mathbf{\\Gamma}_1\\mathbf{U}_1)^{-1}\\mathbf{d}_1}$$ Covariance Adjustment: genetic covariance matrix \\(\\mathbf{C}^*\\) adjusted using phenotypic PPG coefficients \\(\\mathbf{b}_{P1} = \\mathbf{P}_1^{-1}\\mathbf{G}_1\\mathbf{P}_1^{-1}\\mathbf{d}_1\\), reflect proportional gain constraints genomic coefficients \\(\\mathbf{\\beta}_{P1}\\). ensures adjustment reflects actual PPG selection occurring stage 1. Important: using custom U1 matrices (subset constraints), phenotypic proxy \\(\\mathbf{b}_{P1}\\) uses standard Tallis formula (traits constrained), genomic index \\(\\mathbf{\\beta}_{P1}\\) respects U1 subset. may cause \\(\\mathbf{C}^*\\) slightly -adjusted. exact adjustment, use U1 = NULL (default, traits constrained). Calculating exact restricted phenotypic proxy require implementing full MPPG-LPSI projection matrix method phenotypic coefficients. Note: Input covariance matrices (C, P1, Gamma1, Gamma) positive definite. Non-positive definite matrices may lead invalid results warnings.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mppg_lgsi.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Multistage Predetermined Proportional Gain Linear Genomic Selection Index (MPPG-LGSI) ‚Äî mppg_lgsi","text":"Ceron-Rojas, J. J., & Crossa, J. (2018). Linear Selection Indices Modern Plant Breeding. Springer International Publishing. Chapter 9, Section 9.6.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mppg_lgsi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Multistage Predetermined Proportional Gain Linear Genomic Selection Index (MPPG-LGSI) ‚Äî mppg_lgsi","text":"","code":"if (FALSE) { # \\dontrun{ # Two-stage proportional gain genomic selection gmat <- gen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) pmat <- phen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1])  reliability <- 0.7 Gamma1 <- reliability * gmat[1:3, 1:3] Gamma <- reliability * gmat A1 <- reliability * gmat[1:3, 1:3] A <- gmat[, 1:3]  # Desired proportional gains d1 <- c(2, 1, 1) d2 <- c(3, 2, 1, 1, 1, 0.5, 0.5)  weights <- c(10, 8, 6, 4, 3, 2, 1)  result <- mppg_lgsi(   Gamma1 = Gamma1, Gamma = Gamma, A1 = A1, A = A,   C = gmat, G1 = gmat[1:3, 1:3], P1 = pmat[1:3, 1:3],   wmat = weights, d1 = d1, d2 = d2 ) } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/mppg_lpsi.html","id":null,"dir":"Reference","previous_headings":"","what":"Multistage Predetermined Proportional Gain Linear Phenotypic Selection Index (MPPG-LPSI) ‚Äî mppg_lpsi","title":"Multistage Predetermined Proportional Gain Linear Phenotypic Selection Index (MPPG-LPSI) ‚Äî mppg_lpsi","text":"Implements two-stage Predetermined Proportional Gain LPSI breeders specify desired proportional gains traits stage.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mppg_lpsi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multistage Predetermined Proportional Gain Linear Phenotypic Selection Index (MPPG-LPSI) ‚Äî mppg_lpsi","text":"","code":"mppg_lpsi(   P1,   P,   G1,   C,   wmat,   wcol = 1,   d1,   d2,   stage1_indices = NULL,   selection_proportion = 0.1,   use_young_method = FALSE,   k1_manual = 2.063,   k2_manual = 2.063,   tau = NULL )"},{"path":"https://zankrut20.github.io/selection.index/reference/mppg_lpsi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multistage Predetermined Proportional Gain Linear Phenotypic Selection Index (MPPG-LPSI) ‚Äî mppg_lpsi","text":"P1 Phenotypic variance-covariance matrix stage 1 traits (n1 x n1) P Phenotypic variance-covariance matrix traits stage 2 (n x n) G1 Genotypic variance-covariance matrix stage 1 traits (n1 x n1) C Genotypic variance-covariance matrix traits (n x n) wmat Economic weights vector matrix (n x k) wcol Weight column use wmat multiple columns (default: 1) d1 Vector desired proportional gains stage 1 (length n1) d2 Vector desired proportional gains stage 2 (length n) stage1_indices Integer vector specifying traits correspond stage 1 (default: 1:nrow(P1)) selection_proportion Proportion selected stage (default: 0.1) use_young_method Logical. Use Young's method selection intensities (default: FALSE). Young's method tends overestimate intensities; manual intensities recommended. k1_manual Manual selection intensity stage 1 k2_manual Manual selection intensity stage 2 tau Standardized truncation point","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mppg_lpsi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multistage Predetermined Proportional Gain Linear Phenotypic Selection Index (MPPG-LPSI) ‚Äî mppg_lpsi","text":"List components similar mlpsi, plus: b_M1 - PPG stage 1 coefficients b_M2 - PPG stage 2 coefficients b_R1 - Restricted stage 1 coefficients b_R2 - Restricted stage 2 coefficients K_M1 - PPG projection matrix stage 1 K_M2 - PPG projection matrix stage 2 theta1 - Proportionality constant stage 1 theta2 - Proportionality constant stage 2 gain_ratios_1 - Achieved gain ratios stage 1 gain_ratios_2 - Achieved gain ratios stage 2","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mppg_lpsi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Multistage Predetermined Proportional Gain Linear Phenotypic Selection Index (MPPG-LPSI) ‚Äî mppg_lpsi","text":"Mathematical Formulation (Chapter 9.3.1, Eq 9.17): PPG coefficients computed using projection matrix method: $$\\mathbf{b}_{M_1} = \\mathbf{b}_{R_1} + \\theta_1 \\mathbf{U}_1(\\mathbf{U}_1'\\mathbf{G}_1\\mathbf{P}_1^{-1}\\mathbf{G}_1\\mathbf{U}_1)^{-1}\\mathbf{d}_1$$ $$\\mathbf{b}_{M_2} = \\mathbf{b}_{R_2} + \\theta_2 \\mathbf{U}_2(\\mathbf{U}_2'\\mathbf{C}\\mathbf{P}^{-1}\\mathbf{C}\\mathbf{U}_2)^{-1}\\mathbf{d}_2$$ : \\(\\mathbf{b}_{R_i} = \\mathbf{K}_{M_i}\\mathbf{b}_i\\) restricted coefficients \\(\\mathbf{K}_{M_i} = \\mathbf{} - \\mathbf{Q}_{M_i}\\) projection matrix \\(\\theta_i\\) proportionality constant computed \\(\\mathbf{d}_i\\) \\(\\mathbf{U}_i = \\mathbf{}\\) (traits constrained) $$\\mathbf{b}_{M_1} = \\mathbf{K}_{M_1} \\mathbf{b}_1$$ $$\\mathbf{b}_{M_2} = \\mathbf{K}_{M_2} \\mathbf{b}_2$$ \\(\\mathbf{K}_{M_i}\\) computed achieve proportional gains specified \\(\\mathbf{d}_i\\)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mppg_lpsi.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Multistage Predetermined Proportional Gain Linear Phenotypic Selection Index (MPPG-LPSI) ‚Äî mppg_lpsi","text":"Tallis, G. M. (1962). selection index optimum genotype. Biometrics, 18(1), 120-122.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mppg_lpsi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Multistage Predetermined Proportional Gain Linear Phenotypic Selection Index (MPPG-LPSI) ‚Äî mppg_lpsi","text":"","code":"if (FALSE) { # \\dontrun{ # Two-stage proportional gain selection pmat <- phen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) gmat <- gen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1])  P1 <- pmat[1:3, 1:3] G1 <- gmat[1:3, 1:3] P <- pmat C <- gmat  # Desired proportional gains d1 <- c(2, 1, 1) # Trait 1 gains twice as much at stage 1 d2 <- c(3, 2, 1, 1, 1, 0.5, 0.5) # Different proportions at stage 2  weights <- c(10, 8, 6, 4, 3, 2, 1)  result <- mppg_lpsi(   P1 = P1, P = P, G1 = G1, C = C, wmat = weights,   d1 = d1, d2 = d2 ) } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/mrlgsi.html","id":null,"dir":"Reference","previous_headings":"","what":"Multistage Restricted Linear Genomic Selection Index (MRLGSI) ‚Äî mrlgsi","title":"Multistage Restricted Linear Genomic Selection Index (MRLGSI) ‚Äî mrlgsi","text":"Implements two-stage Restricted Linear Genomic Selection Index certain traits constrained zero genetic gain stage using GEBVs.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mrlgsi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multistage Restricted Linear Genomic Selection Index (MRLGSI) ‚Äî mrlgsi","text":"","code":"mrlgsi(   Gamma1,   Gamma,   A1,   A,   C,   G1,   P1,   wmat,   wcol = 1,   C1,   C2,   selection_proportion = 0.1,   use_young_method = FALSE,   k1_manual = 2.063,   k2_manual = 2.063,   tau = NULL )"},{"path":"https://zankrut20.github.io/selection.index/reference/mrlgsi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multistage Restricted Linear Genomic Selection Index (MRLGSI) ‚Äî mrlgsi","text":"Gamma1 GEBV variance-covariance matrix stage 1 traits (n1 x n1) Gamma GEBV variance-covariance matrix traits stage 2 (n x n) A1 Covariance matrix GEBVs true breeding values stage 1 (n1 x n1) Covariance matrix GEBVs true breeding values stage 2 (n x n1) C Genotypic variance-covariance matrix traits (n x n) G1 Genotypic variance-covariance matrix stage 1 traits (n1 x n1) P1 Phenotypic variance-covariance matrix stage 1 traits (n1 x n1) wmat Economic weights vector matrix (n x k) wcol Weight column use wmat multiple columns (default: 1) C1 Constraint matrix stage 1 (n1 x r1) C2 Constraint matrix stage 2 (n x r2) selection_proportion Proportion selected stage (default: 0.1) use_young_method Logical. Use Young's method selection intensities (default: FALSE). Young's method tends overestimate intensities; manual intensities recommended. k1_manual Manual selection intensity stage 1 k2_manual Manual selection intensity stage 2 tau Standardized truncation point","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mrlgsi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multistage Restricted Linear Genomic Selection Index (MRLGSI) ‚Äî mrlgsi","text":"List components similar mlgsi, plus: beta_R1 - Restricted stage 1 coefficients beta_R2 - Restricted stage 2 coefficients K_G1 - Restriction matrix stage 1 K_G2 - Restriction matrix stage 2","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mrlgsi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Multistage Restricted Linear Genomic Selection Index (MRLGSI) ‚Äî mrlgsi","text":"Mathematical Formulation: restricted genomic coefficients : $$\\mathbf{\\beta}_{R_1} = \\mathbf{K}_{G_1}\\mathbf{\\beta}_1$$ $$\\mathbf{\\beta}_{R_2} = \\mathbf{K}_{G_2}\\mathbf{w}$$ restriction matrices computed similarly RLGSI","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mrlgsi.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Multistage Restricted Linear Genomic Selection Index (MRLGSI) ‚Äî mrlgsi","text":"Ceron-Rojas, J. J., & Crossa, J. (2018). Linear Selection Indices Modern Plant Breeding. Springer International Publishing. Chapter 9, Section 9.5.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mrlgsi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Multistage Restricted Linear Genomic Selection Index (MRLGSI) ‚Äî mrlgsi","text":"","code":"if (FALSE) { # \\dontrun{ # Two-stage restricted genomic selection gmat <- gen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) pmat <- phen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1])  reliability <- 0.7 Gamma1 <- reliability * gmat[1:3, 1:3] Gamma <- reliability * gmat A1 <- reliability * gmat[1:3, 1:3] A <- gmat[, 1:3]  # Constraint matrices C1 <- matrix(0, nrow = 3, ncol = 1) C1[1, 1] <- 1 # Restrict trait 1 at stage 1  C2 <- matrix(0, nrow = 7, ncol = 2) C2[1, 1] <- 1 # Restrict trait 1 at stage 2 C2[3, 2] <- 1 # Restrict trait 3 at stage 2  weights <- c(10, 8, 6, 4, 3, 2, 1)  result <- mrlgsi(   Gamma1 = Gamma1, Gamma = Gamma, A1 = A1, A = A,   C = gmat, G1 = gmat[1:3, 1:3], P1 = pmat[1:3, 1:3],   wmat = weights, C1 = C1, C2 = C2 ) } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/mrlpsi.html","id":null,"dir":"Reference","previous_headings":"","what":"Multistage Restricted Linear Phenotypic Selection Index (MRLPSI) ‚Äî mrlpsi","title":"Multistage Restricted Linear Phenotypic Selection Index (MRLPSI) ‚Äî mrlpsi","text":"Implements two-stage Restricted Linear Phenotypic Selection Index certain traits constrained zero genetic gain stage.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mrlpsi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multistage Restricted Linear Phenotypic Selection Index (MRLPSI) ‚Äî mrlpsi","text":"","code":"mrlpsi(   P1,   P,   G1,   C,   wmat,   wcol = 1,   C1,   C2,   stage1_indices = NULL,   selection_proportion = 0.1,   use_young_method = FALSE,   k1_manual = 2.063,   k2_manual = 2.063,   tau = NULL )"},{"path":"https://zankrut20.github.io/selection.index/reference/mrlpsi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multistage Restricted Linear Phenotypic Selection Index (MRLPSI) ‚Äî mrlpsi","text":"P1 Phenotypic variance-covariance matrix stage 1 traits (n1 x n1) P Phenotypic variance-covariance matrix traits stage 2 (n x n) G1 Genotypic variance-covariance matrix stage 1 traits (n1 x n1) C Genotypic variance-covariance matrix traits (n x n) wmat Economic weights vector matrix (n x k) wcol Weight column use wmat multiple columns (default: 1) C1 Constraint matrix stage 1 (n1 x r1) C2 Constraint matrix stage 2 (n x r2) stage1_indices Integer vector specifying traits correspond stage 1 (default: 1:nrow(P1)) selection_proportion Proportion selected stage (default: 0.1) use_young_method Logical. Use Young's method selection intensities (default: FALSE). Young's method tends overestimate intensities; manual intensities recommended. k1_manual Manual selection intensity stage 1 k2_manual Manual selection intensity stage 2 tau Standardized truncation point","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mrlpsi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multistage Restricted Linear Phenotypic Selection Index (MRLPSI) ‚Äî mrlpsi","text":"List components similar mlpsi, plus: b_R1 - Restricted stage 1 coefficients b_R2 - Restricted stage 2 coefficients K1 - Restriction matrix stage 1 K2 - Restriction matrix stage 2","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mrlpsi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Multistage Restricted Linear Phenotypic Selection Index (MRLPSI) ‚Äî mrlpsi","text":"Mathematical Formulation: restricted coefficients computed : $$\\mathbf{b}_{R_1} = \\mathbf{K}_1 \\mathbf{b}_1$$ $$\\mathbf{b}_{R_2} = \\mathbf{K}_2 \\mathbf{b}_2$$ \\(\\mathbf{K}_1 = \\mathbf{}_1 - \\mathbf{Q}_1\\) \\(\\mathbf{K}_2 = \\mathbf{}_2 - \\mathbf{Q}_2\\) \\(\\mathbf{Q}_i = \\mathbf{P}_i^{-1}\\mathbf{G}_i\\mathbf{C}_i(\\mathbf{C}_i'\\mathbf{G}_i\\mathbf{P}_i^{-1}\\mathbf{G}_i\\mathbf{C}_i)^{-1}\\mathbf{C}_i'\\mathbf{G}_i\\)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mrlpsi.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Multistage Restricted Linear Phenotypic Selection Index (MRLPSI) ‚Äî mrlpsi","text":"Kempthorne, O., & Nordskog, . W. (1959). Restricted selection indices. Biometrics, 15(1), 10-19.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/mrlpsi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Multistage Restricted Linear Phenotypic Selection Index (MRLPSI) ‚Äî mrlpsi","text":"","code":"if (FALSE) { # \\dontrun{ # Two-stage restricted selection # Restrict trait 1 at stage 1, traits 1 and 3 at stage 2  pmat <- phen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) gmat <- gen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1])  P1 <- pmat[1:3, 1:3] G1 <- gmat[1:3, 1:3] P <- pmat C <- gmat  # Constraint matrices C1 <- matrix(0, nrow = 3, ncol = 1) C1[1, 1] <- 1 # Restrict trait 1 at stage 1  C2 <- matrix(0, nrow = 7, ncol = 2) C2[1, 1] <- 1 # Restrict trait 1 at stage 2 C2[3, 2] <- 1 # Restrict trait 3 at stage 2  weights <- c(10, 8, 6, 4, 3, 2, 1)  result <- mrlpsi(   P1 = P1, P = P, G1 = G1, C = C, wmat = weights,   C1 = C1, C2 = C2 ) } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/multistage_genomic_indices.html","id":null,"dir":"Reference","previous_headings":"","what":"Multistage Linear Genomic Selection Indices (Chapter 9) ‚Äî multistage_genomic_indices","title":"Multistage Linear Genomic Selection Indices (Chapter 9) ‚Äî multistage_genomic_indices","text":"Implements multistage genomic selection index methods Chapter 9. methods combine genomic estimated breeding values (GEBVs) across multiple stages covariance adjustments due selection effects using Cochran/Cunningham's method. Methods included: - MLGSI: Multistage Linear Genomic Selection Index (Section 9.4) - MRLGSI: Multistage Restricted Linear Genomic Selection Index (Section 9.5) - MPPG-LGSI: Multistage Predetermined Proportional Gain LGSI (Section 9.6) implementations use C++ primitives mathematical operations.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/multistage_genomic_indices.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Multistage Linear Genomic Selection Indices (Chapter 9) ‚Äî multistage_genomic_indices","text":"Cochran, W. G. (1951). Improvement means selection. Proceedings Second Berkeley Symposium Mathematical Statistics Probability, 449-470. Young, S. S. Y. (1964). Multi-stage selection genetic gain. Heredity, 19(1), 131-144. Ceron-Rojas, J. J., & Crossa, J. (2018). Linear Selection Indices Modern Plant Breeding. Springer International Publishing. Chapter 9.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/multistage_phenotypic_indices.html","id":null,"dir":"Reference","previous_headings":"","what":"Multistage Linear Phenotypic Selection Indices (Chapter 9) ‚Äî multistage_phenotypic_indices","title":"Multistage Linear Phenotypic Selection Indices (Chapter 9) ‚Äî multistage_phenotypic_indices","text":"Implements multistage phenotypic selection index methods Chapter 9. methods involve selection across multiple stages covariance adjustments due selection effects using Cochran/Cunningham's method. Methods included: - MLPSI: Multistage Linear Phenotypic Selection Index (Section 9.1) - MRLPSI: Multistage Restricted Linear Phenotypic Selection Index (Section 9.2) - MPPG-LPSI: Multistage Predetermined Proportional Gain LPSI (Section 9.3) implementations use C++ primitives mathematical operations.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/multistage_phenotypic_indices.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Multistage Linear Phenotypic Selection Indices (Chapter 9) ‚Äî multistage_phenotypic_indices","text":"Cochran, W. G. (1951). Improvement means selection. Proceedings Second Berkeley Symposium Mathematical Statistics Probability, 449-470. Young, S. S. Y. (1964). Multi-stage selection genetic gain. Heredity, 19(1), 131-144. Ceron-Rojas, J. J., & Crossa, J. (2018). Linear Selection Indices Modern Plant Breeding. Springer International Publishing. Chapter 9.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/phen_varcov.html","id":null,"dir":"Reference","previous_headings":"","what":"Phenotypic Variance-Covariance Analysis ‚Äî phen_varcov","title":"Phenotypic Variance-Covariance Analysis ‚Äî phen_varcov","text":"Phenotypic Variance-Covariance Analysis","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/phen_varcov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Phenotypic Variance-Covariance Analysis ‚Äî phen_varcov","text":"","code":"phen_varcov(   data,   genotypes,   replication,   columns = NULL,   main_plots = NULL,   design_type = c(\"RCBD\", \"LSD\", \"SPD\"),   method = c(\"REML\", \"Yates\", \"Healy\", \"Regression\", \"Mean\", \"Bartlett\") )"},{"path":"https://zankrut20.github.io/selection.index/reference/phen_varcov.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Phenotypic Variance-Covariance Analysis ‚Äî phen_varcov","text":"data traits analyzed genotypes vector containing genotypes/treatments (sub-plot treatments SPD) replication vector containing replication/blocks (RCBD) rows (LSD) columns vector containing columns (required Latin Square Design ) main_plots vector containing main plot treatments (required Split Plot Design ) design_type experimental design type: \"RCBD\" (default), \"LSD\" (Latin Square), \"SPD\" (Split Plot) method Method missing value imputation: \"REML\" (default), \"Yates\", \"Healy\", \"Regression\", \"Mean\", \"Bartlett\"","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/phen_varcov.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Phenotypic Variance-Covariance Analysis ‚Äî phen_varcov","text":"Phenotypic Variance-Covariance Matrix","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/phen_varcov.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Phenotypic Variance-Covariance Analysis ‚Äî phen_varcov","text":"","code":"# RCBD example phen_varcov(data = seldata[, 3:9], genotypes = seldata$treat, replication = seldata$rep) #>           sypp         dtf          rpp         ppr        ppp          spp #> sypp 4.6596932  0.81327830  0.549544688  0.76208582  2.5500613  0.401129893 #> dtf  0.8132783  6.95753031  0.478114232 -1.05398088 -0.9364611  0.292048297 #> rpp  0.5495447  0.47811423  0.492447900 -0.10364377  1.1038273 -0.007695489 #> ppr  0.7620858 -1.05398088 -0.103643767  0.95426114  0.9969895 -0.062186773 #> ppp  2.5500613 -0.93646109  1.103827327  0.99698955  6.1852816 -0.075103699 #> spp  0.4011299  0.29204830 -0.007695489 -0.06218677 -0.0751037  0.118394770 #> pw   0.2727074  0.04678408 -0.025308347  0.02107724 -0.1410159  0.043030640 #>               pw #> sypp  0.27270744 #> dtf   0.04678408 #> rpp  -0.02530835 #> ppr   0.02107724 #> ppp  -0.14101586 #> spp   0.04303064 #> pw    0.04321272  # Latin Square Design example (requires columns parameter) # phen_varcov(data=lsd_data[,3:7], genotypes=lsd_data$treat, #            replication=lsd_data$row, columns=lsd_data$col, design_type=\"LSD\")  # Split Plot Design example (requires main_plots parameter) # phen_varcov(data=spd_data[,3:7], genotypes=spd_data$subplot, #            replication=spd_data$block, main_plots=spd_data$mainplot, design_type=\"SPD\")"},{"path":"https://zankrut20.github.io/selection.index/reference/phenomic_genomic_varcov.html","id":null,"dir":"Reference","previous_headings":"","what":"Phenomic-Genomic Variance-Covariance Matrix (\\(\\Phi\\)) ‚Äî phenomic_genomic_varcov","title":"Phenomic-Genomic Variance-Covariance Matrix (\\(\\Phi\\)) ‚Äî phenomic_genomic_varcov","text":"Computes combined phenomic-genomic variance-covariance matrix (\\(\\Phi\\) P_L), block matrix representing joint distribution phenotypes GEBVs. Structure: \\(\\Phi\\) = [[P, P_y\\(\\gamma\\)], [P_y\\(\\gamma\\)', \\(\\Gamma\\)]] : - P = Var(y) = phenotypic variance-covariance - \\(\\Gamma\\) = Var(\\(\\gamma\\)) = genomic variance-covariance - P_y\\(\\gamma\\) = Cov(y, \\(\\gamma\\)) = covariance phenotypes GEBVs","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/phenomic_genomic_varcov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Phenomic-Genomic Variance-Covariance Matrix (\\(\\Phi\\)) ‚Äî phenomic_genomic_varcov","text":"","code":"phenomic_genomic_varcov(   phen_mat = NULL,   gebv_mat = NULL,   P = NULL,   Gamma = NULL,   P_yg = NULL,   method = \"pearson\",   use = \"complete.obs\" )"},{"path":"https://zankrut20.github.io/selection.index/reference/phenomic_genomic_varcov.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Phenomic-Genomic Variance-Covariance Matrix (\\(\\Phi\\)) ‚Äî phenomic_genomic_varcov","text":"phen_mat Matrix phenotypes (n_genotypes x n_traits). Optional P P_yg provided. gebv_mat Matrix GEBVs (n_genotypes x n_traits). Optional Gamma P_yg provided. P Phenotypic variance-covariance matrix (n_traits x n_traits). Optional phen_mat provided. Gamma Genomic variance-covariance matrix (n_traits x n_traits). Optional gebv_mat provided. P_yg Covariance phenotypes GEBVs (n_traits x n_traits). Optional phen_mat gebv_mat provided. method Character string specifying correlation method: \"pearson\" (default), \"kendall\", \"spearman\" use Character string specifying handle missing values: \"complete.obs\" (default), \"pairwise.complete.obs\", etc.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/phenomic_genomic_varcov.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Phenomic-Genomic Variance-Covariance Matrix (\\(\\Phi\\)) ‚Äî phenomic_genomic_varcov","text":"Symmetric block matrix \\(\\Phi\\) (2*n_traits x 2*n_traits)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/phenomic_genomic_varcov.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Phenomic-Genomic Variance-Covariance Matrix (\\(\\Phi\\)) ‚Äî phenomic_genomic_varcov","text":"phenomic-genomic covariance matrix used : - GESIM (Genomic Eigen Selection Index Method) - Combined phenotypic + genomic selection indices matrix constructed : $$\\Phi = \\begin{bmatrix} P & P_{y\\gamma} \\\\ P_{y\\gamma}' & \\Gamma \\end{bmatrix}$$ -diagonal blocks transposes, ensuring symmetry. can provide either: 1. Raw data: phen_mat + gebv_mat (matrices computed internally) 2. Pre-computed matrices: P + Gamma + P_yg","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/phenomic_genomic_varcov.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Phenomic-Genomic Variance-Covariance Matrix (\\(\\Phi\\)) ‚Äî phenomic_genomic_varcov","text":"Cer√≥n-Rojas, J. J., & Crossa, J. (2018). Linear Selection Indices Modern Plant Breeding. Springer International Publishing. Chapter 8.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/phenomic_genomic_varcov.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Phenomic-Genomic Variance-Covariance Matrix (\\(\\Phi\\)) ‚Äî phenomic_genomic_varcov","text":"","code":"if (FALSE) { # \\dontrun{ # Simulate data set.seed(123) n_genotypes <- 100 n_traits <- 7 phen_mat <- matrix(rnorm(n_genotypes * n_traits, mean = 15, sd = 3),   nrow = n_genotypes, ncol = n_traits ) gebv_mat <- matrix(rnorm(n_genotypes * n_traits, mean = 10, sd = 2),   nrow = n_genotypes, ncol = n_traits )  # Compute phenomic-genomic covariance Phi <- phenomic_genomic_varcov(phen_mat, gebv_mat) print(dim(Phi)) # Should be 14 x 14 (2 * 7 traits) } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/phenotypic_indices.html","id":null,"dir":"Reference","previous_headings":"","what":"Phenotypic Selection Indices (Chapter 2) ‚Äî phenotypic_indices","title":"Phenotypic Selection Indices (Chapter 2) ‚Äî phenotypic_indices","text":"Implements phenotypic selection index methods Chapter 2: Linear Phenotypic Selection Index. Methods included: - Smith-Hazel Index (LPSI) - optimal unrestricted phenotypic index - Base Index - Simple index using economic weights directly - Combinatorial Index Builder - Builds indices trait combinations implementations use C++ primitives mathematical operations.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/phenotypic_indices.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Phenotypic Selection Indices (Chapter 2) ‚Äî phenotypic_indices","text":"Smith, H. F. (1936). discriminant function plant selection. Annals Eugenics, 7(3), 240-250. Hazel, L. N. (1943). genetic basis constructing selection indexes. Genetics, 28(6), 476. Williams, J. S. (1962). evaluation selection index. Biometrics, 18(3), 375-393. Cer√≥n-Rojas, J. J., & Crossa, J. (2018). Linear Selection Indices Modern Plant Breeding. Springer International Publishing. Chapter 2.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/plot.selection_simulation.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Method for Selection Simulation Results ‚Äî plot.selection_simulation","title":"Plot Method for Selection Simulation Results ‚Äî plot.selection_simulation","text":"Plot Method Selection Simulation Results","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/plot.selection_simulation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Method for Selection Simulation Results ‚Äî plot.selection_simulation","text":"","code":"# S3 method for class 'selection_simulation' plot(x, trait_index = 1, type = c(\"mean\", \"gain\"), ...)"},{"path":"https://zankrut20.github.io/selection.index/reference/plot.selection_simulation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Method for Selection Simulation Results ‚Äî plot.selection_simulation","text":"x Object class selection_simulation trait_index trait plot (default: 1) type Type plot: \"mean\" mean genetic value, \"gain\" genetic gain per cycle ... Additional arguments passed plot","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/ppg_esim.html","id":null,"dir":"Reference","previous_headings":"","what":"Predetermined Proportional Gain Eigen Selection Index (PPG-ESIM) ‚Äî ppg_esim","title":"Predetermined Proportional Gain Eigen Selection Index (PPG-ESIM) ‚Äî ppg_esim","text":"Extends ESIM enforcing genetic gains proportional user-specified vector \\(\\mathbf{d}\\): \\(\\Delta\\mathbf{G} \\propto \\mathbf{d}\\). similarity transformation \\(\\boldsymbol{\\beta}_P = \\mathbf{F}\\mathbf{b}_P\\) aligns eigenvector breeder's desired direction.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/ppg_esim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predetermined Proportional Gain Eigen Selection Index (PPG-ESIM) ‚Äî ppg_esim","text":"","code":"ppg_esim(pmat, gmat, d, selection_intensity = 2.063)"},{"path":"https://zankrut20.github.io/selection.index/reference/ppg_esim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predetermined Proportional Gain Eigen Selection Index (PPG-ESIM) ‚Äî ppg_esim","text":"pmat Phenotypic variance-covariance matrix (n_traits x n_traits). gmat Genotypic variance-covariance matrix (n_traits x n_traits). d Numeric vector desired proportional gains (length n_traits). ratios among elements define target gain proportions. Direction (positive/negative) must reflect desired improvement direction (positive = increase, negative = decrease). selection_intensity Selection intensity constant (default: 2.063).","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/ppg_esim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predetermined Proportional Gain Eigen Selection Index (PPG-ESIM) ‚Äî ppg_esim","text":"Object class \"ppg_esim\", list : summary Data frame beta (transformed b), b (raw), hI2,     rHI, sigma_I, Delta_G, lambda2. beta Named numeric vector post-transformation PPG-ESIM     coefficients \\(\\boldsymbol{\\beta}_P = \\mathbf{F}\\mathbf{b}_P\\). b Raw eigenvector b_P similarity transform. Delta_G Named vector expected genetic gains per trait. sigma_I Index standard deviation. hI2 Index heritability. rHI Index accuracy. lambda2 Leading eigenvalue PPG restricted eigenproblem. F_mat Diagonal similarity transform matrix F (diag(sign(d))). K_P PPG projection matrix (rank 1: projects onto d subspace). D_M Mallard matrix (t x t-1): orthogonal complement d,     used construct (t-1) restrictions. desired_gains Input proportional gains vector d. selection_intensity Selection intensity used.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/ppg_esim.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predetermined Proportional Gain Eigen Selection Index (PPG-ESIM) ‚Äî ppg_esim","text":"Restriction structure via Mallard Matrix (Section 7.3): PPG-ESIM restricts \\((t-1)\\) directions **orthogonal** \\(\\mathbf{d}\\), forcing genetic gain vector collinear \\(\\mathbf{d}\\). Mallard matrix \\(\\mathbf{D}_M\\) \\(t \\times (t-1)\\): columns span orthogonal complement \\(\\mathbf{d}\\), obtained via QR decomposition \\(\\mathbf{d}/\\|\\mathbf{d}\\|\\): $$\\mathbf{Q}_{QR} = [\\hat{d} \\mid \\mathbf{D}_M], \\quad       \\text{QR}(\\hat{d}) \\\\mathbf{Q}_{QR} \\\\mathbb{R}^{t \\times t}$$ \\(\\boldsymbol{\\Psi} = \\mathbf{C}\\) (full-trait case, \\(\\mathbf{U} = \\mathbf{}_t\\)): PPG projection matrix (\\(t-1\\) restrictions): $$\\mathbf{Q}_P =   \\mathbf{P}^{-1}\\boldsymbol{\\Psi}\\mathbf{D}_M   (\\mathbf{D}_M^{\\prime}\\boldsymbol{\\Psi}^{\\prime}\\mathbf{P}^{-1}\\boldsymbol{\\Psi}\\mathbf{D}_M)^{-1}   \\mathbf{D}_M^{\\prime}\\boldsymbol{\\Psi}^{\\prime}$$ $$\\mathbf{K}_P = \\mathbf{}_t - \\mathbf{Q}_P \\quad (\\text{rank 1})$$ \\(\\mathbf{K}_P\\) rank 1 (projects onto \\(\\mathbf{d}\\) subspace), \\(\\mathbf{K}_P\\mathbf{P}^{-1}\\mathbf{C}\\) exactly one positive eigenvalue eigenvector produces \\(\\Delta\\mathbf{G} \\propto \\mathbf{d}\\). PPG eigenproblem (rank-1 system): $$(\\mathbf{K}_P\\mathbf{P}^{-1}\\mathbf{C} - \\lambda_P^2\\mathbf{}_t)\\mathbf{b}_P = 0$$ Similarity transform: $$\\boldsymbol{\\beta}_P = \\mathbf{F}\\mathbf{b}_P$$ \\(\\mathbf{F} = \\text{diag}(\\text{sign}(\\mathbf{d}))\\) aligns eigenvector sign breeder's intended improvement direction. Key response metrics: $$R_P = k_I\\sqrt{\\boldsymbol{\\beta}_P^{\\prime}\\mathbf{P}\\boldsymbol{\\beta}_P}$$ $$\\mathbf{E}_P = k_I\\frac{\\mathbf{C}\\boldsymbol{\\beta}_P}{\\sqrt{\\boldsymbol{\\beta}_P^{\\prime}\\mathbf{P}\\boldsymbol{\\beta}_P}}$$","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/ppg_esim.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Predetermined Proportional Gain Eigen Selection Index (PPG-ESIM) ‚Äî ppg_esim","text":"Ceron-Rojas, J. J., & Crossa, J. (2018). Linear Selection Indices Modern Plant Breeding. Springer International Publishing. Section 7.3.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/ppg_esim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Predetermined Proportional Gain Eigen Selection Index (PPG-ESIM) ‚Äî ppg_esim","text":"","code":"if (FALSE) { # \\dontrun{ gmat <- gen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) pmat <- phen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1])  # Desired proportional gains: increase all traits proportionally d <- c(2, 1, 1, 1, 1, 1, 1) result <- ppg_esim(pmat, gmat, d) print(result) summary(result) } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/ppg_gesim.html","id":null,"dir":"Reference","previous_headings":"","what":"Predetermined Proportional Gain Genomic Eigen Selection Index (PPG-GESIM) ‚Äî ppg_gesim","title":"Predetermined Proportional Gain Genomic Eigen Selection Index (PPG-GESIM) ‚Äî ppg_gesim","text":"Implements PPG-GESIM extends GESIM enforce genetic gains proportional user-specified vector d. Combines eigen approach predetermined gain proportions.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/ppg_gesim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predetermined Proportional Gain Genomic Eigen Selection Index (PPG-GESIM) ‚Äî ppg_gesim","text":"","code":"ppg_gesim(pmat, gmat, Gamma, d, selection_intensity = 2.063)"},{"path":"https://zankrut20.github.io/selection.index/reference/ppg_gesim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predetermined Proportional Gain Genomic Eigen Selection Index (PPG-GESIM) ‚Äî ppg_gesim","text":"pmat Phenotypic variance-covariance matrix (n_traits x n_traits). gmat Genotypic variance-covariance matrix (n_traits x n_traits). Gamma Covariance phenotypes GEBVs (n_traits x n_traits). d Numeric vector desired proportional gains (length n_traits). ratios among elements define target gain proportions. selection_intensity Selection intensity constant \\(k_I\\) (default: 2.063 10% selection).","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/ppg_gesim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predetermined Proportional Gain Genomic Eigen Selection Index (PPG-GESIM) ‚Äî ppg_gesim","text":"Object class \"ppg_gesim\", list : summary Data frame coefficients metrics. b_y Coefficients phenotypic data. b_gamma Coefficients GEBVs. b_combined Combined coefficient vector. E_PG Expected genetic gains per trait. gain_ratios Ratios actual desired gains (constant). d Original desired proportional gains (length t). d_PG Extended proportional gains (length 2t, includes GEBV targets). sigma_I Standard deviation index. hI2 Index heritability. rHI Accuracy. R_PG Selection response. lambda2 Leading eigenvalue. implied_w Implied economic weights. U_PG Restriction matrix ((2t-1) x 2t). selection_intensity Selection intensity used.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/ppg_gesim.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predetermined Proportional Gain Genomic Eigen Selection Index (PPG-GESIM) ‚Äî ppg_gesim","text":"Eigenproblem (Section 8.5): $$(\\mathbf{T}_{PG} - \\lambda_{PG}^2 \\mathbf{}_{2t})\\boldsymbol{\\beta}_{PG} = 0$$ : $$\\mathbf{T}_{PG} = \\mathbf{K}_{RG}\\mathbf{\\Phi}^{-1}\\mathbf{} + \\mathbf{B}$$ $$\\mathbf{B} = \\boldsymbol{\\delta}\\boldsymbol{\\varphi}^{\\prime}$$ Implied economic weights: $$\\mathbf{w}_{PG} = \\mathbf{}^{-1}[\\mathbf{\\Phi} + \\mathbf{Q}_{PG}^{\\prime}\\mathbf{}]\\boldsymbol{\\beta}_{PG}$$ Selection response: $$R_{PG} = k_I \\sqrt{\\boldsymbol{\\beta}_{PG}^{\\prime}\\mathbf{\\Phi}\\boldsymbol{\\beta}_{PG}}$$ Expected genetic gain per trait: $$\\mathbf{E}_{PG} = k_I \\frac{\\mathbf{}\\boldsymbol{\\beta}_{PG}}{\\sqrt{\\boldsymbol{\\beta}_{PG}^{\\prime}\\mathbf{\\Phi}\\boldsymbol{\\beta}_{PG}}}$$","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/ppg_gesim.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Predetermined Proportional Gain Genomic Eigen Selection Index (PPG-GESIM) ‚Äî ppg_gesim","text":"Ceron-Rojas, J. J., & Crossa, J. (2018). Linear Selection Indices Modern Plant Breeding. Springer International Publishing. Section 8.5.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/ppg_gesim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Predetermined Proportional Gain Genomic Eigen Selection Index (PPG-GESIM) ‚Äî ppg_gesim","text":"","code":"if (FALSE) { # \\dontrun{ gmat <- gen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) pmat <- phen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1])  # Simulate GEBV covariance Gamma <- gmat * 0.8  # Desired proportional gains (e.g., 2:1:3 ratio for first 3 traits) d <- c(2, 1, 3, 1, 1, 1, 1)  result <- ppg_gesim(pmat, gmat, Gamma, d) print(result) print(result$gain_ratios) # Should be approximately constant } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/ppg_lgsi.html","id":null,"dir":"Reference","previous_headings":"","what":"Predetermined Proportional Gains Linear Genomic Selection Index (PPG-LGSI) ‚Äî ppg_lgsi","title":"Predetermined Proportional Gains Linear Genomic Selection Index (PPG-LGSI) ‚Äî ppg_lgsi","text":"Implements PPG-LGSI breeders specify desired proportional gains traits rather restricting specific traits zero. genomic version PPG-LPSI using GEBVs .","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/ppg_lgsi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predetermined Proportional Gains Linear Genomic Selection Index (PPG-LGSI) ‚Äî ppg_lgsi","text":"","code":"ppg_lgsi(   Gamma,   d,   wmat = NULL,   wcol = 1,   U = NULL,   k_I = 2.063,   L_G = 1,   gmat = NULL,   GAY = NULL )"},{"path":"https://zankrut20.github.io/selection.index/reference/ppg_lgsi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predetermined Proportional Gains Linear Genomic Selection Index (PPG-LGSI) ‚Äî ppg_lgsi","text":"Gamma GEBV variance-covariance matrix (n_traits x n_traits) d Vector desired proportional gains (length n_traits n_constraints). length n_traits, constraints applied traits. length n_constraints, must provide U matrix. wmat Optional. Economic weights GA/PRE calculation wcol Weight column use wmat multiple columns (default: 1) U Optional. Constraint matrix (n_traits x n_constraints). NULL, assumes d applies traits (U = ). k_I Selection intensity (default: 2.063) L_G Standardization constant (default: 1) gmat Optional. True genetic variance-covariance matrix exact accuracy calculation. NULL, uses Gamma approximation. GAY Optional. Genetic advance comparative trait PRE calculation","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/ppg_lgsi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predetermined Proportional Gains Linear Genomic Selection Index (PPG-LGSI) ‚Äî ppg_lgsi","text":"List : summary - Data frame coefficients metrics b - Vector PPG-LGSI coefficients (\\(\\beta_{PG}\\)) E - Named vector expected genetic gains per trait theta_G - Proportionality constant gain_ratios - Ratios achieved desired gains","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/ppg_lgsi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predetermined Proportional Gains Linear Genomic Selection Index (PPG-LGSI) ‚Äî ppg_lgsi","text":"Mathematical Formulation (Chapter 6, Section 6.2): Alternative form: \\(beta_PG = beta_RG + theta_G * U * (U' * Gamma * U)^{-1} * d\\) : - beta_RG = Restricted index coefficients (RLGSI) - theta_G = Proportionality constant - d = Vector desired proportional gains Proportionality constant: $$theta_G = (d' * (U' * Gamma * U)^{-1} * U' * Gamma * w) / (d' * (U' * Gamma * U)^{-1} * d)$$","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/ppg_lgsi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Predetermined Proportional Gains Linear Genomic Selection Index (PPG-LGSI) ‚Äî ppg_lgsi","text":"","code":"if (FALSE) { # \\dontrun{ # Simulate GEBV variance-covariance matrix set.seed(123) n_traits <- 5 Gamma <- matrix(rnorm(n_traits^2), n_traits, n_traits) Gamma <- (Gamma + t(Gamma)) / 2 diag(Gamma) <- abs(diag(Gamma)) + 2  # Desired proportional gains (e.g., 2:1:1:0:0 ratio) d <- c(2, 1, 1, 0, 0)  # Economic weights w <- c(10, 8, 6, 4, 2)  result <- ppg_lgsi(Gamma, d, wmat = w) print(result$summary) print(result$gain_ratios) # Should be approximately proportional to d } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/ppg_lpsi.html","id":null,"dir":"Reference","previous_headings":"","what":"Predetermined Proportional Gains (PPG-LPSI) ‚Äî ppg_lpsi","title":"Predetermined Proportional Gains (PPG-LPSI) ‚Äî ppg_lpsi","text":"Implements PPG-LPSI breeders specify desired proportional gains traits rather restricting specific traits zero. Based Tallis (1962).","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/ppg_lpsi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predetermined Proportional Gains (PPG-LPSI) ‚Äî ppg_lpsi","text":"","code":"ppg_lpsi(pmat, gmat, k, wmat = NULL, wcol = 1, GAY)"},{"path":"https://zankrut20.github.io/selection.index/reference/ppg_lpsi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predetermined Proportional Gains (PPG-LPSI) ‚Äî ppg_lpsi","text":"pmat Phenotypic variance-covariance matrix (n_traits x n_traits) gmat Genotypic variance-covariance matrix (n_traits x n_traits) k Vector desired proportional gains (length n_traits). Example: k = c(2, 1, 1) means trait 1 gain twice much traits 2 3. wmat Optional weight matrix GA/PRE calculation wcol Weight column number (default: 1) GAY Genetic advance comparative trait (optional)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/ppg_lpsi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predetermined Proportional Gains (PPG-LPSI) ‚Äî ppg_lpsi","text":"List : summary - Data frame coefficients metrics b - Vector PPG-LPSI coefficients Delta_G - Expected genetic gains per trait phi - Proportionality constant","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/ppg_lpsi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predetermined Proportional Gains (PPG-LPSI) ‚Äî ppg_lpsi","text":"Mathematical Formulation (Chapter 3, Section 3.2): PPG-LPSI achieves gains specific proportions: Delta_G = phi*k Coefficient formula (Tallis, 1962): $$b = P^{-1}G(G'P^{-1}G)^{-1}k$$ : - k = Vector desired proportions - phi = Proportionality constant (determined selection intensity variances) constraint ensures Delta_G1:Delta_G2:Delta_G3 = k1:k2:k3","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/ppg_lpsi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Predetermined Proportional Gains (PPG-LPSI) ‚Äî ppg_lpsi","text":"","code":"if (FALSE) { # \\dontrun{ gmat <- gen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) pmat <- phen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1])  # Gains in ratio 2:1:1:1:1:1:1 k <- c(2, 1, 1, 1, 1, 1, 1) result <- ppg_lpsi(pmat, gmat, k) } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/predict_selection_score.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict selection index scores ‚Äî predict_selection_score","title":"Predict selection index scores ‚Äî predict_selection_score","text":"Predict selection index scores","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/predict_selection_score.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict selection index scores ‚Äî predict_selection_score","text":"","code":"predict_selection_score(index_df, data, genotypes)"},{"path":"https://zankrut20.github.io/selection.index/reference/predict_selection_score.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict selection index scores ‚Äî predict_selection_score","text":"index_df Data frame returned lpsi() data Raw phenotypic data matrix/data frame (observations x traits) genotypes Vector genotype/treatment labels observation","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/predict_selection_score.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict selection index scores ‚Äî predict_selection_score","text":"Data frame selection index scores genotype","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/predict_selection_score.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Predict selection index scores ‚Äî predict_selection_score","text":"","code":"gmat <- gen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) pmat <- phen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) cindex <- lpsi(ncomb = 1, pmat = pmat, gmat = gmat, wmat = weight[, -1], wcol = 1) predict_selection_score(cindex, data = seldata[, 3:9], genotypes = seldata[, 2]) #>    Genotypes      I_1 I_1_Rank      I_2 I_2_Rank      I_3 I_3_Rank      I_4 #> 1         G1 3.456263       19 10.24955     24.0 4.539159        1 1.491622 #> 2         G2 4.224499       13 10.38266     16.0 4.003627        4 1.582573 #> 3         G3 2.875212       23 10.78199      6.0 2.885280       22 1.115753 #> 4         G4 4.425748        9 10.58233      9.0 3.791595        8 1.494010 #> 5         G5 4.429979        8 10.51578     11.0 3.794073        7 1.540463 #> 6         G6 3.876003       17 10.31611     20.5 3.072927       18 1.278441 #> 7         G7 3.095577       22 10.31611     20.5 3.242285       16 1.188075 #> 8         G8 3.491337       18 10.98166      4.0 3.630514       12 1.404757 #> 9         G9 5.418307        1 10.31611     17.0 3.366143       15 1.794447 #> 10       G10 2.431071       25 10.51578     11.0 2.891178       21 1.370714 #> 11       G11 4.468465        7 10.71544      7.0 3.214727       17 1.536046 #> 12       G12 4.172392       14 10.31611     20.5 2.584034       23 1.681126 #> 13       G13 4.280248       11 10.38267     15.0 2.962747       19 1.577450 #> 14       G14 5.155877        2 10.31611     20.5 3.878331        5 1.916752 #> 15       G15 2.710617       24 10.64889      8.0 1.941247       25 1.790706 #> 16       G16 4.163949       15 10.44923     13.5 4.114500        3 1.534393 #> 17       G17 4.406126       10 10.44923     13.5 3.717250       10 1.429515 #> 18       G18 3.948932       16 10.31611     20.5 3.705999       11 1.804663 #> 19       G19 4.921996        4 11.18133      2.0 3.747533        9 1.158209 #> 20       G20 4.829214        5 10.11645     25.0 2.450609       24 1.905515 #> 21       G21 4.937996        3 10.98167      3.0 3.472159       13 1.438559 #> 22       G22 4.823550        6 11.78033      1.0 4.212883        2 1.327702 #> 23       G23 3.328132       21 10.51578     11.0 3.447427       14 1.264469 #> 24       G24 3.453568       20 10.31611     20.5 2.940741       20 1.072726 #> 25       G25 4.245742       12 10.84856      5.0 3.827380        6 1.043280 #>    I_4_Rank      I_5 I_5_Rank      I_6 I_6_Rank      I_7 I_7_Rank #> 1        13 2.425143       10 4.018543       24 1.279820       15 #> 2         7 3.137633        1 4.314709       19 1.133963       24 #> 3        23 1.681191       24 4.623779        9 1.322424       12 #> 4        12 2.886623        3 4.692408        6 1.226627       17 #> 5         9 2.873967        4 4.472748       11 1.224183       18 #> 6        19 2.100105       14 4.792693        3 1.571220        8 #> 7        21 1.880386       19 4.293589       21 1.270798       16 #> 8        16 2.432325        9 4.180110       23 1.072249       25 #> 9         4 2.350293       11 4.409919       15 1.779793        1 #> 10       17 1.842155       22 3.817587       25 1.168735       22 #> 11       10 2.040485       16 4.603191       10 1.741888        3 #> 12        6 1.879490       20 4.430459       14 1.657243        5 #> 13        8 2.000945       18 4.376523       17 1.578488        7 #> 14        1 2.664352        7 4.465015       12 1.390967       10 #> 15        5 1.734347       23 4.249222       22 1.136030       23 #> 16       11 2.996593        2 4.378360       16 1.284456       14 #> 17       15 2.841061        5 4.345350       18 1.219923       19 #> 18        3 2.700421        6 4.303110       20 1.209523       20 #> 19       22 2.101719       13 5.091759        1 1.705988        4 #> 20        2 2.220664       12 5.015204        2 1.771962        2 #> 21       14 2.567523        8 4.663748        8 1.388523       11 #> 22       18 2.010891       17 4.735373        5 1.565080        9 #> 23       20 1.867931       21 4.667470        7 1.175126       21 #> 24       24 1.539349       25 4.454528       13 1.302187       13 #> 25       25 2.051917       15 4.767899        4 1.584377        6"},{"path":"https://zankrut20.github.io/selection.index/reference/print.base_index.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for Base Index ‚Äî print.base_index","title":"Print method for Base Index ‚Äî print.base_index","text":"Print method Base Index","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/print.base_index.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for Base Index ‚Äî print.base_index","text":"","code":"# S3 method for class 'base_index' print(x, ...)"},{"path":"https://zankrut20.github.io/selection.index/reference/print.base_index.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for Base Index ‚Äî print.base_index","text":"x Object class 'base_index' ... Additional arguments (unused)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/print.dg_lpsi.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for Desired Gains Index ‚Äî print.dg_lpsi","title":"Print method for Desired Gains Index ‚Äî print.dg_lpsi","text":"Print method Desired Gains Index","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/print.dg_lpsi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for Desired Gains Index ‚Äî print.dg_lpsi","text":"","code":"# S3 method for class 'dg_lpsi' print(x, ...)"},{"path":"https://zankrut20.github.io/selection.index/reference/print.dg_lpsi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for Desired Gains Index ‚Äî print.dg_lpsi","text":"x Object class 'dg_lpsi' ... Additional arguments (unused)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/print.esim.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for ESIM ‚Äî print.esim","title":"Print method for ESIM ‚Äî print.esim","text":"Print method ESIM","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/print.esim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for ESIM ‚Äî print.esim","text":"","code":"# S3 method for class 'esim' print(x, ...)"},{"path":"https://zankrut20.github.io/selection.index/reference/print.esim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for ESIM ‚Äî print.esim","text":"x Object class 'esim' ... Additional arguments (unused)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/print.gesim.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for GESIM ‚Äî print.gesim","title":"Print method for GESIM ‚Äî print.gesim","text":"Print method GESIM","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/print.gesim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for GESIM ‚Äî print.gesim","text":"","code":"# S3 method for class 'gesim' print(x, ...)"},{"path":"https://zankrut20.github.io/selection.index/reference/print.gesim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for GESIM ‚Äî print.gesim","text":"x Object class 'gesim' ... Additional arguments (unused)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/print.gw_esim.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for GW-ESIM ‚Äî print.gw_esim","title":"Print method for GW-ESIM ‚Äî print.gw_esim","text":"Print method GW-ESIM","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/print.gw_esim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for GW-ESIM ‚Äî print.gw_esim","text":"","code":"# S3 method for class 'gw_esim' print(x, ...)"},{"path":"https://zankrut20.github.io/selection.index/reference/print.gw_esim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for GW-ESIM ‚Äî print.gw_esim","text":"x Object class 'gw_esim' ... Additional arguments (unused)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/print.mesim.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for MESIM ‚Äî print.mesim","title":"Print method for MESIM ‚Äî print.mesim","text":"Print method MESIM","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/print.mesim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for MESIM ‚Äî print.mesim","text":"","code":"# S3 method for class 'mesim' print(x, ...)"},{"path":"https://zankrut20.github.io/selection.index/reference/print.mesim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for MESIM ‚Äî print.mesim","text":"x Object class 'mesim' ... Additional arguments (unused)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/print.ppg_esim.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for PPG-ESIM ‚Äî print.ppg_esim","title":"Print method for PPG-ESIM ‚Äî print.ppg_esim","text":"Print method PPG-ESIM","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/print.ppg_esim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for PPG-ESIM ‚Äî print.ppg_esim","text":"","code":"# S3 method for class 'ppg_esim' print(x, ...)"},{"path":"https://zankrut20.github.io/selection.index/reference/print.ppg_esim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for PPG-ESIM ‚Äî print.ppg_esim","text":"x Object class 'ppg_esim' ... Additional arguments (unused)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/print.ppg_gesim.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for PPG-GESIM ‚Äî print.ppg_gesim","title":"Print method for PPG-GESIM ‚Äî print.ppg_gesim","text":"Print method PPG-GESIM","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/print.ppg_gesim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for PPG-GESIM ‚Äî print.ppg_gesim","text":"","code":"# S3 method for class 'ppg_gesim' print(x, ...)"},{"path":"https://zankrut20.github.io/selection.index/reference/print.ppg_gesim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for PPG-GESIM ‚Äî print.ppg_gesim","text":"x Object class 'ppg_gesim' ... Additional arguments (unused)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/print.resim.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for RESIM ‚Äî print.resim","title":"Print method for RESIM ‚Äî print.resim","text":"Print method RESIM","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/print.resim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for RESIM ‚Äî print.resim","text":"","code":"# S3 method for class 'resim' print(x, ...)"},{"path":"https://zankrut20.github.io/selection.index/reference/print.resim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for RESIM ‚Äî print.resim","text":"x Object class 'resim' ... Additional arguments (unused)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/print.rgesim.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for RGESIM ‚Äî print.rgesim","title":"Print method for RGESIM ‚Äî print.rgesim","text":"Print method RGESIM","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/print.rgesim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for RGESIM ‚Äî print.rgesim","text":"","code":"# S3 method for class 'rgesim' print(x, ...)"},{"path":"https://zankrut20.github.io/selection.index/reference/print.rgesim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for RGESIM ‚Äî print.rgesim","text":"x Object class 'rgesim' ... Additional arguments (unused)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/print.selection_simulation.html","id":null,"dir":"Reference","previous_headings":"","what":"Print Method for Selection Simulation Results ‚Äî print.selection_simulation","title":"Print Method for Selection Simulation Results ‚Äî print.selection_simulation","text":"Print Method Selection Simulation Results","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/print.selection_simulation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print Method for Selection Simulation Results ‚Äî print.selection_simulation","text":"","code":"# S3 method for class 'selection_simulation' print(x, ...)"},{"path":"https://zankrut20.github.io/selection.index/reference/print.selection_simulation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print Method for Selection Simulation Results ‚Äî print.selection_simulation","text":"x Object class selection_simulation ... Additional arguments (used)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/print.smith_hazel.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for Smith-Hazel Index ‚Äî print.smith_hazel","title":"Print method for Smith-Hazel Index ‚Äî print.smith_hazel","text":"Print method Smith-Hazel Index","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/print.smith_hazel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for Smith-Hazel Index ‚Äî print.smith_hazel","text":"","code":"# S3 method for class 'smith_hazel' print(x, ...)"},{"path":"https://zankrut20.github.io/selection.index/reference/print.smith_hazel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for Smith-Hazel Index ‚Äî print.smith_hazel","text":"x Object class 'smith_hazel' ... Additional arguments (unused)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/resim.html","id":null,"dir":"Reference","previous_headings":"","what":"Restricted Linear Phenotypic Eigen Selection Index (RESIM) ‚Äî resim","title":"Restricted Linear Phenotypic Eigen Selection Index (RESIM) ‚Äî resim","text":"Extends ESIM imposing null restrictions: genetic gains \\(r\\) selected traits forced zero index heritability remaining traits maximised.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/resim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Restricted Linear Phenotypic Eigen Selection Index (RESIM) ‚Äî resim","text":"","code":"resim(   pmat,   gmat,   restricted_traits = NULL,   U_mat = NULL,   selection_intensity = 2.063 )"},{"path":"https://zankrut20.github.io/selection.index/reference/resim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Restricted Linear Phenotypic Eigen Selection Index (RESIM) ‚Äî resim","text":"pmat Phenotypic variance-covariance matrix (n_traits x n_traits). gmat Genotypic variance-covariance matrix (n_traits x n_traits). restricted_traits Integer vector trait indices restrict zero genetic gain.  Example: c(1, 3) restricts traits 1 3. Alternatively supply custom restriction matrix via U_mat. U_mat Optional. Restriction matrix (n_traits x r) column defines one null restriction (\\(\\mathbf{U}^{\\prime}\\mathbf{C}\\mathbf{b} = 0\\)). Ignored restricted_traits provided. selection_intensity Selection intensity constant (default: 2.063).","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/resim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Restricted Linear Phenotypic Eigen Selection Index (RESIM) ‚Äî resim","text":"Object class \"resim\", list : summary Data frame b coefficients key metrics. b Named numeric vector RESIM coefficients. Delta_G Named vector expected genetic gains per trait. sigma_I Index standard deviation. hI2 Index heritability (leading eigenvalue KP^(-1)C). rHI Index accuracy. lambda2 Leading eigenvalue restricted eigenproblem. K Projection matrix used. U_mat Restriction matrix used. restricted_traits Integer vector restricted trait indices. implied_w Implied economic weights. selection_intensity Selection intensity used.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/resim.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Restricted Linear Phenotypic Eigen Selection Index (RESIM) ‚Äî resim","text":"Projection matrix (Section 7.2): $$\\mathbf{K} = \\mathbf{}_t -   \\mathbf{P}^{-1}\\mathbf{C}\\mathbf{U}   (\\mathbf{U}^{\\prime}\\mathbf{C}\\mathbf{P}^{-1}\\mathbf{C}\\mathbf{U})^{-1}   \\mathbf{U}^{\\prime}\\mathbf{C}$$ Restricted eigenproblem: $$(\\mathbf{K}\\mathbf{P}^{-1}\\mathbf{C} - \\lambda_R^2 \\mathbf{}_t)\\mathbf{b}_R = 0$$ Selection response genetic gain: $$R_R = k_I \\sqrt{\\mathbf{b}_R^{\\prime}\\mathbf{P}\\mathbf{b}_R}$$ $$\\mathbf{E}_R = k_I \\frac{\\mathbf{C}\\mathbf{b}_R}{\\sqrt{\\mathbf{b}_R^{\\prime}\\mathbf{P}\\mathbf{b}_R}}$$ Implied economic weights: $$\\mathbf{w}_R = \\mathbf{C}^{-1}[\\mathbf{P} + \\mathbf{Q}_R^{\\prime}\\mathbf{C}]\\mathbf{b}_R$$ \\(\\mathbf{Q}_R = \\mathbf{} - \\mathbf{K}\\).","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/resim.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Restricted Linear Phenotypic Eigen Selection Index (RESIM) ‚Äî resim","text":"Ceron-Rojas, J. J., & Crossa, J. (2018). Linear Selection Indices Modern Plant Breeding. Springer International Publishing. Section 7.2.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/resim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Restricted Linear Phenotypic Eigen Selection Index (RESIM) ‚Äî resim","text":"","code":"if (FALSE) { # \\dontrun{ gmat <- gen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) pmat <- phen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1])  # Restrict traits 1 and 3 to zero genetic gain result <- resim(pmat, gmat, restricted_traits = c(1, 3)) print(result) summary(result) } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/rgesim.html","id":null,"dir":"Reference","previous_headings":"","what":"Restricted Linear Genomic Eigen Selection Index Method (RGESIM) ‚Äî rgesim","title":"Restricted Linear Genomic Eigen Selection Index Method (RGESIM) ‚Äî rgesim","text":"Implements RGESIM extends GESIM allow restrictions genetic gains certain traits. Uses eigen approach Lagrange multipliers.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/rgesim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Restricted Linear Genomic Eigen Selection Index Method (RGESIM) ‚Äî rgesim","text":"","code":"rgesim(pmat, gmat, Gamma, U_mat, selection_intensity = 2.063)"},{"path":"https://zankrut20.github.io/selection.index/reference/rgesim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Restricted Linear Genomic Eigen Selection Index Method (RGESIM) ‚Äî rgesim","text":"pmat Phenotypic variance-covariance matrix (n_traits x n_traits). gmat Genotypic variance-covariance matrix (n_traits x n_traits). Gamma Covariance phenotypes GEBVs (n_traits x n_traits). U_mat Restriction matrix (r x n_traits) r number restrictions. row specifies linear combination traits held zero gain. selection_intensity Selection intensity constant \\(k_I\\) (default: 2.063 10% selection).","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/rgesim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Restricted Linear Genomic Eigen Selection Index Method (RGESIM) ‚Äî rgesim","text":"Object class \"rgesim\", list : summary Data frame coefficients metrics. b_y Coefficients phenotypic data. b_gamma Coefficients GEBVs. b_combined Combined coefficient vector. E_RG Expected genetic gains per trait. constrained_response U' * E (near zero). sigma_I Standard deviation index. hI2 Index heritability. rHI Accuracy. R_RG Selection response. lambda2 Leading eigenvalue. implied_w Implied economic weights. K_RG Projection matrix. Q_RG Constraint projection matrix. selection_intensity Selection intensity used.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/rgesim.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Restricted Linear Genomic Eigen Selection Index Method (RGESIM) ‚Äî rgesim","text":"Eigenproblem (Section 8.4): $$(\\mathbf{K}_{RG}\\mathbf{\\Phi}^{-1}\\mathbf{} - \\lambda_{RG}^2 \\mathbf{}_{2t})\\boldsymbol{\\beta}_{RG} = 0$$ : $$\\mathbf{K}_{RG} = \\mathbf{}_{2t} - \\mathbf{Q}_{RG}$$ $$\\mathbf{Q}_{RG} = \\mathbf{\\Phi}^{-1}\\mathbf{}\\mathbf{U}_G(\\mathbf{U}_G^{\\prime}\\mathbf{}\\mathbf{\\Phi}^{-1}\\mathbf{}\\mathbf{U}_G)^{-1}\\mathbf{U}_G^{\\prime}\\mathbf{}$$ Implied economic weights: $$\\mathbf{w}_{RG} = \\mathbf{}^{-1}[\\mathbf{\\Phi} + \\mathbf{Q}_{RG}^{\\prime}\\mathbf{}]\\boldsymbol{\\beta}_{RG}$$ Selection response: $$R_{RG} = k_I \\sqrt{\\boldsymbol{\\beta}_{RG}^{\\prime}\\mathbf{\\Phi}\\boldsymbol{\\beta}_{RG}}$$ Expected genetic gain per trait: $$\\mathbf{E}_{RG} = k_I \\frac{\\mathbf{}\\boldsymbol{\\beta}_{RG}}{\\sqrt{\\boldsymbol{\\beta}_{RG}^{\\prime}\\mathbf{\\Phi}\\boldsymbol{\\beta}_{RG}}}$$","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/rgesim.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Restricted Linear Genomic Eigen Selection Index Method (RGESIM) ‚Äî rgesim","text":"Ceron-Rojas, J. J., & Crossa, J. (2018). Linear Selection Indices Modern Plant Breeding. Springer International Publishing. Section 8.4.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/rgesim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Restricted Linear Genomic Eigen Selection Index Method (RGESIM) ‚Äî rgesim","text":"","code":"if (FALSE) { # \\dontrun{ gmat <- gen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) pmat <- phen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1])  # Simulate GEBV covariance Gamma <- gmat * 0.8  # Restrict first trait to zero gain # U_mat must be (n_traits x n_restrictions) n_traits <- nrow(gmat) U_mat <- matrix(0, n_traits, 1) U_mat[1, 1] <- 1 # Restrict trait 1  result <- rgesim(pmat, gmat, Gamma, U_mat) print(result) print(result$constrained_response) # Should be near zero } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/rlgsi.html","id":null,"dir":"Reference","previous_headings":"","what":"Restricted Linear Genomic Selection Index (RLGSI) ‚Äî rlgsi","title":"Restricted Linear Genomic Selection Index (RLGSI) ‚Äî rlgsi","text":"Implements Restricted Linear Genomic Selection Index genetic gains constrained zero specific traits maximizing gains others. Uses GEBVs (phenotypic data required).","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/rlgsi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Restricted Linear Genomic Selection Index (RLGSI) ‚Äî rlgsi","text":"","code":"rlgsi(   Gamma,   wmat,   wcol = 1,   restricted_traits = NULL,   U = NULL,   k_I = 2.063,   L_G = 1,   gmat = NULL,   GAY = NULL )"},{"path":"https://zankrut20.github.io/selection.index/reference/rlgsi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Restricted Linear Genomic Selection Index (RLGSI) ‚Äî rlgsi","text":"Gamma GEBV variance-covariance matrix (n_traits x n_traits). represents variance GEBVs, typically computed predicted breeding values. wmat Economic weights matrix (n_traits x k), vector wcol Weight column use wmat multiple columns (default: 1) restricted_traits Vector trait indices restrict (default: NULL). Example: c(1, 3) restricts traits 1 3 zero gain. U Constraint matrix (n_traits x n_constraints). column defines restriction. Alternative restricted_traits custom constraints. Ignored restricted_traits provided. k_I Selection intensity (default: 2.063 10 percent selection) L_G Standardization constant (default: 1). Can set sqrt(w'Gw) standardization. gmat Optional. True genetic variance-covariance matrix exact accuracy calculation. NULL, uses Gamma approximation. Providing gmat ensures textbook-perfect accuracy metric. GAY Optional. Genetic advance comparative trait PRE calculation","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/rlgsi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Restricted Linear Genomic Selection Index (RLGSI) ‚Äî rlgsi","text":"List : summary - Data frame coefficients, response metrics b - Vector RLGSI coefficients (\\(\\beta_{RG}\\)) E - Named vector expected genetic gains per trait R - Overall selection response U - Constraint matrix used constrained_response - Realized gains constrained traits (~0)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/rlgsi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Restricted Linear Genomic Selection Index (RLGSI) ‚Äî rlgsi","text":"Mathematical Formulation (Chapter 6, Section 6.1): RLGSI minimizes mean squared difference index = \\(\\beta\\)'\\(\\gamma\\) breeding objective H = w'g restriction: U'\\(\\Gamma\\)\\(\\beta\\) = 0 Solution involves solving augmented system: $$\\begin{bmatrix} \\Gamma & \\Gamma U \\\\ U'\\Gamma & 0 \\end{bmatrix}       \\begin{bmatrix} \\beta \\\\ v \\end{bmatrix} =       \\begin{bmatrix} \\Gamma w \\\\ 0 \\end{bmatrix}$$ : - \\(\\Gamma\\) (Gamma) = Var(GEBVs) - GEBV variance-covariance matrix - U = Constraint matrix (column restriction vector) - w = Economic weights - \\(\\beta_{RG}\\) = RLGSI coefficient vector - v = Lagrange multipliers Selection response: \\(R_{RG} = (k_I / L_G) * sqrt(beta_RG' * Gamma * beta_RG)\\) Expected gains: \\(E_{RG} = (k_I / L_G) * (Gamma * beta_RG) / sqrt(beta_RG' * Gamma * beta_RG)\\)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/rlgsi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Restricted Linear Genomic Selection Index (RLGSI) ‚Äî rlgsi","text":"","code":"if (FALSE) { # \\dontrun{ # Simulate GEBV variance-covariance matrix set.seed(123) n_traits <- 5 Gamma <- matrix(rnorm(n_traits^2), n_traits, n_traits) Gamma <- (Gamma + t(Gamma)) / 2 # Make symmetric diag(Gamma) <- abs(diag(Gamma)) + 2 # Ensure positive definite  # Economic weights w <- c(10, 8, 6, 4, 2)  # Restrict traits 2 and 4 to zero gain result <- rlgsi(Gamma, w, restricted_traits = c(2, 4)) print(result$summary) print(result$E) # Check that traits 2 and 4 have ~0 gain } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/rlpsi.html","id":null,"dir":"Reference","previous_headings":"","what":"Restricted Linear Phenotypic Selection Index (RLPSI) ‚Äî rlpsi","title":"Restricted Linear Phenotypic Selection Index (RLPSI) ‚Äî rlpsi","text":"Implements Restricted LPSI genetic gains constrained zero specific traits maximizing gains others. Based Kempthorne & Nordskog (1959).","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/rlpsi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Restricted Linear Phenotypic Selection Index (RLPSI) ‚Äî rlpsi","text":"","code":"rlpsi(pmat, gmat, wmat, wcol = 1, restricted_traits = NULL, C = NULL, GAY)"},{"path":"https://zankrut20.github.io/selection.index/reference/rlpsi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Restricted Linear Phenotypic Selection Index (RLPSI) ‚Äî rlpsi","text":"pmat Phenotypic variance-covariance matrix (n_traits x n_traits) gmat Genotypic variance-covariance matrix (n_traits x n_traits) wmat Weight matrix (n_traits x k), vector wcol Weight column number (default: 1) restricted_traits Vector trait indices restrict (default: NULL). provided, constraint matrix C auto-generated enforce zero gain traits. Example: c(1, 3) restricts traits 1 3 zero gain. C Constraint matrix (n_traits x n_constraints). column restriction. Alternative restricted_traits custom constraints. Ignored restricted_traits provided. GAY Genetic advance comparative trait (optional)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/rlpsi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Restricted Linear Phenotypic Selection Index (RLPSI) ‚Äî rlpsi","text":"List : summary - Data frame coefficients (b.*), GA, PRE, Delta_G, rHI, hI2 b - Numeric vector selection index coefficients Delta_G - Named vector realized correlated responses per trait C - Constraint matrix used","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/rlpsi.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Restricted Linear Phenotypic Selection Index (RLPSI) ‚Äî rlpsi","text":"Mathematical Formulation (Chapter 3, Section 3.1): RLPSI minimizes mean squared difference = b'y H = w'g subject restriction: C'Delta_G = 0 Coefficient formula: $$b_r = [- P^{-1}GC(C'GP^{-1}GC)^{-1}C'G]P^{-1}Gw$$ : - P = Phenotypic variance-covariance matrix - G = Genotypic variance-covariance matrix - C = Constraint matrix (column enforces one restriction) - w = Economic weights constraint C'Delta_G = 0 ensures zero genetic gain restricted traits.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/rlpsi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Restricted Linear Phenotypic Selection Index (RLPSI) ‚Äî rlpsi","text":"","code":"if (FALSE) { # \\dontrun{ gmat <- gen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) pmat <- phen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) wmat <- weight_mat(weight)  # Easy way: Restrict traits 1 and 3 to zero gain result <- rlpsi(pmat, gmat, wmat, wcol = 1, restricted_traits = c(1, 3))  # Advanced way: Provide custom constraint matrix C <- diag(ncol(pmat))[, 1, drop = FALSE] result <- rlpsi(pmat, gmat, wmat, wcol = 1, C = C) } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/seldata.html","id":null,"dir":"Reference","previous_headings":"","what":"Selection Index DataSet ‚Äî seldata","title":"Selection Index DataSet ‚Äî seldata","text":"dataset containing data three replications 48 progenies 7 different traits.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/seldata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Selection Index DataSet ‚Äî seldata","text":"","code":"data(seldata)"},{"path":"https://zankrut20.github.io/selection.index/reference/seldata.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Selection Index DataSet ‚Äî seldata","text":"data frame 75 rows 9 columns","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/seldata.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Selection Index DataSet ‚Äî seldata","text":"rep. Replications treat. Treatments/Genotypes sypp. Seed Yield per Plant dtf. Days 50 rpp. Racemes per Plant ppr. Pods per Raceme ppp. Pods per Plant spp. Seeds per Pod pw. Pods Weight","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/selection.index-package.html","id":null,"dir":"Reference","previous_headings":"","what":"selection.index: Analysis of Selection Index in Plant Breeding ‚Äî selection.index-package","title":"selection.index: Analysis of Selection Index in Plant Breeding ‚Äî selection.index-package","text":"Provides tools simultaneous improvement multiple traits plant breeding. Building upon classical selection index (Smith 1937 doi:10.1111/j.1469-1809.1936.tb02143.x ) modern quantitative genetics (Kang 2020 doi:10.1007/978-3-319-91223-3 ), package calculates classical phenotypic, genomic, marker-assisted, restricted/constrained, eigen selection indices. also incorporates multi-stage selection evaluation stochastic simulations estimate genetic advance based economic weights, heritability, genetic correlations.","code":""},{"path":[]},{"path":"https://zankrut20.github.io/selection.index/reference/selection.index-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"selection.index: Analysis of Selection Index in Plant Breeding ‚Äî selection.index-package","text":"Maintainer: Zankrut Goyani zankrut20@gmail.com [copyright holder]","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/simulate_selection_cycles.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate Multi-Cycle Selection Using Different Indices ‚Äî simulate_selection_cycles","title":"Simulate Multi-Cycle Selection Using Different Indices ‚Äî simulate_selection_cycles","text":"Performs stochastic simulation comparing long-term performance four selection indices (LPSI, ESIM, RLPSI, RESIM) multiple breeding cycles. Models linkage loci using Haldane's mapping function.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/simulate_selection_cycles.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate Multi-Cycle Selection Using Different Indices ‚Äî simulate_selection_cycles","text":"","code":"simulate_selection_cycles(   n_cycles = 50,   n_individuals = 1000,   n_loci = 100,   n_traits = 3,   heritability = 0.5,   selection_proportion = 0.1,   economic_weights = NULL,   restricted_traits = NULL,   genetic_distances = NULL,   qtl_effects = NULL,   seed = NULL )"},{"path":"https://zankrut20.github.io/selection.index/reference/simulate_selection_cycles.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate Multi-Cycle Selection Using Different Indices ‚Äî simulate_selection_cycles","text":"n_cycles Number selection cycles simulate (default: 50) n_individuals Initial population size (default: 1000) n_loci Number QTL per trait (default: 100) n_traits Number quantitative traits (default: 3) heritability Heritability traits (scalar vector, default: 0.5) selection_proportion Proportion individuals selected (default: 0.1) economic_weights Economic weights LPSI (default: equal weights) restricted_traits Trait indices restrict zero gain RLPSI/RESIM (default: NULL) genetic_distances Vector genetic distances loci Morgans (default: 0.1) qtl_effects Optional matrix QTL effects (n_loci x n_traits) seed Random seed reproducibility (default: NULL)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/simulate_selection_cycles.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate Multi-Cycle Selection Using Different Indices ‚Äî simulate_selection_cycles","text":"List components: lpsi_gain - Matrix genetic gains per cycle LPSI (n_cycles x n_traits) esim_gain - Matrix genetic gains per cycle ESIM rlpsi_gain - Matrix genetic gains per cycle RLPSI resim_gain - Matrix genetic gains per cycle RESIM lpsi_mean - Mean genetic value per cycle LPSI (n_cycles x n_traits) esim_mean - Mean genetic value per cycle ESIM rlpsi_mean - Mean genetic value per cycle RLPSI resim_mean - Mean genetic value per cycle RESIM parameters - List simulation parameters used","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/simulate_selection_cycles.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simulate Multi-Cycle Selection Using Different Indices ‚Äî simulate_selection_cycles","text":"Simulation Procedure (Chapter 10): 1. Initialize population random QTL alleles linked loci 2. cycle:    - Compute genetic values diploid genotypes    - Add environmental noise create phenotypes    - Calculate variance-covariance matrices    - Apply selection index (LPSI, ESIM, RLPSI, RESIM)    - Select top individuals based index scores    - Generate offspring recombination (using Haldane's function) 3. Track genetic gain population mean across cycles Four Indices (Chapter 10, Section 10.2): LPSI: Unrestricted index maximizing genetic gain: b = P^(-1)Gw ESIM: Unrestricted eigen index maximizing accuracy: (P^(-1)C - lambda^2 )b = 0 RLPSI: Restricted LPSI constraints: U'Gb = 0 RESIM: Restricted ESIM constraints: U'Cb = 0 Important Simulation Assumptions: Note: Environmental variance calculated generation 0 held constant across cycles. Heritability naturally decline cycles genetic variance depleted (Bulmer effect). models biological reality selection exhausts additive genetic variance environmental variation remains stable.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/simulate_selection_cycles.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate Multi-Cycle Selection Using Different Indices ‚Äî simulate_selection_cycles","text":"","code":"if (FALSE) { # \\dontrun{ # Basic simulation with 3 traits over 20 cycles results <- simulate_selection_cycles(   n_cycles = 20,   n_individuals = 500,   n_loci = 50,   n_traits = 3,   heritability = 0.5,   selection_proportion = 0.1,   economic_weights = c(10, 5, 3),   seed = 123 )  # Plot genetic gains plot(1:20, results$lpsi_mean[, 1],   type = \"l\", col = \"blue\",   ylab = \"Mean Genetic Value\", xlab = \"Cycle\",   main = \"Genetic Gain - Trait 1\" ) lines(1:20, results$esim_mean[, 1], col = \"red\") lines(1:20, results$rlpsi_mean[, 1], col = \"green\") lines(1:20, results$resim_mean[, 1], col = \"orange\") legend(\"topleft\", c(\"LPSI\", \"ESIM\", \"RLPSI\", \"RESIM\"),   col = c(\"blue\", \"red\", \"green\", \"orange\"), lty = 1 )  # Restrict trait 2 to zero gain results_restricted <- simulate_selection_cycles(   n_cycles = 20,   n_traits = 3,   restricted_traits = 2,   seed = 456 ) } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/smith_hazel.html","id":null,"dir":"Reference","previous_headings":"","what":"Smith-Hazel Linear Phenotypic Selection Index ‚Äî smith_hazel","title":"Smith-Hazel Linear Phenotypic Selection Index ‚Äî smith_hazel","text":"Implements optimal Smith-Hazel selection index maximizes correlation index = b'y breeding objective H = w'g. foundational selection index method Chapter 2.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/smith_hazel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Smith-Hazel Linear Phenotypic Selection Index ‚Äî smith_hazel","text":"","code":"smith_hazel(   pmat,   gmat,   wmat,   wcol = 1,   selection_intensity = 2.063,   GAY = NULL )"},{"path":"https://zankrut20.github.io/selection.index/reference/smith_hazel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Smith-Hazel Linear Phenotypic Selection Index ‚Äî smith_hazel","text":"pmat Phenotypic variance-covariance matrix (n_traits x n_traits) gmat Genotypic variance-covariance matrix (n_traits x n_traits) wmat Economic weights matrix (n_traits x k), vector wcol Weight column use wmat multiple columns (default: 1) selection_intensity Selection intensity constant (default: 2.063 10% selection) GAY Optional. Genetic advance comparative trait PRE calculation","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/smith_hazel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Smith-Hazel Linear Phenotypic Selection Index ‚Äî smith_hazel","text":"List : summary - Data frame coefficients metrics b - Vector Smith-Hazel index coefficients w - Named vector economic weights Delta_G - Named vector expected genetic gains per trait sigma_I - Standard deviation index GA - Total genetic advance PRE - Percent relative efficiency hI2 - Heritability index rHI - Accuracy (correlation breeding objective)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/smith_hazel.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Smith-Hazel Linear Phenotypic Selection Index ‚Äî smith_hazel","text":"Mathematical Formulation (Chapter 2): Index coefficients: \\(b = P^{-1}Gw\\) : - P = Phenotypic variance-covariance matrix - G = Genotypic variance-covariance matrix - w = Economic weights Key metrics: - Variance index: \\(\\sigma^2_I = b'Pb\\) - Total genetic advance: \\(R_H = \\sqrt{b'Pb}\\) - Expected gains per trait: \\(\\Delta G = (/\\sigma_I)Gb\\) - Heritability index: \\(h^2_I = b'Gb / b'Pb\\) - Accuracy: \\(r_{HI} = \\sqrt{b'Gb / b'Pb}\\)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/smith_hazel.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Smith-Hazel Linear Phenotypic Selection Index ‚Äî smith_hazel","text":"","code":"if (FALSE) { # \\dontrun{ # Calculate variance-covariance matrices gmat <- gen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1]) pmat <- phen_varcov(seldata[, 3:9], seldata[, 2], seldata[, 1])  # Define economic weights weights <- c(10, 8, 6, 4, 2, 1, 1)  # Build Smith-Hazel index result <- smith_hazel(pmat, gmat, weights) print(result) summary(result) } # }"},{"path":"https://zankrut20.github.io/selection.index/reference/stochastic_simulation.html","id":null,"dir":"Reference","previous_headings":"","what":"Stochastic Simulation of Selection Indices (Chapter 10) ‚Äî stochastic_simulation","title":"Stochastic Simulation of Selection Indices (Chapter 10) ‚Äî stochastic_simulation","text":"Implements stochastic simulation methods evaluating long-term performance selection indices multiple breeding cycles. methods model linkage loci using Haldane's mapping function track genetic gain across generations. Methods included: - Haldane's mapping function recombination - Multi-cycle simulation framework - Comparisons LPSI, ESIM, RLPSI, RESIM time","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/stochastic_simulation.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Stochastic Simulation of Selection Indices (Chapter 10) ‚Äî stochastic_simulation","text":"Haldane, J. B. S. (1919). combination linkage values calculation distances loci linked factors. Journal Genetics, 8(29), 299-309. Smith, H. F. (1936). discriminant function plant selection. Annals Eugenics, 7(3), 240-250. Hazel, L. N. (1943). genetic basis constructing selection indexes. Genetics, 28(6), 476. Kempthorne, O., & Nordskog, . W. (1959). Restricted selection indices. Biometrics, 15(1), 10-19. Ceron-Rojas, J. J., & Crossa, J. (2018). Linear Selection Indices Modern Plant Breeding. Springer International Publishing. Chapter 7 & 10.","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/summary.base_index.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary method for Base Index ‚Äî summary.base_index","title":"Summary method for Base Index ‚Äî summary.base_index","text":"Summary method Base Index","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/summary.base_index.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary method for Base Index ‚Äî summary.base_index","text":"","code":"# S3 method for class 'base_index' summary(object, ...)"},{"path":"https://zankrut20.github.io/selection.index/reference/summary.base_index.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary method for Base Index ‚Äî summary.base_index","text":"object Object class 'base_index' ... Additional arguments passed print","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/summary.dg_lpsi.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary method for Desired Gains Index ‚Äî summary.dg_lpsi","title":"Summary method for Desired Gains Index ‚Äî summary.dg_lpsi","text":"Summary method Desired Gains Index","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/summary.dg_lpsi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary method for Desired Gains Index ‚Äî summary.dg_lpsi","text":"","code":"# S3 method for class 'dg_lpsi' summary(object, ...)"},{"path":"https://zankrut20.github.io/selection.index/reference/summary.dg_lpsi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary method for Desired Gains Index ‚Äî summary.dg_lpsi","text":"object Object class 'dg_lpsi' ... Additional arguments (unused)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/summary.esim.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary method for ESIM ‚Äî summary.esim","title":"Summary method for ESIM ‚Äî summary.esim","text":"Summary method ESIM","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/summary.esim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary method for ESIM ‚Äî summary.esim","text":"","code":"# S3 method for class 'esim' summary(object, ...)"},{"path":"https://zankrut20.github.io/selection.index/reference/summary.esim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary method for ESIM ‚Äî summary.esim","text":"object Object class 'esim' ... Additional arguments (unused)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/summary.gesim.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary method for GESIM ‚Äî summary.gesim","title":"Summary method for GESIM ‚Äî summary.gesim","text":"Summary method GESIM","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/summary.gesim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary method for GESIM ‚Äî summary.gesim","text":"","code":"# S3 method for class 'gesim' summary(object, ...)"},{"path":"https://zankrut20.github.io/selection.index/reference/summary.gesim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary method for GESIM ‚Äî summary.gesim","text":"object Object class 'gesim' ... Additional arguments (unused)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/summary.gw_esim.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary method for GW-ESIM ‚Äî summary.gw_esim","title":"Summary method for GW-ESIM ‚Äî summary.gw_esim","text":"Summary method GW-ESIM","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/summary.gw_esim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary method for GW-ESIM ‚Äî summary.gw_esim","text":"","code":"# S3 method for class 'gw_esim' summary(object, ...)"},{"path":"https://zankrut20.github.io/selection.index/reference/summary.gw_esim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary method for GW-ESIM ‚Äî summary.gw_esim","text":"object Object class 'gw_esim' ... Additional arguments (unused)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/summary.mesim.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary method for MESIM ‚Äî summary.mesim","title":"Summary method for MESIM ‚Äî summary.mesim","text":"Summary method MESIM","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/summary.mesim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary method for MESIM ‚Äî summary.mesim","text":"","code":"# S3 method for class 'mesim' summary(object, ...)"},{"path":"https://zankrut20.github.io/selection.index/reference/summary.mesim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary method for MESIM ‚Äî summary.mesim","text":"object Object class 'mesim' ... Additional arguments (unused)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/summary.ppg_esim.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary method for PPG-ESIM ‚Äî summary.ppg_esim","title":"Summary method for PPG-ESIM ‚Äî summary.ppg_esim","text":"Summary method PPG-ESIM","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/summary.ppg_esim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary method for PPG-ESIM ‚Äî summary.ppg_esim","text":"","code":"# S3 method for class 'ppg_esim' summary(object, ...)"},{"path":"https://zankrut20.github.io/selection.index/reference/summary.ppg_esim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary method for PPG-ESIM ‚Äî summary.ppg_esim","text":"object Object class 'ppg_esim' ... Additional arguments (unused)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/summary.ppg_gesim.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary method for PPG-GESIM ‚Äî summary.ppg_gesim","title":"Summary method for PPG-GESIM ‚Äî summary.ppg_gesim","text":"Summary method PPG-GESIM","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/summary.ppg_gesim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary method for PPG-GESIM ‚Äî summary.ppg_gesim","text":"","code":"# S3 method for class 'ppg_gesim' summary(object, ...)"},{"path":"https://zankrut20.github.io/selection.index/reference/summary.ppg_gesim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary method for PPG-GESIM ‚Äî summary.ppg_gesim","text":"object Object class 'ppg_gesim' ... Additional arguments (unused)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/summary.resim.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary method for RESIM ‚Äî summary.resim","title":"Summary method for RESIM ‚Äî summary.resim","text":"Summary method RESIM","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/summary.resim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary method for RESIM ‚Äî summary.resim","text":"","code":"# S3 method for class 'resim' summary(object, ...)"},{"path":"https://zankrut20.github.io/selection.index/reference/summary.resim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary method for RESIM ‚Äî summary.resim","text":"object Object class 'resim' ... Additional arguments (unused)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/summary.rgesim.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary method for RGESIM ‚Äî summary.rgesim","title":"Summary method for RGESIM ‚Äî summary.rgesim","text":"Summary method RGESIM","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/summary.rgesim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary method for RGESIM ‚Äî summary.rgesim","text":"","code":"# S3 method for class 'rgesim' summary(object, ...)"},{"path":"https://zankrut20.github.io/selection.index/reference/summary.rgesim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary method for RGESIM ‚Äî summary.rgesim","text":"object Object class 'rgesim' ... Additional arguments (unused)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/summary.selection_simulation.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary Method for Selection Simulation Results ‚Äî summary.selection_simulation","title":"Summary Method for Selection Simulation Results ‚Äî summary.selection_simulation","text":"Summary Method Selection Simulation Results","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/summary.selection_simulation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary Method for Selection Simulation Results ‚Äî summary.selection_simulation","text":"","code":"# S3 method for class 'selection_simulation' summary(object, ...)"},{"path":"https://zankrut20.github.io/selection.index/reference/summary.selection_simulation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary Method for Selection Simulation Results ‚Äî summary.selection_simulation","text":"object Object class selection_simulation ... Additional arguments (used)","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/summary.smith_hazel.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary method for Smith-Hazel Index ‚Äî summary.smith_hazel","title":"Summary method for Smith-Hazel Index ‚Äî summary.smith_hazel","text":"Summary method Smith-Hazel Index","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/summary.smith_hazel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary method for Smith-Hazel Index ‚Äî summary.smith_hazel","text":"","code":"# S3 method for class 'smith_hazel' summary(object, ...)"},{"path":"https://zankrut20.github.io/selection.index/reference/summary.smith_hazel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary method for Smith-Hazel Index ‚Äî summary.smith_hazel","text":"object Object class 'smith_hazel' ... Additional arguments passed print","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/weight.html","id":null,"dir":"Reference","previous_headings":"","what":"Weight dataset ‚Äî weight","title":"Weight dataset ‚Äî weight","text":"dataset containing data 2 different weights namely euqal weight broad sense heritability","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/weight.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Weight dataset ‚Äî weight","text":"","code":"data(weight)"},{"path":"https://zankrut20.github.io/selection.index/reference/weight.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Weight dataset ‚Äî weight","text":"data frame 7 rows 3 columns","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/weight.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Weight dataset ‚Äî weight","text":"EW. Equal Weight h2. Broad Sense Heritability","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/weight_mat.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert dataframe to matrix ‚Äî weight_mat","title":"Convert dataframe to matrix ‚Äî weight_mat","text":"Convert dataframe matrix","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/weight_mat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert dataframe to matrix ‚Äî weight_mat","text":"","code":"weight_mat(data)"},{"path":"https://zankrut20.github.io/selection.index/reference/weight_mat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert dataframe to matrix ‚Äî weight_mat","text":"data dataframe weight","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/weight_mat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert dataframe to matrix ‚Äî weight_mat","text":"matrix","code":""},{"path":"https://zankrut20.github.io/selection.index/reference/weight_mat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert dataframe to matrix ‚Äî weight_mat","text":"","code":"weight_mat(data = weight) #>      ew     h2 #> [1,]  1 0.6947 #> [2,]  1 0.3244 #> [3,]  1 0.6861 #> [4,]  1 0.7097 #> [5,]  1 0.8336 #> [6,]  1 0.2201 #> [7,]  1 0.5226"},{"path":"https://zankrut20.github.io/selection.index/news/index.html","id":"selectionindex-200","dir":"Changelog","previous_headings":"","what":"selection.index 2.0.0","title":"selection.index 2.0.0","text":"CRAN release: 2026-02-28","code":""},{"path":"https://zankrut20.github.io/selection.index/news/index.html","id":"breaking-changes-2-0-0","dir":"Changelog","previous_headings":"","what":"Breaking changes","title":"selection.index 2.0.0","text":"phen.varcov() now phen_varcov() gen.varcov() now gen_varcov() weight.mat() now weight_mat() gen.advance() now gen_advance() base combinatorial selection functions replaced dedicated lpsi() function (Linear Phenotypic Selection Index).","code":""},{"path":"https://zankrut20.github.io/selection.index/news/index.html","id":"major-changes-2-0-0","dir":"Changelog","previous_headings":"","what":"Major changes","title":"selection.index 2.0.0","text":"variance-covariance calculation engine, system solvers, combinatorial index builders now fully powered Rcpp RcppEigen. Index evaluations large trait configurations now exponentially faster due primitive matrix operations.","code":""},{"path":"https://zankrut20.github.io/selection.index/news/index.html","id":"new-features-2-0-0","dir":"Changelog","previous_headings":"","what":"New features","title":"selection.index 2.0.0","text":"Introduced new suites evaluating linear genomic selection indices (lgsi()) combining genomic/phenotypic data (ppg_lgsi()). Introduced new modules tracking continuous index performance across multiple stages breeding trials (mlpsi(), mlgsi()). Implemented specialized solvers maximize genetic advance specifically constraining genetic gain restrictive/undesired traits zero (rlpsi(), dg_lpsi()). Adopted Eigen-decomposition based selection methods phenotypic (esim()) genomic (gesim()) evaluations. Added specialized infrastructure evaluating linear marker selection indices (lmsi()). Added new comprehensive toolsets actively simulate visualize multi-cycle genetic advance time varied selection index intensities environmental variances (simulate_selection_cycles()). Created complete pkgdown official website. Added complete vignette suite detailing mathematical foundation code usage new marker, genomic, multi-stage, constrained, stochastic features.","code":""},{"path":"https://zankrut20.github.io/selection.index/news/index.html","id":"selectionindex-121","dir":"Changelog","previous_headings":"","what":"selection.index 1.2.1","title":"selection.index 1.2.1","text":"CRAN release: 2026-01-26 improve overall performance package","code":""},{"path":"https://zankrut20.github.io/selection.index/news/index.html","id":"selectionindex-120","dir":"Changelog","previous_headings":"","what":"selection.index 1.2.0","title":"selection.index 1.2.0","text":"CRAN release: 2023-09-19 add new function meanPerformance() calculating mean performance randomized block design data remove typos documentation","code":""},{"path":"https://zankrut20.github.io/selection.index/news/index.html","id":"selectionindex-114","dir":"Changelog","previous_headings":"","what":"selection.index 1.1.4","title":"selection.index 1.1.4","text":"CRAN release: 2022-06-13 removed two functions sel.index() sel.score.rank() easy implementation comb.indices()","code":""},{"path":"https://zankrut20.github.io/selection.index/news/index.html","id":"selectionindex-113","dir":"Changelog","previous_headings":"","what":"selection.index 1.1.3","title":"selection.index 1.1.3","text":"CRAN release: 2021-09-25 Added new function gen.advance() genetic advance calculation","code":""},{"path":"https://zankrut20.github.io/selection.index/news/index.html","id":"selectionindex-112","dir":"Changelog","previous_headings":"","what":"selection.index 1.1.2","title":"selection.index 1.1.2","text":"CRAN release: 2021-07-26 rank column added rcomb.indices() ranking index","code":""},{"path":"https://zankrut20.github.io/selection.index/news/index.html","id":"selectionindex-111","dir":"Changelog","previous_headings":"","what":"selection.index 1.1.1","title":"selection.index 1.1.1","text":"CRAN release: 2021-06-03 Added new function rcomb.indices() calculated possible selection indices excluding single character particular index possible selection indices","code":""},{"path":"https://zankrut20.github.io/selection.index/news/index.html","id":"selectionindex-110","dir":"Changelog","previous_headings":"","what":"selection.index 1.1.0","title":"selection.index 1.1.0","text":"CRAN release: 2021-04-23 Bug fixes phen.varcov() Added new function comb.indices() calculating possible selection indices group/pairs traits/characters removed function: rank.index()","code":""},{"path":"https://zankrut20.github.io/selection.index/news/index.html","id":"selectionindex-100","dir":"Changelog","previous_headings":"","what":"selection.index 1.0.0","title":"selection.index 1.0.0","text":"CRAN release: 2021-04-06 Added NEWS.md file track changes package.","code":""}]
