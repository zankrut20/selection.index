<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Data Analysis with selection.index • selection.index</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Data Analysis with selection.index">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">selection.index</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/constrained-linear-genomic-selection-indices.html">Constrained Linear Genomic Selection Indices</a></li>
    <li><a class="dropdown-item" href="../articles/constrained-linear-phenotypic-selection-indices.html">Constrained Linear Phenotypic Selection Indices</a></li>
    <li><a class="dropdown-item" href="../articles/Examples.html">Data Analysis with selection.index</a></li>
    <li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started with selection.index</a></li>
    <li><a class="dropdown-item" href="../articles/linear-genomic-eigen-selection-index-methods.html">Linear Genomic Eigen Selection Index Methods</a></li>
    <li><a class="dropdown-item" href="../articles/linear-genomic-selection-indices.html">Linear Genomic Selection Indices</a></li>
    <li><a class="dropdown-item" href="../articles/linear-marker-selection-indices.html">Linear Marker and Genome-Wide Selection Indices</a></li>
    <li><a class="dropdown-item" href="../articles/linear-phenotypic-eigen-selection-index-methods.html">Linear Phenotypic Eigen Selection Index Methods</a></li>
    <li><a class="dropdown-item" href="../articles/linear-phenotypic-selection-index.html">The Linear Phenotypic Selection Index Theory</a></li>
    <li><a class="dropdown-item" href="../articles/multistage-linear-selection-indices.html">Multistage Phenotypic Selection Indices</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/zankrut20/selection.index/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Data Analysis with selection.index</h1>
                        <h4 data-toc-skip class="author">Zankrut
Goyani</h4>
            
            <h4 data-toc-skip class="date">2026-02-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/zankrut20/selection.index/blob/feature/cpp-backend/vignettes/Examples.Rmd" class="external-link"><code>vignettes/Examples.Rmd</code></a></small>
      <div class="d-none name"><code>Examples.Rmd</code></div>
    </div>

    
    
<p>The aim of most plant breeding program is simultaneous improvement of
several characters. An objective method involving simultaneous selection
for several attributes then becomes necessary. It has been recognized
that most rapid improvements in the economic value is expected from
selection applied simultaneously to all the characters which determine
the economic value of a plant, and appropriate assigned weights to each
character according to their economic importance, heritability and
correlations between characters. So the selection for economic value is
a complex matter. If the component characters are combined together into
an index in such a way that when selection is applied to the index, as
if index is the character to be improved, most rapid improvement of
economic value is excepted. Such an index was first proposed by Smith
(1937) based on the Fisher’s (1936) “discriminant function”. In this
package selection index is calculated based on the Smith (1937)
selection index method (Dabholkar, 1999). For more information refer
<strong>Elements of Bio Metrical GENETICS by A. R.
Dabholkar.</strong></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/zankrut20/selection.index" class="external-link">selection.index</a></span><span class="op">)</span></span>
<span><span class="va">d</span><span class="op">&lt;-</span> <span class="va">seldata</span> <span class="co"># Manually generated data for analysis which is included in package</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">w</span><span class="op">&lt;-</span> <span class="va">weight</span> <span class="co"># Weights assigned to the traits also include in package</span></span></code></pre></div>
<p>As we discussed that selection index based on discriminant function.
So we have required <strong>genotypic &amp; phenotypic
variance-covariance matrix</strong> for further analysis.</p>
<ul>
<li>Genotypic variance-covariance matrix</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gmat</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_varcov.html">gen_varcov</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">d</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>, genotypes <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">treat</span>, replication <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">rep</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gmat</span><span class="op">)</span></span>
<span><span class="co">#&gt;            sypp         dtf          rpp          ppr         ppp          spp</span></span>
<span><span class="co">#&gt; sypp 1.25660210  0.32936305  0.158785900  0.242981986  0.73499020  0.127571993</span></span>
<span><span class="co">#&gt; dtf  0.32936305  1.56017847  0.173388420 -0.312908175 -0.23310004  0.116790239</span></span>
<span><span class="co">#&gt; rpp  0.15878590  0.17338842  0.132484364 -0.031596521  0.32014873 -0.008643769</span></span>
<span><span class="co">#&gt; ppr  0.24298199 -0.31290818 -0.031596521  0.243231727  0.30192365 -0.020860985</span></span>
<span><span class="co">#&gt; ppp  0.73499020 -0.23310004  0.320148725  0.301923650  0.96076644 -0.069172364</span></span>
<span><span class="co">#&gt; spp  0.12757199  0.11679024 -0.008643769 -0.020860985 -0.06917236  0.017410958</span></span>
<span><span class="co">#&gt; pw   0.09261588  0.03298807 -0.012353519  0.007352443 -0.05824420  0.008560105</span></span>
<span><span class="co">#&gt;                pw</span></span>
<span><span class="co">#&gt; sypp  0.092615879</span></span>
<span><span class="co">#&gt; dtf   0.032988075</span></span>
<span><span class="co">#&gt; rpp  -0.012353519</span></span>
<span><span class="co">#&gt; ppr   0.007352443</span></span>
<span><span class="co">#&gt; ppp  -0.058244197</span></span>
<span><span class="co">#&gt; spp   0.008560105</span></span>
<span><span class="co">#&gt; pw    0.010304709</span></span></code></pre></div>
<ul>
<li>Phenotypic variance-covariance matrix</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pmat</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/phen_varcov.html">phen_varcov</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">d</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>, genotypes <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">treat</span>, replication <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">rep</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pmat</span><span class="op">)</span></span>
<span><span class="co">#&gt;           sypp         dtf          rpp         ppr        ppp          spp</span></span>
<span><span class="co">#&gt; sypp 4.6596932  0.81327830  0.549544688  0.76208582  2.5500613  0.401129893</span></span>
<span><span class="co">#&gt; dtf  0.8132783  6.95753031  0.478114232 -1.05398088 -0.9364611  0.292048297</span></span>
<span><span class="co">#&gt; rpp  0.5495447  0.47811423  0.492447900 -0.10364377  1.1038273 -0.007695489</span></span>
<span><span class="co">#&gt; ppr  0.7620858 -1.05398088 -0.103643767  0.95426114  0.9969895 -0.062186773</span></span>
<span><span class="co">#&gt; ppp  2.5500613 -0.93646109  1.103827327  0.99698955  6.1852816 -0.075103699</span></span>
<span><span class="co">#&gt; spp  0.4011299  0.29204830 -0.007695489 -0.06218677 -0.0751037  0.118394770</span></span>
<span><span class="co">#&gt; pw   0.2727074  0.04678408 -0.025308347  0.02107724 -0.1410159  0.043030640</span></span>
<span><span class="co">#&gt;               pw</span></span>
<span><span class="co">#&gt; sypp  0.27270744</span></span>
<span><span class="co">#&gt; dtf   0.04678408</span></span>
<span><span class="co">#&gt; rpp  -0.02530835</span></span>
<span><span class="co">#&gt; ppr   0.02107724</span></span>
<span><span class="co">#&gt; ppp  -0.14101586</span></span>
<span><span class="co">#&gt; spp   0.04303064</span></span>
<span><span class="co">#&gt; pw    0.04321272</span></span></code></pre></div>
<p>Generally, <strong>Percent Relative Efficiency (PRE)</strong> of a
selection index is calculated with reference to <strong>Genetic Advance
(GA) yield</strong> of respective weight. So first we calculate the GA
of yield for respective weights. + Genetic gain of Yield</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">GAY</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_advance.html">gen_advance</a></span><span class="op">(</span>phen_mat <span class="op">=</span> <span class="va">pmat</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span>, gen_mat <span class="op">=</span> <span class="va">gmat</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>                  weight_mat <span class="op">=</span> <span class="va">w</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">GAY</span><span class="op">)</span></span>
<span><span class="co">#&gt;        [,1]</span></span>
<span><span class="co">#&gt; [1,] 1.2009</span></span></code></pre></div>
<p>We use this GAY value for the construction, ranking of the other
selection indices and stored them in a list “si”.</p>
<div class="section level2">
<h2 id="selection-score-and-ranking-of-genotypes">Selection score and Ranking of genotypes<a class="anchor" aria-label="anchor" href="#selection-score-and-ranking-of-genotypes"></a>
</h2>
<p>Generally selection score is calculate based on top ranked selection
index. So first we store the <strong>discriminant coefficient</strong>
value into a variable <strong>b</strong>, and later that value we used
for calculation of selection score and ranking of the genotypes.</p>
</div>
<div class="section level2">
<h2 id="lpsi-is-used-for-construction-of-selection-indices-based-on-different-combination-of-characters-">
<code>lpsi()</code> is used for construction of selection indices
based on different combination of characters.<a class="anchor" aria-label="anchor" href="#lpsi-is-used-for-construction-of-selection-indices-based-on-different-combination-of-characters-"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lpsi.html">lpsi</a></span><span class="op">(</span>ncomb <span class="op">=</span> <span class="fl">1</span>, pmat <span class="op">=</span> <span class="va">pmat</span>, gmat <span class="op">=</span> <span class="va">gmat</span>, wmat <span class="op">=</span> <span class="va">w</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, wcol <span class="op">=</span> <span class="fl">1</span>, GAY <span class="op">=</span> <span class="va">GAY</span><span class="op">)</span></span>
<span><span class="co">#&gt;   ID    b.1     GA      PRE Delta_G    rHI    hI2 Rank</span></span>
<span><span class="co">#&gt; 1  1 0.6316 2.8125 234.2021  2.8125 0.4825 0.2697    1</span></span>
<span><span class="co">#&gt; 2  2 0.2396 1.3036 108.5481  1.3036 0.2237 0.2242    4</span></span>
<span><span class="co">#&gt; 3  3 1.4869 2.1526 179.2462  2.1526 0.3693 0.2690    2</span></span>
<span><span class="co">#&gt; 4  4 0.4507 0.9084  75.6402  0.9084 0.1558 0.2549    6</span></span>
<span><span class="co">#&gt; 5  5 0.3164 1.6236 135.1988  1.6236 0.2786 0.1553    3</span></span>
<span><span class="co">#&gt; 6  6 1.4499 1.0292  85.7009  1.0292 0.1766 0.1471    5</span></span>
<span><span class="co">#&gt; 7  7 1.8796 0.8061  67.1225  0.8061 0.1383 0.2385    7</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="using-excluding_trait-parameter-to-remove-traits-from-the-construction-of-selection-indices">Using <code>excluding_trait</code> parameter to remove traits from
the construction of selection indices<a class="anchor" aria-label="anchor" href="#using-excluding_trait-parameter-to-remove-traits-from-the-construction-of-selection-indices"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lpsi.html">lpsi</a></span><span class="op">(</span>ncomb <span class="op">=</span> <span class="fl">1</span>, pmat <span class="op">=</span> <span class="va">pmat</span>, gmat <span class="op">=</span> <span class="va">gmat</span>, wmat <span class="op">=</span> <span class="va">w</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, wcol <span class="op">=</span> <span class="fl">1</span>, GAY <span class="op">=</span> <span class="va">GAY</span>, excluding_trait <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt;   ID    b.1     GA      PRE Delta_G    rHI    hI2 Rank</span></span>
<span><span class="co">#&gt; 1  2 0.2396 1.3036 108.5481  1.3036 0.2237 0.2242    3</span></span>
<span><span class="co">#&gt; 2  3 1.4869 2.1526 179.2462  2.1526 0.3693 0.2690    1</span></span>
<span><span class="co">#&gt; 3  4 0.4507 0.9084  75.6402  0.9084 0.1558 0.2549    5</span></span>
<span><span class="co">#&gt; 4  5 0.3164 1.6236 135.1988  1.6236 0.2786 0.1553    2</span></span>
<span><span class="co">#&gt; 5  6 1.4499 1.0292  85.7009  1.0292 0.1766 0.1471    4</span></span>
<span><span class="co">#&gt; 6  7 1.8796 0.8061  67.1225  0.8061 0.1383 0.2385    6</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="genomic-selection-workflows">Genomic Selection Workflows<a class="anchor" aria-label="anchor" href="#genomic-selection-workflows"></a>
</h2>
<p>Modern plant breeding increasingly relies on genomic prediction to
estimate breeding values from molecular markers. The package provides
specialized functions for computing genomic variance-covariance matrices
used in genomic selection indices.</p>
<div class="section level3">
<h3 id="genomic-variance-covariance-matrix-γ">Genomic Variance-Covariance Matrix (Γ)<a class="anchor" aria-label="anchor" href="#genomic-variance-covariance-matrix-%CE%B3"></a>
</h3>
<p>The <code><a href="../reference/genomic_varcov.html">genomic_varcov()</a></code> function computes the genomic
variance-covariance matrix from Genomic Estimated Breeding Values
(GEBVs):</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate GEBVs from genomic prediction</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">n_genotypes</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">n_traits</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">gebv_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_genotypes</span> <span class="op">*</span> <span class="va">n_traits</span><span class="op">)</span>, </span>
<span>                   nrow <span class="op">=</span> <span class="va">n_genotypes</span>, ncol <span class="op">=</span> <span class="va">n_traits</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">gebv_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Trait"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n_traits</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute genomic variance-covariance matrix</span></span>
<span><span class="va">Gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/genomic_varcov.html">genomic_varcov</a></span><span class="op">(</span><span class="va">gebv_mat</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">Gamma</span><span class="op">)</span></span></code></pre></div>
<p><strong>Handling Missing Values in GEBVs:</strong></p>
<p>When genomic predictions contain missing values, specify the
<code>use</code> parameter:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use complete observations only (recommended)</span></span>
<span><span class="va">Gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/genomic_varcov.html">genomic_varcov</a></span><span class="op">(</span><span class="va">gebv_mat</span>, use <span class="op">=</span> <span class="st">"complete.obs"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Pairwise deletion (may not be PSD - use with caution)</span></span>
<span><span class="va">Gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/genomic_varcov.html">genomic_varcov</a></span><span class="op">(</span><span class="va">gebv_mat</span>, use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Important:</strong> Pairwise deletion can produce matrices
that are not positive semi-definite (PSD), which may cause numerical
issues in selection index calculations. Use <code>complete.obs</code>
when possible.</p>
</div>
<div class="section level3">
<h3 id="phenomic-genomic-covariance-matrix-φ">Phenomic-Genomic Covariance Matrix (Φ)<a class="anchor" aria-label="anchor" href="#phenomic-genomic-covariance-matrix-%CF%86"></a>
</h3>
<p>The <code><a href="../reference/phenomic_genomic_varcov.html">phenomic_genomic_varcov()</a></code> function computes the
covariance between phenotypic observations and GEBVs:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute phenomic-genomic covariance</span></span>
<span><span class="va">Phi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phenomic_genomic_varcov.html">phenomic_genomic_varcov</a></span><span class="op">(</span>pheno_mat <span class="op">=</span> <span class="va">d</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>, </span>
<span>                                gebv_mat <span class="op">=</span> <span class="va">gebv_mat</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">Phi</span><span class="op">)</span></span></code></pre></div>
<p>This matrix is used in selection indices that combine phenotypic and
genomic information.</p>
</div>
<div class="section level3">
<h3 id="genetic-genomic-covariance-matrix-a">Genetic-Genomic Covariance Matrix (A)<a class="anchor" aria-label="anchor" href="#genetic-genomic-covariance-matrix-a"></a>
</h3>
<p>The <code><a href="../reference/genetic_genomic_varcov.html">genetic_genomic_varcov()</a></code> function computes the
covariance between genetic values (estimated from field trials) and
GEBVs:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute genetic-genomic covariance</span></span>
<span><span class="va">A_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/genetic_genomic_varcov.html">genetic_genomic_varcov</a></span><span class="op">(</span>gv_mat <span class="op">=</span> <span class="va">gmat</span>,  <span class="co"># genetic values</span></span>
<span>                                 gebv_mat <span class="op">=</span> <span class="va">gebv_mat</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">A_mat</span><span class="op">)</span></span></code></pre></div>
<p><strong>Applications in Genomic Selection Indices:</strong></p>
<ul>
<li>
<strong>LGSI (Linear Genomic Selection Index):</strong> Uses Γ
(genomic variance)</li>
<li>
<strong>Combined Indices:</strong> Use Φ (phenomic-genomic
covariance) and A (genetic-genomic covariance)</li>
<li>
<strong>Multi-environment:</strong> Combine field trial covariances
with genomic predictions</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="missing-value-imputation">Missing Value Imputation<a class="anchor" aria-label="anchor" href="#missing-value-imputation"></a>
</h2>
<p>Field trials often contain missing observations due to experimental
errors, pest damage, or environmental stress. The
<code><a href="../reference/estimate_missing_values.html">estimate_missing_values()</a></code> function estimates missing values
using the experimental design structure.</p>
<div class="section level3">
<h3 id="basic-usage">Basic Usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create data with missing values</span></span>
<span><span class="va">d_missing</span> <span class="op">&lt;-</span> <span class="va">d</span></span>
<span><span class="va">d_missing</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">12</span>, <span class="fl">20</span><span class="op">)</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span>  <span class="co"># Add missing values to first trait</span></span>
<span></span>
<span><span class="co"># Impute missing values</span></span>
<span><span class="va">d_complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_missing_values.html">estimate_missing_values</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">d_missing</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>, </span>
<span>                              genotypes <span class="op">=</span> <span class="va">d_missing</span><span class="op">$</span><span class="va">treat</span>,</span>
<span>                              replications <span class="op">=</span> <span class="va">d_missing</span><span class="op">$</span><span class="va">rep</span>,</span>
<span>                              design <span class="op">=</span> <span class="st">"RCBD"</span>,</span>
<span>                              method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check: no missing values remain</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">d_complete</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="method-selection-guide">Method Selection Guide<a class="anchor" aria-label="anchor" href="#method-selection-guide"></a>
</h3>
<p>Six imputation methods are available, with different strengths:</p>
<table class="table">
<thead><tr class="header">
<th>Method</th>
<th>Speed</th>
<th>Accuracy</th>
<th>Missing Pattern</th>
<th>Design Support</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>REML</strong></td>
<td>Slow</td>
<td>Highest</td>
<td>Complex</td>
<td>RCBD, LSD</td>
</tr>
<tr class="even">
<td><strong>Yates</strong></td>
<td>Fast</td>
<td>High</td>
<td>Simple</td>
<td>RCBD, LSD</td>
</tr>
<tr class="odd">
<td><strong>Healy</strong></td>
<td>Medium</td>
<td>High</td>
<td>Multiple per block</td>
<td>RCBD, LSD</td>
</tr>
<tr class="even">
<td><strong>Regression</strong></td>
<td>Fast</td>
<td>High</td>
<td>Any</td>
<td>RCBD, LSD</td>
</tr>
<tr class="odd">
<td><strong>Mean</strong></td>
<td>Fastest</td>
<td>Medium</td>
<td>Any</td>
<td>RCBD, LSD, SPD</td>
</tr>
<tr class="even">
<td><strong>Bartlett</strong></td>
<td>Medium</td>
<td>Highest*</td>
<td>Any</td>
<td>RCBD, LSD</td>
</tr>
</tbody>
</table>
<p>*When traits are correlated</p>
<p><strong>Recommendations:</strong></p>
<ul>
<li>
<strong>REML:</strong> Best for complex missing patterns or when
precision is critical</li>
<li>
<strong>Yates:</strong> Simple, fast, good for few missing values in
balanced designs</li>
<li>
<strong>Healy:</strong> More stable than Yates when multiple values
missing</li>
<li>
<strong>Regression:</strong> Fast and deterministic, good
general-purpose choice</li>
<li>
<strong>Mean:</strong> Quick estimation when precision less
critical</li>
<li>
<strong>Bartlett:</strong> Use when traits are highly correlated
(leverages trait relationships)</li>
</ul>
</div>
<div class="section level3">
<h3 id="design-specific-usage">Design-Specific Usage<a class="anchor" aria-label="anchor" href="#design-specific-usage"></a>
</h3>
<p><strong>Latin Square Design:</strong></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_missing_values.html">estimate_missing_values</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">d_missing</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>,</span>
<span>                              genotypes <span class="op">=</span> <span class="va">d_missing</span><span class="op">$</span><span class="va">treat</span>,</span>
<span>                              replications <span class="op">=</span> <span class="va">d_missing</span><span class="op">$</span><span class="va">row</span>,  <span class="co"># row indices</span></span>
<span>                              columns <span class="op">=</span> <span class="va">d_missing</span><span class="op">$</span><span class="va">col</span>,       <span class="co"># column indices</span></span>
<span>                              design <span class="op">=</span> <span class="st">"LSD"</span>,</span>
<span>                              method <span class="op">=</span> <span class="st">"Healy"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Split Plot Design:</strong></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_missing_values.html">estimate_missing_values</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">d_missing</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>,</span>
<span>                              genotypes <span class="op">=</span> <span class="va">d_missing</span><span class="op">$</span><span class="va">subplot</span>,    <span class="co"># sub-plot treatments</span></span>
<span>                              replications <span class="op">=</span> <span class="va">d_missing</span><span class="op">$</span><span class="va">block</span>,</span>
<span>                              main_plots <span class="op">=</span> <span class="va">d_missing</span><span class="op">$</span><span class="va">mainplot</span>,  <span class="co"># main plot treatments</span></span>
<span>                              design <span class="op">=</span> <span class="st">"SPD"</span>,</span>
<span>                              method <span class="op">=</span> <span class="st">"Mean"</span><span class="op">)</span>  <span class="co"># Only Mean available for SPD</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="workflow-integration">Workflow Integration<a class="anchor" aria-label="anchor" href="#workflow-integration"></a>
</h3>
<p>After imputation, proceed with variance-covariance analysis:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Impute missing values</span></span>
<span><span class="va">d_complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_missing_values.html">estimate_missing_values</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">d</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>,</span>
<span>                              genotypes <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">treat</span>,</span>
<span>                              replications <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">rep</span>,</span>
<span>                              design <span class="op">=</span> <span class="st">"RCBD"</span>,</span>
<span>                              method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. Compute variance-covariance matrices</span></span>
<span><span class="va">gmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_varcov.html">gen_varcov</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">d_complete</span>, </span>
<span>                   genotypes <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">treat</span>, </span>
<span>                   replication <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">rep</span><span class="op">)</span></span>
<span>                   </span>
<span><span class="va">pmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phen_varcov.html">phen_varcov</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">d_complete</span>,</span>
<span>                    genotypes <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">treat</span>,</span>
<span>                    replication <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">rep</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. Construct selection indices</span></span>
<span><span class="va">GAY</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_advance.html">gen_advance</a></span><span class="op">(</span>phen_mat <span class="op">=</span> <span class="va">pmat</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span>, gen_mat <span class="op">=</span> <span class="va">gmat</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>                   weight_mat <span class="op">=</span> <span class="va">w</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>                   </span>
<span><span class="fu"><a href="../reference/lpsi.html">lpsi</a></span><span class="op">(</span>ncomb <span class="op">=</span> <span class="fl">1</span>, pmat <span class="op">=</span> <span class="va">pmat</span>, gmat <span class="op">=</span> <span class="va">gmat</span>, wmat <span class="op">=</span> <span class="va">w</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>     wcol <span class="op">=</span> <span class="fl">1</span>, GAY <span class="op">=</span> <span class="va">GAY</span><span class="op">)</span></span></code></pre></div>
<p><strong>Best Practices:</strong></p>
<ol style="list-style-type: decimal">
<li>
<strong>Examine missing patterns</strong> before imputation -
understanding why data are missing helps choose appropriate methods</li>
<li>
<strong>Use REML or Healy</strong> for complex or extensive
missingness</li>
<li>
<strong>Document imputation method</strong> in analysis reports</li>
<li>
<strong>Consider multiple imputation</strong> for high proportions
of missing data (&gt;20%)</li>
<li>
<strong>Adjust degrees of freedom</strong> in final analysis to
account for imputed values</li>
</ol>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zankrut Goyani.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
