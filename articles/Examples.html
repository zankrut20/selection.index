<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Data Analysis with selection.index • selection.index</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Data Analysis with selection.index">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">selection.index</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Examples.html">Data Analysis with selection.index</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/zankrut20/selection.index/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Data Analysis with selection.index</h1>
                        <h4 data-toc-skip class="author">Zankrut
Goyani</h4>
            
            <h4 data-toc-skip class="date">2026-02-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/zankrut20/selection.index/blob/feature/cpp-backend/vignettes/Examples.Rmd" class="external-link"><code>vignettes/Examples.Rmd</code></a></small>
      <div class="d-none name"><code>Examples.Rmd</code></div>
    </div>

    
    
<p>The aim of most plant breeding program is simultaneous improvement of
several characters. An objective method involving simultaneous selection
for several attributes then becomes necessary. It has been recognized
that most rapid improvements in the economic value is expected from
selection applied simultaneously to all the characters which determine
the economic value of a plant, and appropriate assigned weights to each
character according to their economic importance, heritability and
correlations between characters. So the selection for economic value is
a complex matter. If the component characters are combined together into
an index in such a way that when selection is applied to the index, as
if index is the character to be improved, most rapid improvement of
economic value is excepted. Such an index was first proposed by Smith
(1937) based on the Fisher’s (1936) “discriminant function”. In this
package selection index is calculated based on the Smith (1937)
selection index method (Dabholkar, 1999). For more information refer
<strong>Elements of Bio Metrical GENETICS by A. R.
Dabholkar.</strong></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/zankrut20/selection.index" class="external-link">selection.index</a></span><span class="op">)</span></span>
<span><span class="va">d</span><span class="op">&lt;-</span> <span class="va">seldata</span> <span class="co"># Manually generated data for analysis which is included in package</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">w</span><span class="op">&lt;-</span> <span class="va">weight</span> <span class="co"># Weights assigned to the traits also include in package</span></span></code></pre></div>
<p>As we discussed that selection index based on discriminant function.
So we have required <strong>genotypic &amp; phenotypic
variance-covariance matrix</strong> for further analysis.</p>
<ul>
<li>Genotypic variance-covariance matrix</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gmat</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_varcov.html">gen_varcov</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">d</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>, genotypes <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">treat</span>, replication <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">rep</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gmat</span><span class="op">)</span></span>
<span><span class="co">#&gt;            sypp         dtf          rpp          ppr         ppp          spp</span></span>
<span><span class="co">#&gt; sypp 1.25660210  0.32936305  0.158785900  0.242981986  0.73499020  0.127571993</span></span>
<span><span class="co">#&gt; dtf  0.32936305  1.56017847  0.173388420 -0.312908175 -0.23310004  0.116790239</span></span>
<span><span class="co">#&gt; rpp  0.15878590  0.17338842  0.132484364 -0.031596521  0.32014873 -0.008643769</span></span>
<span><span class="co">#&gt; ppr  0.24298199 -0.31290818 -0.031596521  0.243231727  0.30192365 -0.020860985</span></span>
<span><span class="co">#&gt; ppp  0.73499020 -0.23310004  0.320148725  0.301923650  0.96076644 -0.069172364</span></span>
<span><span class="co">#&gt; spp  0.12757199  0.11679024 -0.008643769 -0.020860985 -0.06917236  0.017410958</span></span>
<span><span class="co">#&gt; pw   0.09261588  0.03298807 -0.012353519  0.007352443 -0.05824420  0.008560105</span></span>
<span><span class="co">#&gt;                pw</span></span>
<span><span class="co">#&gt; sypp  0.092615879</span></span>
<span><span class="co">#&gt; dtf   0.032988075</span></span>
<span><span class="co">#&gt; rpp  -0.012353519</span></span>
<span><span class="co">#&gt; ppr   0.007352443</span></span>
<span><span class="co">#&gt; ppp  -0.058244197</span></span>
<span><span class="co">#&gt; spp   0.008560105</span></span>
<span><span class="co">#&gt; pw    0.010304709</span></span></code></pre></div>
<ul>
<li>Phenotypic variance-covariance matrix</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pmat</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/phen_varcov.html">phen_varcov</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">d</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>, genotypes <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">treat</span>, replication <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">rep</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pmat</span><span class="op">)</span></span>
<span><span class="co">#&gt;           sypp         dtf          rpp         ppr        ppp          spp</span></span>
<span><span class="co">#&gt; sypp 4.6596932  0.81327830  0.549544688  0.76208582  2.5500613  0.401129893</span></span>
<span><span class="co">#&gt; dtf  0.8132783  6.95753031  0.478114232 -1.05398088 -0.9364611  0.292048297</span></span>
<span><span class="co">#&gt; rpp  0.5495447  0.47811423  0.492447900 -0.10364377  1.1038273 -0.007695489</span></span>
<span><span class="co">#&gt; ppr  0.7620858 -1.05398088 -0.103643767  0.95426114  0.9969895 -0.062186773</span></span>
<span><span class="co">#&gt; ppp  2.5500613 -0.93646109  1.103827327  0.99698955  6.1852816 -0.075103699</span></span>
<span><span class="co">#&gt; spp  0.4011299  0.29204830 -0.007695489 -0.06218677 -0.0751037  0.118394770</span></span>
<span><span class="co">#&gt; pw   0.2727074  0.04678408 -0.025308347  0.02107724 -0.1410159  0.043030640</span></span>
<span><span class="co">#&gt;               pw</span></span>
<span><span class="co">#&gt; sypp  0.27270744</span></span>
<span><span class="co">#&gt; dtf   0.04678408</span></span>
<span><span class="co">#&gt; rpp  -0.02530835</span></span>
<span><span class="co">#&gt; ppr   0.02107724</span></span>
<span><span class="co">#&gt; ppp  -0.14101586</span></span>
<span><span class="co">#&gt; spp   0.04303064</span></span>
<span><span class="co">#&gt; pw    0.04321272</span></span></code></pre></div>
<p>Generally, <strong>Percent Relative Efficiency (PRE)</strong> of a
selection index is calculated with reference to <strong>Genetic Advance
(GA) yield</strong> of respective weight. So first we calculate the GA
of yield for respective weights. + Genetic gain of Yield</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">GAY</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_advance.html">gen_advance</a></span><span class="op">(</span>phen_mat <span class="op">=</span> <span class="va">pmat</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span>, gen_mat <span class="op">=</span> <span class="va">gmat</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>                  weight_mat <span class="op">=</span> <span class="va">w</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">GAY</span><span class="op">)</span></span>
<span><span class="co">#&gt;        [,1]</span></span>
<span><span class="co">#&gt; [1,] 1.2009</span></span></code></pre></div>
<p>We use this GAY value for the construction, ranking of the other
selection indices and stored them in a list “si”.</p>
<div class="section level2">
<h2 id="selection-score-and-ranking-of-genotypes">Selection score and Ranking of genotypes<a class="anchor" aria-label="anchor" href="#selection-score-and-ranking-of-genotypes"></a>
</h2>
<p>Generally selection score is calculate based on top ranked selection
index. So first we store the <strong>discriminant coefficient</strong>
value into a variable <strong>b</strong>, and later that value we used
for calculation of selection score and ranking of the genotypes.</p>
</div>
<div class="section level2">
<h2 id="lpsi-is-used-for-construction-of-selection-indices-based-on-different-combination-of-characters-">
<code>lpsi()</code> is used for construction of selection indices
based on different combination of characters.<a class="anchor" aria-label="anchor" href="#lpsi-is-used-for-construction-of-selection-indices-based-on-different-combination-of-characters-"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lpsi.html">lpsi</a></span><span class="op">(</span>ncomb <span class="op">=</span> <span class="fl">1</span>, pmat <span class="op">=</span> <span class="va">pmat</span>, gmat <span class="op">=</span> <span class="va">gmat</span>, wmat <span class="op">=</span> <span class="va">w</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, wcol <span class="op">=</span> <span class="fl">1</span>, GAY <span class="op">=</span> <span class="va">GAY</span><span class="op">)</span></span>
<span><span class="co">#&gt;   ID    b.1     GA      PRE Delta_G    rHI    hI2 Rank</span></span>
<span><span class="co">#&gt; 1  1 0.2697 1.2009 100.0026  1.2009 0.5193 0.2697    2</span></span>
<span><span class="co">#&gt; 2  2 0.2242 1.2202 101.6106  1.2202 0.4735 0.2242    1</span></span>
<span><span class="co">#&gt; 3  3 0.2690 0.3895  32.4322  0.3895 0.5187 0.2690    5</span></span>
<span><span class="co">#&gt; 4  4 0.2549 0.5137  42.7739  0.5137 0.5049 0.2549    4</span></span>
<span><span class="co">#&gt; 5  5 0.1553 0.7970  66.3637  0.7970 0.3941 0.1553    3</span></span>
<span><span class="co">#&gt; 6  6 0.1471 0.1044   8.6926  0.1044 0.3835 0.1471    6</span></span>
<span><span class="co">#&gt; 7  7 0.2385 0.1023   8.5157  0.1023 0.4883 0.2385    7</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="using-excluding_trait-parameter-to-remove-traits-from-the-construction-of-selection-indices">Using <code>excluding_trait</code> parameter to remove traits from
the construction of selection indices<a class="anchor" aria-label="anchor" href="#using-excluding_trait-parameter-to-remove-traits-from-the-construction-of-selection-indices"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/lpsi.html">lpsi</a></span><span class="op">(</span>ncomb <span class="op">=</span> <span class="fl">1</span>, pmat <span class="op">=</span> <span class="va">pmat</span>, gmat <span class="op">=</span> <span class="va">gmat</span>, wmat <span class="op">=</span> <span class="va">w</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, wcol <span class="op">=</span> <span class="fl">1</span>, GAY <span class="op">=</span> <span class="va">GAY</span>, excluding_trait <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt;   ID    b.1     GA      PRE Delta_G    rHI    hI2 Rank</span></span>
<span><span class="co">#&gt; 1  2 0.2242 1.2202 101.6106  1.2202 0.4735 0.2242    1</span></span>
<span><span class="co">#&gt; 2  3 0.2690 0.3895  32.4322  0.3895 0.5187 0.2690    4</span></span>
<span><span class="co">#&gt; 3  4 0.2549 0.5137  42.7739  0.5137 0.5049 0.2549    3</span></span>
<span><span class="co">#&gt; 4  5 0.1553 0.7970  66.3637  0.7970 0.3941 0.1553    2</span></span>
<span><span class="co">#&gt; 5  6 0.1471 0.1044   8.6926  0.1044 0.3835 0.1471    5</span></span>
<span><span class="co">#&gt; 6  7 0.2385 0.1023   8.5157  0.1023 0.4883 0.2385    6</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zankrut Goyani.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
