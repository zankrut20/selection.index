<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Constrained Linear Phenotypic Selection Indices â€¢ selection.index</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="Constrained Linear Phenotypic Selection Indices">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">selection.index</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started with selection.index</a></li>
    <li><a class="dropdown-item" href="../articles/linear-phenotypic-selection-index.html">The Linear Phenotypic Selection Index Theory</a></li>
    <li><a class="dropdown-item" href="../articles/constrained-linear-phenotypic-selection-indices.html">Constrained Linear Phenotypic Selection Indices</a></li>
    <li><a class="dropdown-item" href="../articles/linear-marker-selection-indices.html">Linear Marker and Genome-Wide Selection Indices</a></li>
    <li><a class="dropdown-item" href="../articles/linear-genomic-selection-indices.html">Linear Genomic Selection Indices</a></li>
    <li><a class="dropdown-item" href="../articles/constrained-linear-genomic-selection-indices.html">Constrained Linear Genomic Selection Indices</a></li>
    <li><a class="dropdown-item" href="../articles/linear-phenotypic-eigen-selection-index-methods.html">Linear Phenotypic Eigen Selection Index Methods</a></li>
    <li><a class="dropdown-item" href="../articles/linear-genomic-eigen-selection-index-methods.html">Linear Genomic Eigen Selection Index Methods</a></li>
    <li><a class="dropdown-item" href="../articles/multistage-linear-selection-indices.html">Multistage Phenotypic Selection Indices</a></li>
    <li><a class="dropdown-item" href="../articles/stochastic-simulation-linear-phenotypic-indices.html">Stochastic Simulation of Linear Phenotypic Selection Indices</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/zankrut20/selection.index/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Constrained Linear Phenotypic Selection Indices</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/zankrut20/selection.index/blob/feature/cpp-backend/vignettes/constrained-linear-phenotypic-selection-indices.Rmd" class="external-link"><code>vignettes/constrained-linear-phenotypic-selection-indices.Rmd</code></a></small>
      <div class="d-none name"><code>constrained-linear-phenotypic-selection-indices.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The linear phenotypic selection index (LPSI), the null restricted
LPSI (RLPSI), and the predetermined proportional gains LPSI (PPG-LPSI)
are the main phenotypic selection indices used to predict the net
genetic merit and select parents for the next selection cycle. The LPSI
is an unrestricted index, whereas the RLPSI and the PPG-LPSI allow
restrictions equal to zero and predetermined proportional gain
restrictions respectively to be imposed on the expected genetic gain
values of the trait.</p>
<p>One additional restricted index is the desired gains LPSI (DG-LPSI),
which does not require economic weights and, in a similar manner to the
PPG-LPSI, allows restrictions to be imposed on the expected genetic gain
values of the trait based on a predetermined level.</p>
<p>In this vignette, we demonstrate the theory and practical application
of RLPSI, PPG-LPSI, and DG-LPSI using the <code>selection.index</code>
package.</p>
<div class="section level3">
<h3 id="sample-data-preparation">Sample Data Preparation<a class="anchor" aria-label="anchor" href="#sample-data-preparation"></a>
</h3>
<p>We use the synthetic <code>maize_pheno</code> dataset built into the
package to calculate the phenotypic and genotypic variance-covariance
matrices.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/zankrut20/selection.index" class="external-link">selection.index</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the built-in maize phenotype dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"maize_pheno"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract the traits of interest</span></span>
<span><span class="va">traits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Yield"</span>, <span class="st">"PlantHeight"</span>, <span class="st">"DaysToMaturity"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate Genotypic (gmat) and Phenotypic (pmat) covariance matrices</span></span>
<span><span class="va">gmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_varcov.html">gen_varcov</a></span><span class="op">(</span><span class="va">maize_pheno</span><span class="op">[</span>, <span class="va">traits</span><span class="op">]</span>, <span class="va">maize_pheno</span><span class="op">$</span><span class="va">Genotype</span>, <span class="va">maize_pheno</span><span class="op">$</span><span class="va">Block</span><span class="op">)</span></span>
<span><span class="va">pmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phen_varcov.html">phen_varcov</a></span><span class="op">(</span><span class="va">maize_pheno</span><span class="op">[</span>, <span class="va">traits</span><span class="op">]</span>, <span class="va">maize_pheno</span><span class="op">$</span><span class="va">Genotype</span>, <span class="va">maize_pheno</span><span class="op">$</span><span class="va">Block</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define economic weights for the three traits</span></span>
<span><span class="va">wmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/weight_mat.html">weight_mat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Trait <span class="op">=</span> <span class="va">traits</span>, Weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="the-null-restricted-linear-phenotypic-selection-index-rlpsi">1. The Null Restricted Linear Phenotypic Selection Index
(RLPSI)<a class="anchor" aria-label="anchor" href="#the-null-restricted-linear-phenotypic-selection-index-rlpsi"></a>
</h2>
<p>The main objective of the RLPSI is to optimize, under some null
restrictions, the selection response, to predict the net genetic merit
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo><mi>ğ°</mi><mi>â€²</mi><mi>ğ </mi></mrow><annotation encoding="application/x-tex">H = \mathbf{w}'\mathbf{g}</annotation></semantics></math>,
and to select the individuals with the highest net genetic merit values
as parents of the next generation. The RLPSI allows restrictions equal
to zero to be imposed on the expected genetic gains of some traits.</p>
<p>Assuming we want to minimize the mean squared difference between the
index
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>I</mi><annotation encoding="application/x-tex">I</annotation></semantics></math>
and merit
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>H</mi><mo>âˆ’</mo><mi>I</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">E[(H - I)^2]</annotation></semantics></math>)
under the restriction
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ‚</mi><mi>â€²</mi><mi>ğ›</mi><mo>=</mo><mn>ğŸ</mn></mrow><annotation encoding="application/x-tex">\mathbf{C}'\mathbf{b} = \mathbf{0}</annotation></semantics></math>,
we minimize the following function:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¨</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›</mi><mo>,</mo><mi>ğ¯</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>ğ›</mi><mi>â€²</mi></msup><mrow><mi>ğ</mi><mi>ğ›</mi></mrow><mo>+</mo><msup><mi>ğ°</mi><mi>â€²</mi></msup><mrow><mi>ğ†</mi><mi>ğ°</mi></mrow><mo>âˆ’</mo><mn>2</mn><msup><mi>ğ°</mi><mi>â€²</mi></msup><mrow><mi>ğ†</mi><mi>ğ›</mi></mrow><mo>+</mo><mn>2</mn><msup><mi>ğ¯</mi><mi>â€²</mi></msup><msup><mi>ğ‚</mi><mi>â€²</mi></msup><mi>ğ›</mi></mrow><annotation encoding="application/x-tex"> \Psi \left(\mathbf{b},\mathbf{v}\right)={\mathbf{b}}^{\prime}\mathbf{Pb}+{\mathbf{w}}^{\prime}\mathbf{Gw}-2{\mathbf{w}}^{\prime}\mathbf{Gb}+2{\mathbf{v}}^{\prime }{\mathbf{C}}^{\prime}\mathbf{b} </annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ‚</mi><mi>â€²</mi><mo>=</mo><mi>ğ”</mi><mi>â€²</mi><mi>ğ†</mi></mrow><annotation encoding="application/x-tex">\mathbf{C}' = \mathbf{U}'\mathbf{G}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ”</mi><mi>â€²</mi></mrow><annotation encoding="application/x-tex">\mathbf{U}'</annotation></semantics></math>
is the matrix of null restrictions, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ¯</mi><annotation encoding="application/x-tex">\mathbf{v}</annotation></semantics></math>
is a vector of Lagrange multipliers. The solution yields the RLPSI
vector of coefficients:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ›</mi><mi>R</mi></msub><mo>=</mo><mrow><mi>ğŠ</mi><mi>ğ›</mi></mrow></mrow><annotation encoding="application/x-tex"> {\mathbf{b}}_R=\mathbf{Kb} </annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğŠ</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>ğˆ</mi><mo>âˆ’</mo><mi>ğ</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{K} = [\mathbf{I} - \mathbf{Q}]</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ</mi><mo>=</mo><msup><mi>ğ</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ‚</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ‚</mi><mi>â€²</mi><msup><mi>ğ</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ‚</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ‚</mi><mi>â€²</mi></mrow><annotation encoding="application/x-tex">\mathbf{Q} = \mathbf{P}^{-1}\mathbf{C}(\mathbf{C}'\mathbf{P}^{-1}\mathbf{C})^{-1}\mathbf{C}'</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ›</mi><mo>=</mo><msup><mi>ğ</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mrow><mi>ğ†</mi><mi>ğ°</mi></mrow></mrow><annotation encoding="application/x-tex">\mathbf{b} = \mathbf{P}^{-1}\mathbf{Gw}</annotation></semantics></math>
is the LPSI vector of coefficients.</p>
<div class="section level3">
<h3 id="practical-application-rlpsi">Practical Application: RLPSI<a class="anchor" aria-label="anchor" href="#practical-application-rlpsi"></a>
</h3>
<p>Using the <code>rlpsi</code> function, we can constrain the genetic
gain of certain traits to be strictly zero. For instance, we may want to
maximize overall gain while ensuring that Plant Height (trait #2) does
not change.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Restrict trait 2 (PHT) to have ZERO expected genetic gain</span></span>
<span><span class="va">rlpsi_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rlpsi.html">rlpsi</a></span><span class="op">(</span></span>
<span>  pmat <span class="op">=</span> <span class="va">pmat</span>,</span>
<span>  gmat <span class="op">=</span> <span class="va">gmat</span>,</span>
<span>  wmat <span class="op">=</span> <span class="va">wmat</span>,</span>
<span>  restricted_traits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the summary and coefficients</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">rlpsi_res</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span></span>
<span><span class="co">#&gt;      b.1     b.2    b.3       GA      PRE  Delta_G    rHI    hI2</span></span>
<span><span class="co">#&gt; 1 0.0551 -3.3075 2.1743 108.2417 10824.17 108.2417 0.3153 0.0994</span></span>
<span></span>
<span><span class="co"># View the expected genetic gains (Delta_G)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">rlpsi_res</span><span class="op">$</span><span class="va">Delta_G</span><span class="op">)</span></span>
<span><span class="co">#&gt;          Yield    PlantHeight DaysToMaturity </span></span>
<span><span class="co">#&gt;   1.059783e+02  -1.709497e-08   2.263426e+00</span></span></code></pre></div>
<p>Notice that the expected genetic gain (<code>Delta_G</code>) for the
2nd trait is effectively zero.</p>
</div>
</div>
<div class="section level2">
<h2 id="the-predetermined-proportional-gains-linear-phenotypic-selection-index-ppg-lpsi">2. The Predetermined Proportional Gains Linear Phenotypic Selection
Index (PPG-LPSI)<a class="anchor" aria-label="anchor" href="#the-predetermined-proportional-gains-linear-phenotypic-selection-index-ppg-lpsi"></a>
</h2>
<p>Unlike the RLPSI, the predetermined proportional gains phenotypic
selection index (PPG-LPSI) allows restrictions <em>different from
zero</em> to be imposed, ensuring that traits gain in strictly
predefined proportions to each other.</p>
<p>Minimizing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>H</mi><mo>âˆ’</mo><mi>I</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">E[(H - I)^2]</annotation></semantics></math>
under the proportional restriction
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğŒ</mi><mi>â€²</mi><mi>ğ›</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mathbf{M}'\mathbf{b} = 0</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğŒ</mi><mi>â€²</mi><mo>=</mo><mi>ğƒ</mi><mi>â€²</mi><mi>ğ‚</mi><mi>â€²</mi></mrow><annotation encoding="application/x-tex">\mathbf{M}' = \mathbf{D}'\mathbf{C}'</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğƒ</mi><mi>â€²</mi></mrow><annotation encoding="application/x-tex">\mathbf{D}'</annotation></semantics></math>
is a Mallard (1972) matrix, leads to:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¦</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›</mi><mo>,</mo><mi>ğ¯</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>ğ›</mi><mi>â€²</mi></msup><mrow><mi>ğ</mi><mi>ğ›</mi></mrow><mo>+</mo><msup><mi>ğ°</mi><mi>â€²</mi></msup><mrow><mi>ğ†</mi><mi>ğ°</mi></mrow><mo>âˆ’</mo><mn>2</mn><msup><mi>ğ°</mi><mi>â€²</mi></msup><mrow><mi>ğ†</mi><mi>ğ›</mi></mrow><mo>+</mo><mn>2</mn><msup><mi>ğ¯</mi><mi>â€²</mi></msup><msup><mi>ğŒ</mi><mi>â€²</mi></msup><mi>ğ›</mi></mrow><annotation encoding="application/x-tex"> \Phi \left(\mathbf{b},\mathbf{v}\right)={\mathbf{b}}^{\prime}\mathbf{Pb}+{\mathbf{w}}^{\prime}\mathbf{Gw}-2{\mathbf{w}}^{\prime}\mathbf{Gb}+2{\mathbf{v}}^{\prime }{\mathbf{M}}^{\prime}\mathbf{b} </annotation></semantics></math></p>
<p>The vector that minimizes the mean squared error under this
restriction is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ›</mi><mi>M</mi></msub><mo>=</mo><msub><mi>ğŠ</mi><mi>M</mi></msub><mi>ğ›</mi></mrow><annotation encoding="application/x-tex"> {\mathbf{b}}_M={\mathbf{K}}_M\mathbf{b} </annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğŠ</mi><mi>M</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>ğˆ</mi><mo>âˆ’</mo><msub><mi>ğ</mi><mi>M</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{K}_M = [\mathbf{I} - \mathbf{Q}_M]</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ</mi><mi>M</mi></msub><mo>=</mo><msup><mi>ğ</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğŒ</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğŒ</mi><mi>â€²</mi><msup><mi>ğ</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğŒ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğŒ</mi><mi>â€²</mi></mrow><annotation encoding="application/x-tex">\mathbf{Q}_M = \mathbf{P}^{-1}\mathbf{M}(\mathbf{M}'\mathbf{P}^{-1}\mathbf{M})^{-1}\mathbf{M}'</annotation></semantics></math>.
Alternatively, Tallis (1985) formulated it using a proportionality
constant
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¸</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ›</mi><mi mathvariant="normal">T</mi></msub><mo>=</mo><msub><mi>ğ›</mi><mi>R</mi></msub><mo>+</mo><mo>Î¸</mo><mo>ğ›…</mo></mrow><annotation encoding="application/x-tex"> {\mathbf{b}}_{\mathrm{T}}={\mathbf{b}}_R+\uptheta \boldsymbol{\updelta} </annotation></semantics></math></p>
<div class="section level3">
<h3 id="practical-application-ppg-lpsi">Practical Application: PPG-LPSI<a class="anchor" aria-label="anchor" href="#practical-application-ppg-lpsi"></a>
</h3>
<p>The <code>ppg_lpsi</code> function enforces these desired
proportional gains. Suppose we want the gains across the three traits to
follow the proportion <code>2 : 1 : 1</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify the desired proportions</span></span>
<span><span class="va">k_proportions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate the PPG-LPSI</span></span>
<span><span class="va">ppg_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ppg_lpsi.html">ppg_lpsi</a></span><span class="op">(</span>pmat <span class="op">=</span> <span class="va">pmat</span>, gmat <span class="op">=</span> <span class="va">gmat</span>, k <span class="op">=</span> <span class="va">k_proportions</span>, wmat <span class="op">=</span> <span class="va">wmat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the expected genetic gains</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ppg_res</span><span class="op">$</span><span class="va">Delta_G</span><span class="op">)</span></span>
<span><span class="co">#&gt;          Yield    PlantHeight DaysToMaturity </span></span>
<span><span class="co">#&gt;      700636.74       18363.40       10206.29</span></span></code></pre></div>
<p>If we observe the resulting <code>Delta_G</code> values, their
relative proportions should approximate the <code>2 : 1 : 1</code> ratio
dictated by <code>k</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="the-desired-gains-linear-phenotypic-selection-index-dg-lpsi">3. The Desired Gains Linear Phenotypic Selection Index
(DG-LPSI)<a class="anchor" aria-label="anchor" href="#the-desired-gains-linear-phenotypic-selection-index-dg-lpsi"></a>
</h2>
<p>The desired gains linear phenotypic selection index (DG-LPSI) is
unique in that it <em>does not require economic weights</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ°</mi><annotation encoding="application/x-tex">\mathbf{w}</annotation></semantics></math>.
Instead, the breeder specifies the exact desired target genetic gains
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ</mi><annotation encoding="application/x-tex">\mathbf{d}</annotation></semantics></math>
directly.</p>
<p>Because the expected genetic gain is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ„</mi><mo>=</mo><msub><mi>k</mi><mi>I</mi></msub><mfrac><mrow><mi>ğ†</mi><mi>ğ›</mi></mrow><msub><mi>Ïƒ</mi><mi>I</mi></msub></mfrac></mrow><annotation encoding="application/x-tex">\mathbf{E} = k_I \frac{\mathbf{Gb}}{\sigma_I}</annotation></semantics></math>,
if we set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>ğ†</mi><mi>ğ›</mi></mrow><mo>=</mo><mi>ğ</mi></mrow><annotation encoding="application/x-tex">\mathbf{Gb} = \mathbf{d}</annotation></semantics></math>,
then we want to minimize the variance of the index
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Ïƒ</mi><mi>I</mi></msub><annotation encoding="application/x-tex">\sigma_I</annotation></semantics></math>
subject to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi>ğ†</mi><mi>ğ›</mi></mrow><mo>=</mo><mi>ğ</mi></mrow><annotation encoding="application/x-tex">\mathbf{Gb} = \mathbf{d}</annotation></semantics></math>
to maximize
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ„</mi><annotation encoding="application/x-tex">\mathbf{E}</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î¦</mi><mrow><mi>D</mi><mi>G</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ›</mi><mo>,</mo><mi>ğ¯</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn mathvariant="bold">0.5</mn><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>ğ›</mi><mi>â€²</mi></msup><mrow><mi>ğ</mi><mi>ğ›</mi></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msup><mi>ğ¯</mi><mi>â€²</mi></msup><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mi>ğ†</mi><mi>ğ›</mi></mrow><mo>âˆ’</mo><mi>ğ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> {\Phi}_{DG}\left(\mathbf{b},\mathbf{v}\right)=\mathbf{0.5}\left({\mathbf{b}}^{\prime}\mathbf{Pb}\right)+{\mathbf{v}}^{\prime}\left(\mathbf{Gb}-\mathbf{d}\right) </annotation></semantics></math></p>
<p>Solving this yields the DG-LPSI vector of coefficients:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ›</mi><mrow><mi>D</mi><mi>G</mi></mrow></msub><mo>=</mo><msup><mi>ğ</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ†</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mrow><mi>ğ†</mi><mi>ğ</mi></mrow><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ†</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ</mi></mrow><annotation encoding="application/x-tex"> {\mathbf{b}}_{DG}={\mathbf{P}}^{-1}\mathbf{G}{\left({\mathbf{GP}}^{-1}\mathbf{G}\right)}^{-1}\mathbf{d} </annotation></semantics></math></p>
<div class="section level3">
<h3 id="practical-application-dg-lpsi">Practical Application: DG-LPSI<a class="anchor" aria-label="anchor" href="#practical-application-dg-lpsi"></a>
</h3>
<p>We can run the <code>dg_lpsi</code> function solely based on desired
absolute gains. Letâ€™s aim to increase Yield by 5 units, decrease Plant
Height by 2 units, and increase Days to Maturity by 1 unit.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Explicit vector of desired absolute genetic gains</span></span>
<span><span class="va">desired_gains</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="op">-</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate DG-LPSI</span></span>
<span><span class="va">dg_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dg_lpsi.html">dg_lpsi</a></span><span class="op">(</span>pmat <span class="op">=</span> <span class="va">pmat</span>, gmat <span class="op">=</span> <span class="va">gmat</span>, d <span class="op">=</span> <span class="va">desired_gains</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check the achieved proportional genetic gains</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">dg_res</span><span class="op">$</span><span class="va">Delta_G</span><span class="op">)</span></span>
<span><span class="co">#&gt;          Yield    PlantHeight DaysToMaturity </span></span>
<span><span class="co">#&gt;      3.3431312     -1.3372525      0.6686262</span></span>
<span></span>
<span><span class="co"># The DG-LPSI also calculates implied Smith-Hazel economic weights</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">dg_res</span><span class="op">$</span><span class="va">implied_weights_normalized</span><span class="op">)</span></span>
<span><span class="co">#&gt;          Yield    PlantHeight DaysToMaturity </span></span>
<span><span class="co">#&gt;    -0.01969999     0.19583750     1.00000000</span></span></code></pre></div>
<p>The output gives us the selection index coefficients
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ›</mi><annotation encoding="application/x-tex">\mathbf{b}</annotation></semantics></math>
that would achieve the target gains, as well as the implied economic
weights showing the â€œabsolute costâ€ or relative importance required to
achieve those gains.</p>
</div>
</div>
<div class="section level2">
<h2 id="advanced-concepts-and-trade-offs">4. Advanced Concepts and Trade-offs<a class="anchor" aria-label="anchor" href="#advanced-concepts-and-trade-offs"></a>
</h2>
<div class="section level3">
<h3 id="statistical-properties-and-efficiency-trade-offs">4.1 Statistical Properties and Efficiency Trade-offs<a class="anchor" aria-label="anchor" href="#statistical-properties-and-efficiency-trade-offs"></a>
</h3>
<p>Imposing restrictions on an index inherently limits its potential to
maximize the overall selection response
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>R</mi></msub><annotation encoding="application/x-tex">R_R</annotation></semantics></math>.
The <code>selection.index</code> package allows you to evaluate this
â€œcost of restrictionâ€ by calculating both the relative selection
efficiency (<code>PRE</code> - Percentage of Response Efficiency) and
the heritability (<code>hI2</code>) of the constrained index versus the
unconstrained equivalent.</p>
<p>When reviewing the <code>summary</code> data frame output of our
indices above: - <strong><code>rHI</code></strong>: The correlation
between the constrained index and the true net genetic merit
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>).
As more restrictions are added, this correlation decreases. -
<strong><code>PRE</code></strong>: Shows the expected genetic advance
relative to a base index. Constrained indices will universally show
lower <code>PRE</code> than their unconstrained LPSI counterpart.</p>
</div>
<div class="section level3">
<h3 id="manual-constraint-matrix-construction">4.2 Manual Constraint Matrix Construction<a class="anchor" aria-label="anchor" href="#manual-constraint-matrix-construction"></a>
</h3>
<p>By default, <code><a href="../reference/rlpsi.html">rlpsi()</a></code> and <code><a href="../reference/ppg_lpsi.html">ppg_lpsi()</a></code> accept
user-friendly arguments like <code>restricted_traits = c(2)</code> or
<code>k = c(2, 1, 1)</code> to automatically construct the mathematical
constraint matrices behind the scenes.</p>
<p>However, advanced users may wish to manually define these matrices,
particularly for complex scenarios.</p>
<p>For the <strong>RLPSI</strong>, the constraint matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ‚</mi><annotation encoding="application/x-tex">\mathbf{C}</annotation></semantics></math>
is a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>Ã—</mo><mi>r</mi></mrow><annotation encoding="application/x-tex">t \times r</annotation></semantics></math>
matrix (where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
is the number of traits and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>
is the number of restrictions). Each column represents a restricted
trait with a <code>1</code> at the restricted index and <code>0</code>s
elsewhere:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Manually restrict traits #1 and #3:</span></span>
<span><span class="co"># Create a 3x2 constraint matrix</span></span>
<span><span class="va">C_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="co"># Restrict trait 1</span></span>
<span>    <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span></span>
<span>  <span class="op">)</span>, <span class="co"># Restrict trait 3</span></span>
<span>  nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Pass directly to RLPSI</span></span>
<span><span class="va">rlpsi_manual</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rlpsi.html">rlpsi</a></span><span class="op">(</span>pmat <span class="op">=</span> <span class="va">pmat</span>, gmat <span class="op">=</span> <span class="va">gmat</span>, wmat <span class="op">=</span> <span class="va">wmat</span>, C <span class="op">=</span> <span class="va">C_matrix</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">rlpsi_manual</span><span class="op">$</span><span class="va">Delta_G</span><span class="op">)</span></span>
<span><span class="co">#&gt;          Yield    PlantHeight DaysToMaturity </span></span>
<span><span class="co">#&gt;    -0.01072495    -2.76848253     0.74035593</span></span></code></pre></div>
<p>The <code><a href="../reference/ppg_lpsi.html">ppg_lpsi()</a></code> function automatically manages the
complex proportional constraint matrix based on your inputs
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ¤</mi><annotation encoding="application/x-tex">\mathbf{k}</annotation></semantics></math>,
guaranteeing the proportional relationship
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î”</mi><mi>ğ†</mi><mo>=</mo><mi>Ï•</mi><mi>ğ¤</mi></mrow><annotation encoding="application/x-tex">\Delta \mathbf{G} = \phi\mathbf{k}</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="applicability-limitations-hazel-1943">4.3 Applicability Limitations (Hazel, 1943)<a class="anchor" aria-label="anchor" href="#applicability-limitations-hazel-1943"></a>
</h3>
<p>While these indices are powerful predictive models, their real-world
applicability operates under the limitations established by classical
breeding theory (Hazel, 1943):</p>
<ol style="list-style-type: decimal">
<li>
<strong>Economic Variability:</strong> Relative economic values
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ°</mi><annotation encoding="application/x-tex">\mathbf{w}</annotation></semantics></math>)
fluctuate by location, market demand, and enterprise goals.</li>
<li>
<strong>Genetic Context:</strong> A given genetic covariance matrix
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ†</mi><annotation encoding="application/x-tex">\mathbf{G}</annotation></semantics></math>)
is specific to the mating system and breeding population evaluated.</li>
<li>
<strong>Environmental Variance:</strong> Phenotypic standard
deviations
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ</mi><annotation encoding="application/x-tex">\mathbf{P}</annotation></semantics></math>)
differ among environments and management practices.</li>
<li>
<strong>Sampling Error:</strong> Small datasets fail to provide the
reliable genetic variance constants required to form precise predictive
indices.</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>The <code>selection.index</code> package provides highly flexible
options beyond the simple unrestricted index. The <strong>RLPSI</strong>
is useful when strictly zero-change bounds are needed on specific
traits. The <strong>PPG-LPSI</strong> caters to breeders focusing on a
strict multi-trait improvement ratio. Finally, the
<strong>DG-LPSI</strong> provides a powerful alternative for scenarios
where economic weights are notoriously difficult to estimate, but ideal
target gains are known. When using these constrained models, breeders
must continuously balance their specific phenotypic goals against the
intrinsic statistical costs to overall genetic efficiency.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zankrut Goyani.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
