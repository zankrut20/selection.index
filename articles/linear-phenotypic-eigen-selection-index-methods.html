<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Linear Phenotypic Eigen Selection Index Methods â€¢ selection.index</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Linear Phenotypic Eigen Selection Index Methods">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">selection.index</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/constrained-linear-genomic-selection-indices.html">Constrained Linear Genomic Selection Indices</a></li>
    <li><a class="dropdown-item" href="../articles/constrained-linear-phenotypic-selection-indices.html">Constrained Linear Phenotypic Selection Indices</a></li>
    <li><a class="dropdown-item" href="../articles/Examples.html">Data Analysis with selection.index</a></li>
    <li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started with selection.index</a></li>
    <li><a class="dropdown-item" href="../articles/linear-genomic-eigen-selection-index-methods.html">Linear Genomic Eigen Selection Index Methods</a></li>
    <li><a class="dropdown-item" href="../articles/linear-genomic-selection-indices.html">Linear Genomic Selection Indices</a></li>
    <li><a class="dropdown-item" href="../articles/linear-marker-selection-indices.html">Linear Marker and Genome-Wide Selection Indices</a></li>
    <li><a class="dropdown-item" href="../articles/linear-phenotypic-eigen-selection-index-methods.html">Linear Phenotypic Eigen Selection Index Methods</a></li>
    <li><a class="dropdown-item" href="../articles/linear-phenotypic-selection-index.html">The Linear Phenotypic Selection Index Theory</a></li>
    <li><a class="dropdown-item" href="../articles/multistage-linear-selection-indices.html">Multistage Phenotypic Selection Indices</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/zankrut20/selection.index/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Linear Phenotypic Eigen Selection Index Methods</h1>
                        <h4 data-toc-skip class="author">J. Jesus
Ceron-Rojas, Jose Crossa</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/zankrut20/selection.index/blob/feature/cpp-backend/vignettes/linear-phenotypic-eigen-selection-index-methods.Rmd" class="external-link"><code>vignettes/linear-phenotypic-eigen-selection-index-methods.Rmd</code></a></small>
      <div class="d-none name"><code>linear-phenotypic-eigen-selection-index-methods.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Based on canonical correlation, singular value decomposition (SVD),
and linear phenotypic selection indices theory, the <strong>Eigen
Selection Index Method (ESIM)</strong>, the <strong>Restricted ESIM
(RESIM)</strong>, and the <strong>Predetermined Proportional Gain ESIM
(PPG-ESIM)</strong> use only phenotypic information to predict the net
genetic merit and select superior genotypes.</p>
<p>While the Linear Phenotypic Selection Index (LPSI) assumes economic
weights are known, the ESIM family estimates them in each selection
cycle to maximize the correlation between the index and the net genetic
merit (i.e., accuracy) and the selection response. ESIM is unrestricted,
whereas RESIM fixes specific traits to zero genetic gain, and PPG-ESIM
ensures traits gain in strict prefixed proportions.</p>
<p>This vignette details the theoretical foundation of these three eigen
analysis indices alongside practical workflows for estimating them using
the <code>selection.index</code> package.</p>
<div class="section level3">
<h3 id="sample-data-preparation">Sample Data Preparation<a class="anchor" aria-label="anchor" href="#sample-data-preparation"></a>
</h3>
<p>Throughout this vignette, we will reuse the <code>maize_pheno</code>
package dataset to calculate our phenotypic
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ</mi><annotation encoding="application/x-tex">\mathbf{P}</annotation></semantics></math>)
and genotypic
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ†</mi><annotation encoding="application/x-tex">\mathbf{G}</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ‚</mi><annotation encoding="application/x-tex">\mathbf{C}</annotation></semantics></math>)
covariance matrices.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/zankrut20/selection.index" class="external-link">selection.index</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the built-in maize phenotype dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"maize_pheno"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract the traits of interest</span></span>
<span><span class="va">traits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Yield"</span>, <span class="st">"PlantHeight"</span>, <span class="st">"DaysToMaturity"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate Genotypic (gmat) and Phenotypic (pmat) covariance matrices</span></span>
<span><span class="va">gmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen_varcov.html">gen_varcov</a></span><span class="op">(</span><span class="va">maize_pheno</span><span class="op">[</span>, <span class="va">traits</span><span class="op">]</span>, <span class="va">maize_pheno</span><span class="op">$</span><span class="va">Genotype</span>, <span class="va">maize_pheno</span><span class="op">$</span><span class="va">Block</span><span class="op">)</span></span>
<span><span class="va">pmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phen_varcov.html">phen_varcov</a></span><span class="op">(</span><span class="va">maize_pheno</span><span class="op">[</span>, <span class="va">traits</span><span class="op">]</span>, <span class="va">maize_pheno</span><span class="op">$</span><span class="va">Genotype</span>, <span class="va">maize_pheno</span><span class="op">$</span><span class="va">Block</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="the-linear-phenotypic-eigen-selection-index-method-esim">1. The Linear Phenotypic Eigen Selection Index Method (ESIM)<a class="anchor" aria-label="anchor" href="#the-linear-phenotypic-eigen-selection-index-method-esim"></a>
</h2>
<p>The theoretical selection response of the ESIM can be written as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>I</mi></msub><mo>=</mo><msub><mi>k</mi><mi>I</mi></msub><msub><mi>Ïƒ</mi><mi>H</mi></msub><msub><mi>Ï</mi><mrow><mi>H</mi><mi>I</mi></mrow></msub><mo>,</mo><mspace width="1.0em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mn>7.1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> R_I = k_I \sigma_H \rho_{HI}, \quad (7.1) </annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mi>I</mi></msub><annotation encoding="application/x-tex">k_I</annotation></semantics></math>
is the selection intensity,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Ïƒ</mi><mi>H</mi></msub><annotation encoding="application/x-tex">\sigma_H</annotation></semantics></math>
is the standard deviation of the genetic merit, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Ï</mi><mrow><mi>H</mi><mi>I</mi></mrow></msub><annotation encoding="application/x-tex">\rho_{HI}</annotation></semantics></math>
is the correlation between the trait index and the unobservable genetic
merit.</p>
<p>To maximize the index selection response without pre-defined economic
weights, ESIM translates the index estimation into a generalized
eigenvalue problem:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>ğ</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ‚</mi><mo>âˆ’</mo><msubsup><mi>Î»</mi><mi>E</mi><mn>2</mn></msubsup><mi>ğˆ</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>ğ›</mi><mi>E</mi></msub><mo>=</mo><mn>ğŸ</mn><mo>,</mo><mspace width="1.0em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mn>7.10</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> (\mathbf{P}^{-1} \mathbf{C} - \lambda^2_E \mathbf{I}) \mathbf{b}_E = \mathbf{0}, \quad (7.10) </annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ğ</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ‚</mi></mrow><annotation encoding="application/x-tex">\mathbf{P}^{-1} \mathbf{C}</annotation></semantics></math>
is the multi-trait heritability matrix. The optimal ESIM vector of
coefficients
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ›</mi><mi>E</mi></msub><annotation encoding="application/x-tex">\mathbf{b}_E</annotation></semantics></math>
is the first eigenvector of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ğ</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ‚</mi></mrow><annotation encoding="application/x-tex">\mathbf{P}^{-1} \mathbf{C}</annotation></semantics></math>,
and its accuracy is the square root of the first eigenvalue
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Î»</mi><mi>E</mi></msub><annotation encoding="application/x-tex">\lambda_E</annotation></semantics></math>).</p>
<p>The maximized ESIM selection response can then be written as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>E</mi></msub><mo>=</mo><msub><mi>k</mi><mi>I</mi></msub><msqrt><mrow><mi>ğ›</mi><msub><mi>â€²</mi><mi>E</mi></msub><mi>ğ</mi><msub><mi>ğ›</mi><mi>E</mi></msub></mrow></msqrt><mspace width="1.0em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mn>7.15</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> R_E = k_I \sqrt{ \mathbf{b}'_E \mathbf{P} \mathbf{b}_E } \quad (7.15) </annotation></semantics></math></p>
<div class="section level3">
<h3 id="practical-application-esim">Practical Application: ESIM<a class="anchor" aria-label="anchor" href="#practical-application-esim"></a>
</h3>
<p>In the package, <code>esim</code> maximizes the genetic response
without pre-defined weights for <code>pmat</code> and
<code>gmat</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute the linear phenotypic eigen selection index</span></span>
<span><span class="va">esim_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/esim.html">esim</a></span><span class="op">(</span></span>
<span>    pmat <span class="op">=</span> <span class="va">pmat</span>,</span>
<span>    gmat <span class="op">=</span> <span class="va">gmat</span>,</span>
<span>    selection_intensity <span class="op">=</span> <span class="fl">2.063</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">esim_res</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Index  lambda2      hI2      rHI  sigma_I Delta_G      b.1      b.2      b.3</span></span>
<span><span class="co">#&gt; 1     1 1771.794 1771.794 42.09268 3.286805 6.78068 0.002336 0.009329 0.999954</span></span>
<span></span>
<span><span class="co"># View expected genetic gains per trait (Delta_G)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">esim_res</span><span class="op">$</span><span class="va">Delta_G</span><span class="op">)</span></span>
<span><span class="co">#&gt;          Yield    PlantHeight DaysToMaturity </span></span>
<span><span class="co">#&gt;      700636.74       18363.40       10206.29</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="the-restricted-eigen-selection-index-method-resim">2. The Restricted Eigen Selection Index Method (RESIM)<a class="anchor" aria-label="anchor" href="#the-restricted-eigen-selection-index-method-resim"></a>
</h2>
<p>Similar to the RLPSI, the RESIM fixes certain traits so that their
expected genetic gain remains null (zero). Instead of modifying known
economic weights under restrictions, RESIM computes the restricted
eigenvalues natively.</p>
<p>When an orthogonal set of restrictions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ”</mi><mi>â€²</mi></mrow><annotation encoding="application/x-tex">\mathbf{U}'</annotation></semantics></math>
is imposed, the optimized eigenvalue equation becomes:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğŠ</mi><msup><mi>ğ</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ‚</mi><mo>âˆ’</mo><msubsup><mi>Î»</mi><mi>R</mi><mn>2</mn></msubsup><msub><mi>ğˆ</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>ğ›</mi><mi>R</mi></msub><mo>=</mo><mn>ğŸ</mn><mi>.</mi><mspace width="1.0em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mn>7.31</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> (\mathbf{K} \mathbf{P}^{-1} \mathbf{C} - \lambda^2_R \mathbf{I}_t) \mathbf{b}_R = \mathbf{0}. \quad (7.31) </annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğŠ</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>ğˆ</mi><mo>âˆ’</mo><mi>ğ</mi><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{K} = [\mathbf{I} - \mathbf{Q}]</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ</mi><mo>=</mo><msup><mi>ğ</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ‚</mi><mi>ğ”</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ”</mi><mi>â€²</mi><mi>ğ‚</mi><msup><mi>ğ</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ‚</mi><mi>ğ”</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ”</mi><mi>â€²</mi><mi>ğ‚</mi></mrow><annotation encoding="application/x-tex">\mathbf{Q} = \mathbf{P}^{-1}\mathbf{C}\mathbf{U}(\mathbf{U}'\mathbf{C}\mathbf{P}^{-1}\mathbf{C}\mathbf{U})^{-1}\mathbf{U}'\mathbf{C}</annotation></semantics></math>.
The vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ›</mi><mi>R</mi></msub><annotation encoding="application/x-tex">\mathbf{b}_R</annotation></semantics></math>
is the restriction-corrected eigenvector.</p>
<div class="section level3">
<h3 id="practical-application-resim">Practical Application: RESIM<a class="anchor" aria-label="anchor" href="#practical-application-resim"></a>
</h3>
<p>We use <code>resim</code> and restrict <code>PlantHeight</code>
(trait #2) to have strictly zero expected genetic gain.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We restrict PlantHeight (the second trait in our data frame)</span></span>
<span><span class="va">resim_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/resim.html">resim</a></span><span class="op">(</span></span>
<span>    pmat <span class="op">=</span> <span class="va">pmat</span>,</span>
<span>    gmat <span class="op">=</span> <span class="va">gmat</span>,</span>
<span>    restricted_traits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>    selection_intensity <span class="op">=</span> <span class="fl">2.063</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Expected genetic gains per trait</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">resim_res</span><span class="op">$</span><span class="va">Delta_G</span><span class="op">)</span></span>
<span><span class="co">#&gt;          Yield    PlantHeight DaysToMaturity </span></span>
<span><span class="co">#&gt;  -1.057493e+02   1.324103e-07  -2.276986e+00</span></span></code></pre></div>
<p>Notice that the expected genetic gain for our restricted trait is
mathematically forced to zero.</p>
</div>
</div>
<div class="section level2">
<h2 id="the-predetermined-proportional-gain-esim-ppg-esim">3. The Predetermined Proportional Gain ESIM (PPG-ESIM)<a class="anchor" aria-label="anchor" href="#the-predetermined-proportional-gain-esim-ppg-esim"></a>
</h2>
<p>Instead of null gains, the PPG-ESIM allows the breeder to pre-set
optimal levels of growth proportion on specific traits while maintaining
the eigen maximization properties on the non-restricted traits.</p>
<p>This changes the eigen mapping matrix using the proportional
restrictions Mallard operator
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğŒ</mi><mi>â€²</mi></mrow><annotation encoding="application/x-tex">\mathbf{M}'</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğŠ</mi><mi>P</mi></msub><msup><mi>ğ</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ‚</mi><mo>âˆ’</mo><msubsup><mi>Î»</mi><mi>P</mi><mn>2</mn></msubsup><msub><mi>ğˆ</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>ğ›</mi><mi>P</mi></msub><mo>=</mo><mn>ğŸ</mn><mo>,</mo><mspace width="1.0em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mn>7.43</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> (\mathbf{K}_P \mathbf{P}^{-1} \mathbf{C} - \lambda^2_P \mathbf{I}_t) \mathbf{b}_P = \mathbf{0}, \quad (7.43) </annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğŠ</mi><mi>P</mi></msub><annotation encoding="application/x-tex">\mathbf{K}_P</annotation></semantics></math>
is derived from the predetermined proportional vector parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ</mi><annotation encoding="application/x-tex">\mathbf{d}</annotation></semantics></math>.</p>
<div class="section level3">
<h3 id="practical-application-ppg-esim">Practical Application: PPG-ESIM<a class="anchor" aria-label="anchor" href="#practical-application-ppg-esim"></a>
</h3>
<p>Letâ€™s assume we want a strict
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">5\%</annotation></semantics></math>
gain in PlantHeight and a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">10\%</annotation></semantics></math>
reduction in DaysToMaturity proportionately compared to Yield.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Provide the vector d of desired predetermined proportional gains</span></span>
<span><span class="co"># The indices represent non-zero targets. For exactly corresponding target magnitudes, we provide d.</span></span>
<span><span class="va">d_vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="co"># e.g. proportional mapping</span></span>
<span></span>
<span><span class="co"># We use the ppg_esim function</span></span>
<span><span class="va">ppgesim_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ppg_esim.html">ppg_esim</a></span><span class="op">(</span></span>
<span>    pmat <span class="op">=</span> <span class="va">pmat</span>,</span>
<span>    gmat <span class="op">=</span> <span class="va">gmat</span>,</span>
<span>    d <span class="op">=</span> <span class="va">d_vector</span>,</span>
<span>    selection_intensity <span class="op">=</span> <span class="fl">2.063</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the proportionality of the genetic gains</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ppgesim_res</span><span class="op">$</span><span class="va">Delta_G</span><span class="op">)</span></span>
<span><span class="co">#&gt;          Yield    PlantHeight DaysToMaturity </span></span>
<span><span class="co">#&gt;    -2597.62024      -68.25086      -37.50434</span></span></code></pre></div>
<p>Through this mechanism, breeders manipulate genetic covariance paths
analytically accurately.</p>
</div>
</div>
<div class="section level2">
<h2 id="statistical-properties-of-eigen-selection-indices">4. Statistical Properties of Eigen Selection Indices<a class="anchor" aria-label="anchor" href="#statistical-properties-of-eigen-selection-indices"></a>
</h2>
<div class="section level3">
<h3 id="variance-of-predicted-error-vpe">Variance of Predicted Error (VPE)<a class="anchor" aria-label="anchor" href="#variance-of-predicted-error-vpe"></a>
</h3>
<p>The precision of the index in predicting the net genetic merit is
evaluated by its Variance of Predicted Error:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mi>P</mi><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>I</mi><mi>E</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msubsup><mi>Ïƒ</mi><msub><mi>H</mi><mi>E</mi></msub><mn>2</mn></msubsup><mo>âˆ’</mo><msubsup><mi>Ïƒ</mi><msub><mi>I</mi><mi>E</mi></msub><mn>2</mn></msubsup><mspace width="1.0em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mn>7.19</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> VPE(I_E) = \sigma^2_{H_E} - \sigma^2_{I_E} \quad (7.19) </annotation></semantics></math></p>
<p>The relative mean squared effect of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mi>E</mi></msub><annotation encoding="application/x-tex">I_E</annotation></semantics></math>
in predicting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mi>E</mi></msub><annotation encoding="application/x-tex">H_E</annotation></semantics></math>
is equivalent to its reliability:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>V</mi><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>H</mi><mi>E</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><mi>V</mi><mi>P</mi><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>I</mi><mi>E</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>V</mi><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>H</mi><mi>E</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>=</mo><msubsup><mi>Ï</mi><mrow><msub><mi>H</mi><mi>E</mi></msub><msub><mi>I</mi><mi>E</mi></msub></mrow><mn>2</mn></msubsup><mspace width="1.0em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mn>7.20</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> \frac{Var(H_E) - VPE(I_E)}{Var(H_E)} = \rho^2_{H_E I_E} \quad (7.20) </annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Ï</mi><mrow><msub><mi>H</mi><mi>E</mi></msub><msub><mi>I</mi><mi>E</mi></msub></mrow><mn>2</mn></msubsup><annotation encoding="application/x-tex">\rho^2_{H_E I_E}</annotation></semantics></math>
is the squared accuracy of the eigen index.</p>
</div>
<div class="section level3">
<h3 id="canonical-correlation-connection">Canonical Correlation Connection<a class="anchor" aria-label="anchor" href="#canonical-correlation-connection"></a>
</h3>
<p>The ESIM optimization maps directly to Canonical Correlation Theory
(Hotelling 1936). The objective is to find a linear combination of
traits having maximal correlation with the net genetic merit. In the
ESIM context,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ›</mi><mi>E</mi></msub><annotation encoding="application/x-tex">\mathbf{b}_E</annotation></semantics></math>
is exactly the first canonical vector of the matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ğ</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><mi>ğ‚</mi></mrow><annotation encoding="application/x-tex">\mathbf{P}^{-1}\mathbf{C}</annotation></semantics></math>,
and its associated accuracy represents the highest achievable canonical
correlation between the phenotypic indices and the genotypic values.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zankrut Goyani.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
