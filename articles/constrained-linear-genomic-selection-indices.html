<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Constrained Linear Genomic Selection Indices ‚Ä¢ selection.index</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Constrained Linear Genomic Selection Indices">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">selection.index</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/constrained-linear-genomic-selection-indices.html">Constrained Linear Genomic Selection Indices</a></li>
    <li><a class="dropdown-item" href="../articles/constrained-linear-phenotypic-selection-indices.html">Constrained Linear Phenotypic Selection Indices</a></li>
    <li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started with selection.index</a></li>
    <li><a class="dropdown-item" href="../articles/linear-genomic-eigen-selection-index-methods.html">Linear Genomic Eigen Selection Index Methods</a></li>
    <li><a class="dropdown-item" href="../articles/linear-genomic-selection-indices.html">Linear Genomic Selection Indices</a></li>
    <li><a class="dropdown-item" href="../articles/linear-marker-selection-indices.html">Linear Marker and Genome-Wide Selection Indices</a></li>
    <li><a class="dropdown-item" href="../articles/linear-phenotypic-eigen-selection-index-methods.html">Linear Phenotypic Eigen Selection Index Methods</a></li>
    <li><a class="dropdown-item" href="../articles/linear-phenotypic-selection-index.html">The Linear Phenotypic Selection Index Theory</a></li>
    <li><a class="dropdown-item" href="../articles/multistage-linear-selection-indices.html">Multistage Phenotypic Selection Indices</a></li>
    <li><a class="dropdown-item" href="../articles/stochastic-simulation-linear-phenotypic-indices.html">Stochastic Simulation of Linear Phenotypic Selection Indices</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/zankrut20/selection.index/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Constrained Linear Genomic Selection Indices</h1>
                        <h4 data-toc-skip class="author">Zankrut
Goyani</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/zankrut20/selection.index/blob/feature/cpp-backend/vignettes/constrained-linear-genomic-selection-indices.Rmd" class="external-link"><code>vignettes/constrained-linear-genomic-selection-indices.Rmd</code></a></small>
      <div class="d-none name"><code>constrained-linear-genomic-selection-indices.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette demonstrates the methodology behind <strong>Constrained
Linear Genomic Selection Indices (LGSI)</strong> based on Chapter 6 of
the book <em>Linear Selection Indices in Modern Plant Breeding</em>. The
objective of constrained selection indices is to maximize genetic
advance for specific traits while imposing defined restrictions on other
traits.</p>
<p>In a genomic selection context, these indices use Genomic Estimated
Breeding Values (GEBVs). The core indices covered here include:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Restricted Linear Genomic Selection Index (RLGSI)</strong>:
Aims to improve specific traits while leaving others fixed (null
restriction).</li>
<li>
<strong>Predetermined Proportional Gain Linear Genomic Selection
Index (PPG-LGSI)</strong>: Aims to achieve specific, predetermined
proportions of change in the population mean of designated traits.</li>
<li>
<strong>Combined RLGSI (CRLGSI)</strong>: Extends RLGSI to use
phenotypic and GEBV information jointly.</li>
<li>
<strong>Combined PPG-LGSI (CPPG-LGSI)</strong>: Extends PPG-LGSI to
use phenotypic and GEBV information jointly.</li>
</ol>
</div>
<div class="section level2">
<h2 id="environment-setup-and-data-preparation">Environment Setup and Data Preparation<a class="anchor" aria-label="anchor" href="#environment-setup-and-data-preparation"></a>
</h2>
<p>We will utilize synthetic phenotypic and genotypic maize data
provided in the <code>selection.index</code> package to illustrate these
methods.</p>
<div class="section level3">
<h3 id="estimating-gebvs">1. Estimating GEBVs<a class="anchor" aria-label="anchor" href="#estimating-gebvs"></a>
</h3>
<p>Before applying these indices, we first estimate genomic breeding
values. We use Ridge Regression (<code>lm.ridge</code>) from the
<code>MASS</code> package as a rapid and simple method to simulate this
step linking marker data to phenotype data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/zankrut20/selection.index" class="external-link">selection.index</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span> <span class="co"># For Ridge regression</span></span>
<span></span>
<span><span class="co"># Load the maize datasets</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"maize_pheno"</span>, package <span class="op">=</span> <span class="st">"selection.index"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"maize_geno"</span>, package <span class="op">=</span> <span class="st">"selection.index"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract only the traits we care about to prevent missing value logic failures</span></span>
<span><span class="va">traits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Yield"</span>, <span class="st">"PlantHeight"</span>, <span class="st">"DaysToMaturity"</span><span class="op">)</span></span>
<span><span class="va">maize_pheno_clean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">maize_pheno</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Genotype"</span>, <span class="st">"Block"</span>, <span class="va">traits</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate mean performance for phenotypic data</span></span>
<span><span class="co"># Providing only the traits to `data` to accurately generate the table</span></span>
<span><span class="va">pheno_means_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mean_performance.html">mean_performance</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">maize_pheno_clean</span><span class="op">[</span>, <span class="va">traits</span><span class="op">]</span>,</span>
<span>  genotypes <span class="op">=</span> <span class="va">maize_pheno_clean</span><span class="op">$</span><span class="va">Genotype</span>,</span>
<span>  replications <span class="op">=</span> <span class="va">maize_pheno_clean</span><span class="op">$</span><span class="va">Block</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"Mean"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Remove the trailing 9 rows composed of summary text-stats automatically generated</span></span>
<span><span class="va">pheno_means</span> <span class="op">&lt;-</span> <span class="va">pheno_means_full</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pheno_means_full</span><span class="op">)</span> <span class="op">-</span> <span class="fl">9</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Extract numerical phenotype matrix</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">pheno_means</span><span class="op">[</span>, <span class="va">traits</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mode.html" class="external-link">mode</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"numeric"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">pheno_means</span><span class="op">$</span><span class="va">Genotypes</span></span>
<span></span>
<span><span class="co"># Format genotype matrix</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">maize_geno</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ensure matching dimensions and align the matrices</span></span>
<span><span class="va">common_genotypes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter and sort matrices to match genotypes sequence exactly</span></span>
<span><span class="va">Y_filtered</span> <span class="op">&lt;-</span> <span class="va">Y</span><span class="op">[</span><span class="va">common_genotypes</span>, <span class="op">]</span></span>
<span><span class="va">X_filtered</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span><span class="va">common_genotypes</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Calculate GEBVs using a simple Ridge Regression model per trait</span></span>
<span><span class="va">gebvs_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Y_filtered</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Y_filtered</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">gebvs_sim</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Y_filtered</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">gebvs_sim</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">Y_filtered</span><span class="op">)</span></span>
<span><span class="va">lambda_ridge</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Y_filtered</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Fit ridge regression to simulate marker effects</span></span>
<span>  <span class="va">model_ridge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/lm.ridge.html" class="external-link">lm.ridge</a></span><span class="op">(</span><span class="va">Y_filtered</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span> <span class="op">~</span> <span class="va">X_filtered</span>, lambda <span class="op">=</span> <span class="va">lambda_ridge</span><span class="op">)</span></span>
<span>  <span class="va">beta_ridge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">model_ridge</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># Predict GEBVs</span></span>
<span>  <span class="va">gebvs_sim</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">X_filtered</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">beta_ridge</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Define Covariance Matrices</span></span>
<span><span class="va">Gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">gebvs_sim</span><span class="op">)</span> <span class="co"># Genomic Covariance Matrix estimated from simulated GEBVs</span></span>
<span><span class="va">P_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">Y_filtered</span><span class="op">)</span> <span class="co"># Phenotypic Covariance Matrix</span></span>
<span><span class="va">C_matrix</span> <span class="op">&lt;-</span> <span class="va">Gamma</span> <span class="co"># Genetic Covariance (Assuming Gamma captures genetic additive cov)</span></span>
<span></span>
<span><span class="co"># Define vector of economic weights for Yield, PlantHeight, DaysToMaturity</span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="op">-</span><span class="fl">0.1</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="the-restricted-linear-genomic-selection-index-rlgsi">6.1 The Restricted Linear Genomic Selection Index (RLGSI)<a class="anchor" aria-label="anchor" href="#the-restricted-linear-genomic-selection-index-rlgsi"></a>
</h2>
<p>The RLGSI is applied in a testing population when only GEBVs are
available. The goal is to maximize the response for some traits while
restricting the expected generic advance of other traits to exactly
zero.</p>
<div class="section level3">
<h3 id="mathematical-definition">Mathematical Definition<a class="anchor" aria-label="anchor" href="#mathematical-definition"></a>
</h3>
<p>The expected genetic advance for RLGSI is restricted by:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>o</mi><mi>v</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>I</mi><mrow><mi>R</mi><mi>G</mi></mrow></msub><mo>,</mo><mi>ùêî</mi><mi>‚Ä≤</mi><mi>ùê†</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>ùêî</mi><mi>‚Ä≤</mi><mi>ùö™</mi><msub><mi>ùõÉ</mi><mrow><mi>R</mi><mi>G</mi></mrow></msub><mo>=</mo><mn>ùüé</mn></mrow><annotation encoding="application/x-tex">Cov(I_{RG}, \mathbf{U}'\mathbf{g}) = \mathbf{U}'\boldsymbol{\Gamma}\boldsymbol{\beta}_{RG} = \mathbf{0}</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùêî</mi><mi>‚Ä≤</mi></mrow><annotation encoding="application/x-tex">\mathbf{U}'</annotation></semantics></math>
is a matrix of 1s and 0s identifying the restricted traits.</p>
<p>Following the maximization step of the selection response, the index
coefficients
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùõÉ</mi><mrow><mi>R</mi><mi>G</mi></mrow></msub><annotation encoding="application/x-tex">\boldsymbol{\beta}_{RG}</annotation></semantics></math>
optimally resolve as:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùõÉ</mi><mrow><mi>R</mi><mi>G</mi></mrow></msub><mo>=</mo><msub><mi>ùêä</mi><mi>G</mi></msub><mi>ùê∞</mi></mrow><annotation encoding="application/x-tex"> \boldsymbol{\beta}_{RG} = \mathbf{K}_{G}\mathbf{w} </annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùêä</mi><mi>G</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mi>ùêà</mi><mo>‚àí</mo><msub><mi>ùêê</mi><mi>G</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{K}_{G} = [\mathbf{I} - \mathbf{Q}_{G}]</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùêê</mi><mi>G</mi></msub><mo>=</mo><mi>ùêî</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>ùêî</mi><mi>‚Ä≤</mi><mi>ùö™</mi><mi>ùêî</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mi>ùêî</mi><mi>‚Ä≤</mi><mi>ùö™</mi></mrow><annotation encoding="application/x-tex">\mathbf{Q}_{G} = \mathbf{U} (\mathbf{U}' \boldsymbol{\Gamma} \mathbf{U})^{-1} \mathbf{U}' \boldsymbol{\Gamma}</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="rlgsi-implementation-example">RLGSI Implementation Example<a class="anchor" aria-label="anchor" href="#rlgsi-implementation-example"></a>
</h3>
<p>Suppose we want to maximize the gain using our three traits, but we
want to hold <strong>Plant Height</strong> and <strong>Days To
Maturity</strong> completely fixed
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math>
gain).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the restriction matrix U</span></span>
<span><span class="co"># We restrict traits 2 (PlantHeight) and 3 (DaysToMaturity).</span></span>
<span><span class="co"># Trait 1 (Yield) is left unrestricted.</span></span>
<span><span class="va">U_rlgsi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">0</span>, <span class="fl">0</span>, <span class="co"># Yield unrestricted</span></span>
<span>  <span class="fl">1</span>, <span class="fl">0</span>, <span class="co"># PlantHeight restricted</span></span>
<span>  <span class="fl">0</span>, <span class="fl">1</span> <span class="co"># DaysToMaturity restricted</span></span>
<span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate RLGSI</span></span>
<span><span class="va">rlgsi_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rlgsi.html">rlgsi</a></span><span class="op">(</span>Gamma <span class="op">=</span> <span class="va">Gamma</span>, wmat <span class="op">=</span> <span class="va">w</span>, U <span class="op">=</span> <span class="va">U_rlgsi</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the resulting index coefficients and Expected Genetic Gain</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"RLGSI Coefficients (beta_RG):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; RLGSI Coefficients (beta_RG):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">rlgsi_res</span><span class="op">$</span><span class="va">b</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]    5.0000 -111.1516  175.9708</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nExpected Genetic Gain per Trait:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Expected Genetic Gain per Trait:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">rlgsi_res</span><span class="op">$</span><span class="va">Summary</span><span class="op">[</span>, <span class="st">"Delta_H"</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>Notice in the output that the Expected Genetic Gain
(<code>Delta_H</code>) for traits 2 and 3 evaluates to a precision limit
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math>,
fulfilling the null-gain restriction.</p>
</div>
</div>
<div class="section level2">
<h2 id="the-predetermined-proportional-gain-linear-genomic-selection-index-ppg-lgsi">6.2 The Predetermined Proportional Gain Linear Genomic Selection
Index (PPG-LGSI)<a class="anchor" aria-label="anchor" href="#the-predetermined-proportional-gain-linear-genomic-selection-index-ppg-lgsi"></a>
</h2>
<p>Instead of forcing a trait to remain fixed at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math>,
we might want a trait‚Äôs mean value to undergo a highly specific,
predefined amount of selection shift.</p>
<div class="section level3">
<h3 id="mathematical-definition-1">Mathematical Definition<a class="anchor" aria-label="anchor" href="#mathematical-definition-1"></a>
</h3>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùêù</mi><mi>‚Ä≤</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>d</mi><mn>1</mn></msub><mo>,</mo><msub><mi>d</mi><mn>2</mn></msub><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><msub><mi>d</mi><mi>r</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{d}' = [d_1, d_2, \ldots, d_r]</annotation></semantics></math>
be the proportional gain values requested by the breeder. Similar to the
RLGSI, the coefficient array evaluates identically with a targeted
constant proportionality factor restricting expected proportional
shifts:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùõÉ</mi><mrow><mi>P</mi><mi>G</mi></mrow></msub><mo>=</mo><msub><mi>ùêä</mi><mi>P</mi></msub><mi>ùê∞</mi></mrow><annotation encoding="application/x-tex"> \boldsymbol{\beta}_{PG} = \mathbf{K}_{P}\mathbf{w} </annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="ppg-lgsi-implementation-example">PPG-LGSI Implementation Example<a class="anchor" aria-label="anchor" href="#ppg-lgsi-implementation-example"></a>
</h3>
<p>Suppose we want to target <strong>Yield</strong> to proportionally
increase by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>7.0</mn><annotation encoding="application/x-tex">7.0</annotation></semantics></math>
units, and identically target <strong>Plant Height</strong> to slightly
decrease by relatively
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚àí</mo><mn>3.0</mn></mrow><annotation encoding="application/x-tex">-3.0</annotation></semantics></math>
proportion targets.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the restriction matrix U for PPG</span></span>
<span><span class="co"># Restrict traits 1 (Yield) and 2 (PlantHeight) to predetermined scalars</span></span>
<span><span class="va">U_ppg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">1</span>, <span class="fl">0</span>, <span class="co"># Yield restricted</span></span>
<span>  <span class="fl">0</span>, <span class="fl">1</span>, <span class="co"># PlantHeight restricted</span></span>
<span>  <span class="fl">0</span>, <span class="fl">0</span> <span class="co"># DaysToMaturity unrestricted</span></span>
<span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define the predetermined values vector 'd'</span></span>
<span><span class="va">d_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7.0</span>, <span class="op">-</span><span class="fl">3.0</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate PPG-LGSI</span></span>
<span><span class="va">ppg_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ppg_lgsi.html">ppg_lgsi</a></span><span class="op">(</span>Gamma <span class="op">=</span> <span class="va">Gamma</span>, d <span class="op">=</span> <span class="va">d_vec</span>, wmat <span class="op">=</span> <span class="va">w</span>, U <span class="op">=</span> <span class="va">U_ppg</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"PPG-LGSI Coefficients (beta_PG):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; PPG-LGSI Coefficients (beta_PG):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ppg_res</span><span class="op">$</span><span class="va">b</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]   0.2441 -11.1971  -0.1000</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="combined-restricted-linear-genomic-selection-index-crlgsi">6.3 Combined Restricted Linear Genomic Selection Index (CRLGSI)<a class="anchor" aria-label="anchor" href="#combined-restricted-linear-genomic-selection-index-crlgsi"></a>
</h2>
<p>The CRLGSI extends the basic RLGSI by integrating <em>both</em>
phenotypic information and genomic breeding values structurally as
blocks in a combined index
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mi>C</mi></msub><annotation encoding="application/x-tex">I_C</annotation></semantics></math>.
It is mainly applied to a training population where joint data is
uniformly available.</p>
<p>Its mathematical structure models parallel coefficient distributions
across phenotypic and genomic parameters uniformly:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùõÉ</mi><mrow><mi>C</mi><mi>R</mi></mrow></msub><mo>=</mo><msub><mi>ùêä</mi><mi>C</mi></msub><msub><mi>ùõÉ</mi><mi>C</mi></msub></mrow><annotation encoding="application/x-tex"> \boldsymbol{\beta}_{CR} = \mathbf{K}_{C}\boldsymbol{\beta}_C </annotation></semantics></math></p>
<p>For an index combining phenotypes and GEBVs, restrictions must
concurrently be assigned to both empirical dimensions globally.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Provide Combined Matrices</span></span>
<span><span class="co"># The combined Phenotypic-Genomic covariance matrix T_C</span></span>
<span><span class="va">T_C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">P_matrix</span>, <span class="va">Gamma</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Gamma</span>, <span class="va">Gamma</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The combined Genetic-Genomic covariance matrix Psi_C</span></span>
<span><span class="va">Psi_C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">C_matrix</span>, <span class="va">Gamma</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Gamma</span>, <span class="va">Gamma</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. Define Restriction Matrix U_C</span></span>
<span><span class="co"># Note: For combined indices of `t` traits, U_C spans exactly 2t rows.</span></span>
<span><span class="co"># Restricting Trait 1 (Yield) on both empirical and genomic parameters:</span></span>
<span><span class="va">U_crlgsi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="fl">6</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">U_crlgsi</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># Trait 1 phenotypic component</span></span>
<span><span class="va">U_crlgsi</span><span class="op">[</span><span class="fl">4</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># Trait 1 genomic component</span></span>
<span></span>
<span><span class="co"># 3. Calculate CRLGSI</span></span>
<span><span class="va">crlgsi_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/crlgsi.html">crlgsi</a></span><span class="op">(</span>T_C <span class="op">=</span> <span class="va">T_C</span>, Psi_C <span class="op">=</span> <span class="va">Psi_C</span>, wmat <span class="op">=</span> <span class="va">w</span>, U <span class="op">=</span> <span class="va">U_crlgsi</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"CRLGSI Combined Coefficients (beta_CR):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; CRLGSI Combined Coefficients (beta_CR):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">crlgsi_res</span><span class="op">$</span><span class="va">b</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -6.843307e-05 -1.079212e-03 -5.103276e-02  2.017002e-03 -9.892085e-02</span></span>
<span><span class="co">#&gt; [6] -4.895374e-02</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="combined-predetermined-proportional-gain-linear-genomic-selection-index-cppg-lgsi">6.4 Combined Predetermined Proportional Gain Linear Genomic
Selection Index (CPPG-LGSI)<a class="anchor" aria-label="anchor" href="#combined-predetermined-proportional-gain-linear-genomic-selection-index-cppg-lgsi"></a>
</h2>
<p>The CPPG-LGSI combines the dynamic proportional gain vectors to the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>C</mi></msub><annotation encoding="application/x-tex">T_C</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ®</mi><mi>C</mi></msub><annotation encoding="application/x-tex">\Psi_C</annotation></semantics></math>
data blocks identically leveraging the <code><a href="../reference/cppg_lgsi.html">cppg_lgsi()</a></code>
logic.</p>
<div class="section level3">
<h3 id="cppg-lgsi-implementation-example">CPPG-LGSI Implementation Example<a class="anchor" aria-label="anchor" href="#cppg-lgsi-implementation-example"></a>
</h3>
<p>Suppose we arbitrarily evaluate <strong>Yield</strong> to
predetermined restriction constants.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Target Yield using predetermined combined proportions d</span></span>
<span><span class="va">d_combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7.0</span>, <span class="fl">3.5</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate CPPG-LGSI dynamically</span></span>
<span><span class="va">cppg_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cppg_lgsi.html">cppg_lgsi</a></span><span class="op">(</span>T_C <span class="op">=</span> <span class="va">T_C</span>, Psi_C <span class="op">=</span> <span class="va">Psi_C</span>, d <span class="op">=</span> <span class="va">d_combined</span>, wmat <span class="op">=</span> <span class="va">w</span>, U <span class="op">=</span> <span class="va">U_crlgsi</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"CPPG-LGSI Coefficients (beta_CP):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; CPPG-LGSI Coefficients (beta_CP):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cppg_res</span><span class="op">$</span><span class="va">b</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  4.491869e-06  7.083960e-05  3.349690e-03  4.998047e+00 -7.083568e-05</span></span>
<span><span class="co">#&gt; [6] -3.350577e-03</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="summary-comparison">Summary Comparison<a class="anchor" aria-label="anchor" href="#summary-comparison"></a>
</h2>
<p>Below we extract the standard metrics associated with each index
model (i.e Selection Response
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comparison_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RLGSI"</span>, <span class="st">"PPG-LGSI"</span>, <span class="st">"CRLGSI"</span>, <span class="st">"CPPG-LGSI"</span><span class="op">)</span>,</span>
<span>  Selection_Response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va">rlgsi_res</span><span class="op">$</span><span class="va">R</span>,</span>
<span>    <span class="va">ppg_res</span><span class="op">$</span><span class="va">R</span>,</span>
<span>    <span class="va">crlgsi_res</span><span class="op">$</span><span class="va">R</span>,</span>
<span>    <span class="va">cppg_res</span><span class="op">$</span><span class="va">R</span></span>
<span>  <span class="op">)</span>,</span>
<span>  Overall_Genetic_Advance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va">rlgsi_res</span><span class="op">$</span><span class="va">GA</span>,</span>
<span>    <span class="va">ppg_res</span><span class="op">$</span><span class="va">GA</span>,</span>
<span>    <span class="va">crlgsi_res</span><span class="op">$</span><span class="va">GA</span>,</span>
<span>    <span class="va">cppg_res</span><span class="op">$</span><span class="va">GA</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">comparison_df</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Index Selection_Response Overall_Genetic_Advance</span></span>
<span><span class="co">#&gt; 1     RLGSI       1490.8413294            1490.8413294</span></span>
<span><span class="co">#&gt; 2  PPG-LGSI        102.6128081             102.9592598</span></span>
<span><span class="co">#&gt; 3    CRLGSI          0.9390596               0.9390601</span></span>
<span><span class="co">#&gt; 4 CPPG-LGSI       2123.2848118            2123.2848118</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zankrut Goyani.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
