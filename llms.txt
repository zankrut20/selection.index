# selection.index

Stop wasting days manually assembling complex variance-covariance
matrices and resolving selection weights. **`selection.index`** is the
definitive, production-ready R package built specifically for
agricultural statisticians and quantitative geneticists to instantly
calculate optimal multi-trait selection indices. Whether you are running
classical phenotypic field trials or building advanced genomic
evaluations, this package provides a fully integrated mathematical
engine that directly maximizes genetic advance and substantially
accelerates your breeding pipeline.

**ðŸ“š [Read the Official Documentation & Vignettes on our pkgdown
Website](https://zankrut20.github.io/selection.index/)**

## Installation

Install the stable release from CRAN:

``` r
install.packages("selection.index")
```

Install the development version from GitHub:

``` r
# install.packages("devtools")
devtools::install_github("zankrut20/selection.index")
```

## Quick Start: Optimizing Phenotypic Selection

The package includes several pre-configured structural datasets
(`seldata`, `maize_pheno`, `maize_geno`) to test your models. Here, we
demonstrate a fundamental phenotypic index evaluating multiple field
traits simultaneously.

Before combining traits into a unified index, breeders must cleanly
partition the total phenotypic variation. We first use the
variance-covariance functions
([`phen_varcov()`](https://zankrut20.github.io/selection.index/reference/phen_varcov.md)
and
[`gen_varcov()`](https://zankrut20.github.io/selection.index/reference/gen_varcov.md))
to extract the precise phenotypic and genotypic matrices directly from
your replicated trial data.

``` r
# Using the built-in 'seldata' dataset (Replication in Col 1, Genotype in Col 2)
p_mat <- phen_varcov(data = seldata[, 3:9], genotypes = seldata[, 2], replication = seldata[, 1])
g_mat <- gen_varcov(data = seldata[, 3:9], genotypes = seldata[, 2], replication = seldata[, 1])
```

Next, we establish strict economic objectives for our evaluated traits.
The
[`weight_mat()`](https://zankrut20.github.io/selection.index/reference/weight_mat.md)
function rapidly converts raw economic weight arrays into the formalized
mathematical format required for the core index calculation.

``` r
# Convert the built-in 'weight' configuration matrix
w_mat <- weight_mat(weight)
```

With our covariance structures and economic priorities firmly defined,
we must evaluate the baseline potential of our population. We calculate
the expected genetic gain for our primary target trait (e.g., yield)
using the
[`gen_advance()`](https://zankrut20.github.io/selection.index/reference/gen_advance.md)
function.

``` r
# Calculate expected genetic advance for the primary trait
base_advance <- gen_advance(phen_mat = p_mat[1, 1], gen_mat = g_mat[1, 1], weight_mat = w_mat[1, 1])
base_advance
#>        [,1]
#> [1,] 1.2009
```

Finally, to make definitive selection decisions, we dynamically evaluate
trait combinations. The
[`lpsi()`](https://zankrut20.github.io/selection.index/reference/lpsi.md)
function constructs robust combinatorial selection indices and
immediately ranks them by predicted relative efficiency, allowing you to
confidently select the mathematically superior combination.

``` r
# Calculate and rank combinatorial selection indices
optimal_index <- lpsi(
  ncomb = 1, pmat = p_mat, gmat = g_mat,
  wmat = weight[, 2:3], wcol = 1, GAY = base_advance
)
head(optimal_index)
#>   ID    b.1     GA      PRE Delta_G    rHI    hI2 Rank
#> 1  1 0.6316 2.8125 234.2021  2.8125 0.4825 0.2697    1
#> 2  2 0.2396 1.3036 108.5481  1.3036 0.2237 0.2242    4
#> 3  3 1.4869 2.1526 179.2462  2.1526 0.3693 0.2690    2
#> 4  4 0.4507 0.9084  75.6402  0.9084 0.1558 0.2549    6
#> 5  5 0.3164 1.6236 135.1988  1.6236 0.2786 0.1553    3
#> 6  6 1.4499 1.0292  85.7009  1.0292 0.1766 0.1471    5
```

*(For advanced modeling involving marker-assisted indices, multistage
selection, or genomic predictions, please load the included
`maize_pheno` and `maize_geno` datasets and consult our [pkgdown
vignettes](https://zankrut20.github.io/selection.index/).)*

## Citation

We rely directly on academic citations to maintain and justify the
continued development of this software ecosystem. If you use
`selection.index` in a publication, breeding pipeline, or research
project, it is imperative that you cite it:

``` r
citation("selection.index")
```

## Support & Consulting

### Direct-to-Client Consulting

Are you scaling up a commercial breeding operation or standardizing a
massive academic quantitative pipeline? I offer dedicated, expert
consulting to researchers tailored for custom selection index
development, stochastic simulation modeling, and full software pipeline
integration.

**Note: I operate strictly direct-to-client. There are absolutely no
middlemen, generic agencies, or intermediaries involved. You work
directly with the package creator.**

To discuss consulting scope and availability, contact:
`zankrut20@gmail.com`

### Tip Jar

If this package has saved you substantial time, simplified your data
pipeline, or helped you publish faster, please consider supporting its
independent development! Monetary contributions directly fund repository
maintenance and the addition of modern quantitative genetic models.

- **Indian Users (UPI):** `zankrut20@oksbi`
- **International Users:** Available Soon

# Package index

## All functions

- [`base_index()`](https://zankrut20.github.io/selection.index/reference/base_index.md)
  : Base Index (Williams, 1962)
- [`clgsi()`](https://zankrut20.github.io/selection.index/reference/clgsi.md)
  : Combined Linear Genomic Selection Index (CLGSI)
- [`cpp_math_primitives`](https://zankrut20.github.io/selection.index/reference/cpp_math_primitives.md)
  : Generic C++ Math Primitives for Experimental Design Statistics
- [`cppg_lgsi()`](https://zankrut20.github.io/selection.index/reference/cppg_lgsi.md)
  : Combined Predetermined Proportional Gains Linear Genomic Selection
  Index (CPPG-LGSI)
- [`crlgsi()`](https://zankrut20.github.io/selection.index/reference/crlgsi.md)
  : Combined Restricted Linear Genomic Selection Index (CRLGSI)
- [`dg_lpsi()`](https://zankrut20.github.io/selection.index/reference/dg_lpsi.md)
  : Desired Gains Index (DG-LPSI)
- [`esim()`](https://zankrut20.github.io/selection.index/reference/esim.md)
  : Linear Phenotypic Eigen Selection Index (ESIM)
- [`estimate_missing_values()`](https://zankrut20.github.io/selection.index/reference/estimate_missing_values.md)
  : Estimate Missing Values in Experimental Data
- [`gen_advance()`](https://zankrut20.github.io/selection.index/reference/gen_advance.md)
  : Genetic Advance for PRE
- [`gen_varcov()`](https://zankrut20.github.io/selection.index/reference/gen_varcov.md)
  : Genotypic Variance-Covariance Analysis
- [`genetic_genomic_varcov()`](https://zankrut20.github.io/selection.index/reference/genetic_genomic_varcov.md)
  : Genetic-Genomic Variance-Covariance Matrix (A)
- [`genomic_varcov()`](https://zankrut20.github.io/selection.index/reference/genomic_varcov.md)
  : Genomic Variance-Covariance Matrix (\\\Gamma\\)
- [`gesim()`](https://zankrut20.github.io/selection.index/reference/gesim.md)
  : Linear Genomic Eigen Selection Index Method (GESIM)
- [`gw_esim()`](https://zankrut20.github.io/selection.index/reference/gw_esim.md)
  : Genome-Wide Linear Eigen Selection Index Method (GW-ESIM)
- [`gw_lmsi()`](https://zankrut20.github.io/selection.index/reference/gw_lmsi.md)
  : Genome-Wide Linear Marker Selection Index (GW-LMSI)
- [`haldane_mapping()`](https://zankrut20.github.io/selection.index/reference/haldane_mapping.md)
  : Haldane's Mapping Function
- [`inverse_haldane_mapping()`](https://zankrut20.github.io/selection.index/reference/inverse_haldane_mapping.md)
  : Inverse Haldane Mapping Function
- [`lgsi()`](https://zankrut20.github.io/selection.index/reference/lgsi.md)
  : Linear Genomic Selection Index (LGSI)
- [`lmsi()`](https://zankrut20.github.io/selection.index/reference/lmsi.md)
  : Linear Marker Selection Index (LMSI)
- [`lpsi()`](https://zankrut20.github.io/selection.index/reference/lpsi.md)
  : Combinatorial Linear Phenotypic Selection Index
- [`maize_geno`](https://zankrut20.github.io/selection.index/reference/maize_geno.md)
  : Synthetic Maize Genomic Data
- [`maize_pheno`](https://zankrut20.github.io/selection.index/reference/maize_pheno.md)
  : Synthetic Maize Phenotypic Data
- [`mean_performance()`](https://zankrut20.github.io/selection.index/reference/mean_performance.md)
  : Mean performance of phenotypic data
- [`mesim()`](https://zankrut20.github.io/selection.index/reference/mesim.md)
  : Molecular Eigen Selection Index Method (MESIM)
- [`missing-value`](https://zankrut20.github.io/selection.index/reference/missing-value.md)
  : Missing Value Imputation for Experimental Designs
- [`mlgsi()`](https://zankrut20.github.io/selection.index/reference/mlgsi.md)
  : Multistage Linear Genomic Selection Index (MLGSI)
- [`mlpsi()`](https://zankrut20.github.io/selection.index/reference/mlpsi.md)
  : Multistage Linear Phenotypic Selection Index (MLPSI)
- [`mppg_lgsi()`](https://zankrut20.github.io/selection.index/reference/mppg_lgsi.md)
  : Multistage Predetermined Proportional Gain Linear Genomic Selection
  Index (MPPG-LGSI)
- [`mppg_lpsi()`](https://zankrut20.github.io/selection.index/reference/mppg_lpsi.md)
  : Multistage Predetermined Proportional Gain Linear Phenotypic
  Selection Index (MPPG-LPSI)
- [`mrlgsi()`](https://zankrut20.github.io/selection.index/reference/mrlgsi.md)
  : Multistage Restricted Linear Genomic Selection Index (MRLGSI)
- [`mrlpsi()`](https://zankrut20.github.io/selection.index/reference/mrlpsi.md)
  : Multistage Restricted Linear Phenotypic Selection Index (MRLPSI)
- [`phen_varcov()`](https://zankrut20.github.io/selection.index/reference/phen_varcov.md)
  : Phenotypic Variance-Covariance Analysis
- [`phenomic_genomic_varcov()`](https://zankrut20.github.io/selection.index/reference/phenomic_genomic_varcov.md)
  : Phenomic-Genomic Variance-Covariance Matrix (\\\Phi\\)
- [`plot(`*`<selection_simulation>`*`)`](https://zankrut20.github.io/selection.index/reference/plot.selection_simulation.md)
  : Plot Method for Selection Simulation Results
- [`ppg_esim()`](https://zankrut20.github.io/selection.index/reference/ppg_esim.md)
  : Predetermined Proportional Gain Eigen Selection Index (PPG-ESIM)
- [`ppg_gesim()`](https://zankrut20.github.io/selection.index/reference/ppg_gesim.md)
  : Predetermined Proportional Gain Genomic Eigen Selection Index
  (PPG-GESIM)
- [`ppg_lgsi()`](https://zankrut20.github.io/selection.index/reference/ppg_lgsi.md)
  : Predetermined Proportional Gains Linear Genomic Selection Index
  (PPG-LGSI)
- [`ppg_lpsi()`](https://zankrut20.github.io/selection.index/reference/ppg_lpsi.md)
  : Predetermined Proportional Gains (PPG-LPSI)
- [`predict_selection_score()`](https://zankrut20.github.io/selection.index/reference/predict_selection_score.md)
  : Predict selection index scores
- [`print(`*`<base_index>`*`)`](https://zankrut20.github.io/selection.index/reference/print.base_index.md)
  : Print method for Base Index
- [`print(`*`<dg_lpsi>`*`)`](https://zankrut20.github.io/selection.index/reference/print.dg_lpsi.md)
  : Print method for Desired Gains Index
- [`print(`*`<esim>`*`)`](https://zankrut20.github.io/selection.index/reference/print.esim.md)
  : Print method for ESIM
- [`print(`*`<gesim>`*`)`](https://zankrut20.github.io/selection.index/reference/print.gesim.md)
  : Print method for GESIM
- [`print(`*`<gw_esim>`*`)`](https://zankrut20.github.io/selection.index/reference/print.gw_esim.md)
  : Print method for GW-ESIM
- [`print(`*`<mesim>`*`)`](https://zankrut20.github.io/selection.index/reference/print.mesim.md)
  : Print method for MESIM
- [`print(`*`<ppg_esim>`*`)`](https://zankrut20.github.io/selection.index/reference/print.ppg_esim.md)
  : Print method for PPG-ESIM
- [`print(`*`<ppg_gesim>`*`)`](https://zankrut20.github.io/selection.index/reference/print.ppg_gesim.md)
  : Print method for PPG-GESIM
- [`print(`*`<resim>`*`)`](https://zankrut20.github.io/selection.index/reference/print.resim.md)
  : Print method for RESIM
- [`print(`*`<rgesim>`*`)`](https://zankrut20.github.io/selection.index/reference/print.rgesim.md)
  : Print method for RGESIM
- [`print(`*`<selection_simulation>`*`)`](https://zankrut20.github.io/selection.index/reference/print.selection_simulation.md)
  : Print Method for Selection Simulation Results
- [`print(`*`<smith_hazel>`*`)`](https://zankrut20.github.io/selection.index/reference/print.smith_hazel.md)
  : Print method for Smith-Hazel Index
- [`resim()`](https://zankrut20.github.io/selection.index/reference/resim.md)
  : Restricted Linear Phenotypic Eigen Selection Index (RESIM)
- [`rgesim()`](https://zankrut20.github.io/selection.index/reference/rgesim.md)
  : Restricted Linear Genomic Eigen Selection Index Method (RGESIM)
- [`rlgsi()`](https://zankrut20.github.io/selection.index/reference/rlgsi.md)
  : Restricted Linear Genomic Selection Index (RLGSI)
- [`rlpsi()`](https://zankrut20.github.io/selection.index/reference/rlpsi.md)
  : Restricted Linear Phenotypic Selection Index (RLPSI)
- [`seldata`](https://zankrut20.github.io/selection.index/reference/seldata.md)
  : Selection Index DataSet
- [`simulate_selection_cycles()`](https://zankrut20.github.io/selection.index/reference/simulate_selection_cycles.md)
  : Simulate Multi-Cycle Selection Using Different Indices
- [`smith_hazel()`](https://zankrut20.github.io/selection.index/reference/smith_hazel.md)
  : Smith-Hazel Linear Phenotypic Selection Index
- [`summary(`*`<base_index>`*`)`](https://zankrut20.github.io/selection.index/reference/summary.base_index.md)
  : Summary method for Base Index
- [`summary(`*`<dg_lpsi>`*`)`](https://zankrut20.github.io/selection.index/reference/summary.dg_lpsi.md)
  : Summary method for Desired Gains Index
- [`summary(`*`<esim>`*`)`](https://zankrut20.github.io/selection.index/reference/summary.esim.md)
  : Summary method for ESIM
- [`summary(`*`<gesim>`*`)`](https://zankrut20.github.io/selection.index/reference/summary.gesim.md)
  : Summary method for GESIM
- [`summary(`*`<gw_esim>`*`)`](https://zankrut20.github.io/selection.index/reference/summary.gw_esim.md)
  : Summary method for GW-ESIM
- [`summary(`*`<mesim>`*`)`](https://zankrut20.github.io/selection.index/reference/summary.mesim.md)
  : Summary method for MESIM
- [`summary(`*`<ppg_esim>`*`)`](https://zankrut20.github.io/selection.index/reference/summary.ppg_esim.md)
  : Summary method for PPG-ESIM
- [`summary(`*`<ppg_gesim>`*`)`](https://zankrut20.github.io/selection.index/reference/summary.ppg_gesim.md)
  : Summary method for PPG-GESIM
- [`summary(`*`<resim>`*`)`](https://zankrut20.github.io/selection.index/reference/summary.resim.md)
  : Summary method for RESIM
- [`summary(`*`<rgesim>`*`)`](https://zankrut20.github.io/selection.index/reference/summary.rgesim.md)
  : Summary method for RGESIM
- [`summary(`*`<selection_simulation>`*`)`](https://zankrut20.github.io/selection.index/reference/summary.selection_simulation.md)
  : Summary Method for Selection Simulation Results
- [`summary(`*`<smith_hazel>`*`)`](https://zankrut20.github.io/selection.index/reference/summary.smith_hazel.md)
  : Summary method for Smith-Hazel Index
- [`weight`](https://zankrut20.github.io/selection.index/reference/weight.md)
  : Weight dataset
- [`weight_mat()`](https://zankrut20.github.io/selection.index/reference/weight_mat.md)
  : Convert dataframe to matrix

# Articles

### Articles

- [Getting Started with
  selection.index](https://zankrut20.github.io/selection.index/articles/getting-started.md):
- [The Linear Phenotypic Selection Index
  Theory](https://zankrut20.github.io/selection.index/articles/linear-phenotypic-selection-index.md):
- [Constrained Linear Phenotypic Selection
  Indices](https://zankrut20.github.io/selection.index/articles/constrained-linear-phenotypic-selection-indices.md):
- [Linear Marker and Genome-Wide Selection
  Indices](https://zankrut20.github.io/selection.index/articles/linear-marker-selection-indices.md):
- [Linear Genomic Selection
  Indices](https://zankrut20.github.io/selection.index/articles/linear-genomic-selection-indices.md):
- [Constrained Linear Genomic Selection
  Indices](https://zankrut20.github.io/selection.index/articles/constrained-linear-genomic-selection-indices.md):
- [Linear Phenotypic Eigen Selection Index
  Methods](https://zankrut20.github.io/selection.index/articles/linear-phenotypic-eigen-selection-index-methods.md):
- [Linear Genomic Eigen Selection Index
  Methods](https://zankrut20.github.io/selection.index/articles/linear-genomic-eigen-selection-index-methods.md):
- [Multistage Phenotypic Selection
  Indices](https://zankrut20.github.io/selection.index/articles/multistage-linear-selection-indices.md):
- [Stochastic Simulation of Linear Phenotypic Selection
  Indices](https://zankrut20.github.io/selection.index/articles/stochastic-simulation-linear-phenotypic-indices.md):
