# selection.index

The goal of selection.index is to easily construct the selection index
and based on the these indices select the plant traits for the overall
improvement of the plant.

## Installation

You can install the released version of selection.index from
[CRAN](https://CRAN.R-project.org) with:

``` r
install.packages("selection.index")
```

from [github](https://github.com/zankrut20/selection.index) with:

``` r
devtools::install_github("zankrut20/selection.index")
```

## Example

This is a basic example which shows you how to solve a common problem:
Dataset `seldata` is included in package.

``` r
library(selection.index)
head(seldata)
#>   rep treat   sypp     dtf    rpp    ppr     ppp    spp     pw
#> 1   1    G1 5.4306 42.5000 2.8333 2.0085  7.5833 2.7020 0.5523
#> 2   2    G1 5.4583 42.5000 3.2000 3.7179  7.8000 2.5152 0.7431
#> 3   3    G1 5.5278 43.3333 3.1250 4.2023  7.6111 3.0976 0.7473
#> 4   1    G2 6.3250 43.3333 1.7500 3.0897  3.1000 2.6515 0.4824
#> 5   2    G2 5.8333 43.3333 3.0500 3.7692 14.6500 3.2121 0.6804
#> 6   3    G2 7.9074 43.3333 3.2778 3.6752 12.0000 3.0640 0.6471
```

### Genotypic Variance-Covariance Matrix

``` r
genMat<- gen.varcov(data = seldata[,3:9], genotypes = seldata[,2],
                    replication = seldata[,1])
print(genMat)
#>            sypp         dtf          rpp          ppr         ppp          spp
#> sypp 1.25660210  0.32936305  0.158785900  0.242981986  0.73499020  0.127571993
#> dtf  0.32936305  1.56017847  0.173388420 -0.312908175 -0.23310004  0.116790239
#> rpp  0.15878590  0.17338842  0.132484364 -0.031596521  0.32014873 -0.008643769
#> ppr  0.24298199 -0.31290818 -0.031596521  0.243231727  0.30192365 -0.020860985
#> ppp  0.73499020 -0.23310004  0.320148725  0.301923650  0.96076644 -0.069172364
#> spp  0.12757199  0.11679024 -0.008643769 -0.020860985 -0.06917236  0.017410958
#> pw   0.09261588  0.03298807 -0.012353519  0.007352443 -0.05824420  0.008560105
#>                pw
#> sypp  0.092615879
#> dtf   0.032988075
#> rpp  -0.012353519
#> ppr   0.007352443
#> ppp  -0.058244197
#> spp   0.008560105
#> pw    0.010304709
```

### Phenotypic Variance-Covariance Matrix

``` r
phenMat<- phen.varcov(data = seldata[,3:9], genotypes = seldata[,2],
                      replication = seldata[,1])
print(phenMat)
#>            sypp         dtf           rpp          ppr         ppp          spp
#> sypp 2.14648906  0.15455221  0.2319728887  0.276121850  1.08008088  0.145985907
#> dtf  0.15455221  3.83717336  0.1313373906 -0.428164534 -0.47026101  0.058467819
#> rpp  0.23197289  0.13133739  0.2274791728 -0.040450725  0.46352988  0.009592048
#> ppr  0.27612185 -0.42816453 -0.0404507247  0.467797686  0.39314225 -0.020464804
#> ppp  1.08008088 -0.47026101  0.4635298765  0.393142248  4.26374874  0.063241030
#> spp  0.14598591  0.05846782  0.0095920481 -0.020464804  0.06324103  0.083572855
#> pw   0.08747568 -0.01919207 -0.0006013091  0.006372357 -0.02452747  0.025910429
#>                 pw
#> sypp  0.0874756848
#> dtf  -0.0191920675
#> rpp  -0.0006013091
#> ppr   0.0063723573
#> ppp  -0.0245274713
#> spp   0.0259104291
#> pw    0.0226032987
```

### Weight Matrix - Data is included in package `weight`

``` r
weightMat <- weight.mat(weight)
weightMat
#>      ew     h2
#> [1,]  1 0.6947
#> [2,]  1 0.3244
#> [3,]  1 0.6861
#> [4,]  1 0.7097
#> [5,]  1 0.8336
#> [6,]  1 0.2201
#> [7,]  1 0.5226
```

- Genetic gain of Yield

``` r
GAY<- gen.advance(phen_mat = phenMat[1,1], gen_mat = genMat[1,1],
                  weight_mat = weightMat[1,1])
print(GAY)
#>        [,1]
#> [1,] 1.7694
```

### Construction of selection index/indices

For the construction of selection index we requires **phenotypic &
genotypic variance-covariance matrix as well weight matrix.**  

### Construction of all possible selection indices for a character combinations

``` r
comb.indices(ncomb = 1, pmat = phenMat, gmat = genMat, wmat = weight[,2:3], wcol = 1, GAY = GAY)
#>   ID    b.1     GA      PRE Rank
#> 1  1 0.5854 1.7694 100.0015    1
#> 2  2 0.4066 1.6431  92.8628    2
#> 3  3 0.5824 0.5731  32.3867    5
#> 4  4 0.5200 0.7337  41.4634    4
#> 5  5 0.2253 0.9599  54.2494    3
#> 6  6 0.2083 0.1242   7.0220    7
#> 7  7 0.4559 0.1414   7.9914    6
```

### Construction of selection indices by removing desired single character from the combinations

``` r
rcomb.indices(ncomb = 1, i = 1, pmat = phenMat, gmat = genMat, wmat = weight[,2:3], wcol = 1, GAY = GAY)
#>   ID    b.1     GA     PRE Rank
#> 1  2 0.4066 1.6431 92.8628    1
#> 2  3 0.5824 0.5731 32.3867    4
#> 3  4 0.5200 0.7337 41.4634    3
#> 4  5 0.2253 0.9599 54.2494    2
#> 5  6 0.2083 0.1242  7.0220    6
#> 6  7 0.4559 0.1414  7.9914    5
```

# Package index

## All functions

- [`base_index()`](https://zankrut20.github.io/selection.index/reference/base_index.md)
  : Base Index (Williams, 1962)
- [`clgsi()`](https://zankrut20.github.io/selection.index/reference/clgsi.md)
  : Combined Linear Genomic Selection Index (CLGSI)
- [`cpp_math_primitives`](https://zankrut20.github.io/selection.index/reference/cpp_math_primitives.md)
  : Generic C++ Math Primitives for Experimental Design Statistics
- [`cppg_lgsi()`](https://zankrut20.github.io/selection.index/reference/cppg_lgsi.md)
  : Combined Predetermined Proportional Gains Linear Genomic Selection
  Index (CPPG-LGSI)
- [`crlgsi()`](https://zankrut20.github.io/selection.index/reference/crlgsi.md)
  : Combined Restricted Linear Genomic Selection Index (CRLGSI)
- [`dg_lpsi()`](https://zankrut20.github.io/selection.index/reference/dg_lpsi.md)
  : Desired Gains Index (DG-LPSI)
- [`esim()`](https://zankrut20.github.io/selection.index/reference/esim.md)
  : Linear Phenotypic Eigen Selection Index (ESIM)
- [`estimate_missing_values()`](https://zankrut20.github.io/selection.index/reference/estimate_missing_values.md)
  : Estimate Missing Values in Experimental Data
- [`gen_advance()`](https://zankrut20.github.io/selection.index/reference/gen_advance.md)
  : Genetic Advance for PRE
- [`gen_varcov()`](https://zankrut20.github.io/selection.index/reference/gen_varcov.md)
  : Genotypic Variance-Covariance Analysis
- [`genetic_genomic_varcov()`](https://zankrut20.github.io/selection.index/reference/genetic_genomic_varcov.md)
  : Genetic-Genomic Variance-Covariance Matrix (A)
- [`genomic_varcov()`](https://zankrut20.github.io/selection.index/reference/genomic_varcov.md)
  : Genomic Variance-Covariance Matrix (Γ)
- [`gesim()`](https://zankrut20.github.io/selection.index/reference/gesim.md)
  : Linear Genomic Eigen Selection Index Method (GESIM)
- [`gw_esim()`](https://zankrut20.github.io/selection.index/reference/gw_esim.md)
  : Genome-Wide Linear Eigen Selection Index Method (GW-ESIM)
- [`gw_lmsi()`](https://zankrut20.github.io/selection.index/reference/gw_lmsi.md)
  : Genome-Wide Linear Marker Selection Index (GW-LMSI)
- [`haldane_mapping()`](https://zankrut20.github.io/selection.index/reference/haldane_mapping.md)
  : Haldane's Mapping Function
- [`inverse_haldane_mapping()`](https://zankrut20.github.io/selection.index/reference/inverse_haldane_mapping.md)
  : Inverse Haldane Mapping Function
- [`lgsi()`](https://zankrut20.github.io/selection.index/reference/lgsi.md)
  : Linear Genomic Selection Index (LGSI)
- [`lmsi()`](https://zankrut20.github.io/selection.index/reference/lmsi.md)
  : Linear Marker Selection Index (LMSI)
- [`lpsi()`](https://zankrut20.github.io/selection.index/reference/lpsi.md)
  : Combinatorial Linear Phenotypic Selection Index
- [`maize_geno`](https://zankrut20.github.io/selection.index/reference/maize_geno.md)
  : Synthetic Maize Genomic Data
- [`maize_pheno`](https://zankrut20.github.io/selection.index/reference/maize_pheno.md)
  : Synthetic Maize Phenotypic Data
- [`mean_performance()`](https://zankrut20.github.io/selection.index/reference/mean_performance.md)
  : Mean performance of phenotypic data
- [`mesim()`](https://zankrut20.github.io/selection.index/reference/mesim.md)
  : Molecular Eigen Selection Index Method (MESIM)
- [`missing-value`](https://zankrut20.github.io/selection.index/reference/missing-value.md)
  : Missing Value Imputation for Experimental Designs
- [`mlgsi()`](https://zankrut20.github.io/selection.index/reference/mlgsi.md)
  : Multistage Linear Genomic Selection Index (MLGSI)
- [`mlpsi()`](https://zankrut20.github.io/selection.index/reference/mlpsi.md)
  : Multistage Linear Phenotypic Selection Index (MLPSI)
- [`mppg_lgsi()`](https://zankrut20.github.io/selection.index/reference/mppg_lgsi.md)
  : Multistage Predetermined Proportional Gain Linear Genomic Selection
  Index (MPPG-LGSI)
- [`mppg_lpsi()`](https://zankrut20.github.io/selection.index/reference/mppg_lpsi.md)
  : Multistage Predetermined Proportional Gain Linear Phenotypic
  Selection Index (MPPG-LPSI)
- [`mrlgsi()`](https://zankrut20.github.io/selection.index/reference/mrlgsi.md)
  : Multistage Restricted Linear Genomic Selection Index (MRLGSI)
- [`mrlpsi()`](https://zankrut20.github.io/selection.index/reference/mrlpsi.md)
  : Multistage Restricted Linear Phenotypic Selection Index (MRLPSI)
- [`phen_varcov()`](https://zankrut20.github.io/selection.index/reference/phen_varcov.md)
  : Phenotypic Variance-Covariance Analysis
- [`phenomic_genomic_varcov()`](https://zankrut20.github.io/selection.index/reference/phenomic_genomic_varcov.md)
  : Phenomic-Genomic Variance-Covariance Matrix (Φ)
- [`plot(`*`<selection_simulation>`*`)`](https://zankrut20.github.io/selection.index/reference/plot.selection_simulation.md)
  : Plot Method for Selection Simulation Results
- [`ppg_esim()`](https://zankrut20.github.io/selection.index/reference/ppg_esim.md)
  : Predetermined Proportional Gain Eigen Selection Index (PPG-ESIM)
- [`ppg_gesim()`](https://zankrut20.github.io/selection.index/reference/ppg_gesim.md)
  : Predetermined Proportional Gain Genomic Eigen Selection Index
  (PPG-GESIM)
- [`ppg_lgsi()`](https://zankrut20.github.io/selection.index/reference/ppg_lgsi.md)
  : Predetermined Proportional Gains Linear Genomic Selection Index
  (PPG-LGSI)
- [`ppg_lpsi()`](https://zankrut20.github.io/selection.index/reference/ppg_lpsi.md)
  : Predetermined Proportional Gains (PPG-LPSI)
- [`predict_selection_score()`](https://zankrut20.github.io/selection.index/reference/predict_selection_score.md)
  : Predict selection index scores
- [`print(`*`<base_index>`*`)`](https://zankrut20.github.io/selection.index/reference/print.base_index.md)
  : Print method for Base Index
- [`print(`*`<dg_lpsi>`*`)`](https://zankrut20.github.io/selection.index/reference/print.dg_lpsi.md)
  : Print method for Desired Gains Index
- [`print(`*`<esim>`*`)`](https://zankrut20.github.io/selection.index/reference/print.esim.md)
  : Print method for ESIM
- [`print(`*`<gesim>`*`)`](https://zankrut20.github.io/selection.index/reference/print.gesim.md)
  : Print method for GESIM
- [`print(`*`<gw_esim>`*`)`](https://zankrut20.github.io/selection.index/reference/print.gw_esim.md)
  : Print method for GW-ESIM
- [`print(`*`<mesim>`*`)`](https://zankrut20.github.io/selection.index/reference/print.mesim.md)
  : Print method for MESIM
- [`print(`*`<ppg_esim>`*`)`](https://zankrut20.github.io/selection.index/reference/print.ppg_esim.md)
  : Print method for PPG-ESIM
- [`print(`*`<ppg_gesim>`*`)`](https://zankrut20.github.io/selection.index/reference/print.ppg_gesim.md)
  : Print method for PPG-GESIM
- [`print(`*`<resim>`*`)`](https://zankrut20.github.io/selection.index/reference/print.resim.md)
  : Print method for RESIM
- [`print(`*`<rgesim>`*`)`](https://zankrut20.github.io/selection.index/reference/print.rgesim.md)
  : Print method for RGESIM
- [`print(`*`<selection_simulation>`*`)`](https://zankrut20.github.io/selection.index/reference/print.selection_simulation.md)
  : Print Method for Selection Simulation Results
- [`print(`*`<smith_hazel>`*`)`](https://zankrut20.github.io/selection.index/reference/print.smith_hazel.md)
  : Print method for Smith-Hazel Index
- [`resim()`](https://zankrut20.github.io/selection.index/reference/resim.md)
  : Restricted Linear Phenotypic Eigen Selection Index (RESIM)
- [`rgesim()`](https://zankrut20.github.io/selection.index/reference/rgesim.md)
  : Restricted Linear Genomic Eigen Selection Index Method (RGESIM)
- [`rlgsi()`](https://zankrut20.github.io/selection.index/reference/rlgsi.md)
  : Restricted Linear Genomic Selection Index (RLGSI)
- [`rlpsi()`](https://zankrut20.github.io/selection.index/reference/rlpsi.md)
  : Restricted Linear Phenotypic Selection Index (RLPSI)
- [`seldata`](https://zankrut20.github.io/selection.index/reference/seldata.md)
  : Selection Index DataSet
- [`simulate_selection_cycles()`](https://zankrut20.github.io/selection.index/reference/simulate_selection_cycles.md)
  : Simulate Multi-Cycle Selection Using Different Indices
- [`smith_hazel()`](https://zankrut20.github.io/selection.index/reference/smith_hazel.md)
  : Smith-Hazel Linear Phenotypic Selection Index
- [`summary(`*`<base_index>`*`)`](https://zankrut20.github.io/selection.index/reference/summary.base_index.md)
  : Summary method for Base Index
- [`summary(`*`<dg_lpsi>`*`)`](https://zankrut20.github.io/selection.index/reference/summary.dg_lpsi.md)
  : Summary method for Desired Gains Index
- [`summary(`*`<esim>`*`)`](https://zankrut20.github.io/selection.index/reference/summary.esim.md)
  : Summary method for ESIM
- [`summary(`*`<gesim>`*`)`](https://zankrut20.github.io/selection.index/reference/summary.gesim.md)
  : Summary method for GESIM
- [`summary(`*`<gw_esim>`*`)`](https://zankrut20.github.io/selection.index/reference/summary.gw_esim.md)
  : Summary method for GW-ESIM
- [`summary(`*`<mesim>`*`)`](https://zankrut20.github.io/selection.index/reference/summary.mesim.md)
  : Summary method for MESIM
- [`summary(`*`<ppg_esim>`*`)`](https://zankrut20.github.io/selection.index/reference/summary.ppg_esim.md)
  : Summary method for PPG-ESIM
- [`summary(`*`<ppg_gesim>`*`)`](https://zankrut20.github.io/selection.index/reference/summary.ppg_gesim.md)
  : Summary method for PPG-GESIM
- [`summary(`*`<resim>`*`)`](https://zankrut20.github.io/selection.index/reference/summary.resim.md)
  : Summary method for RESIM
- [`summary(`*`<rgesim>`*`)`](https://zankrut20.github.io/selection.index/reference/summary.rgesim.md)
  : Summary method for RGESIM
- [`summary(`*`<selection_simulation>`*`)`](https://zankrut20.github.io/selection.index/reference/summary.selection_simulation.md)
  : Summary Method for Selection Simulation Results
- [`summary(`*`<smith_hazel>`*`)`](https://zankrut20.github.io/selection.index/reference/summary.smith_hazel.md)
  : Summary method for Smith-Hazel Index
- [`weight`](https://zankrut20.github.io/selection.index/reference/weight.md)
  : Weight dataset
- [`weight_mat()`](https://zankrut20.github.io/selection.index/reference/weight_mat.md)
  : Convert dataframe to matrix

# Articles

### All vignettes

- [Constrained Linear Genomic Selection
  Indices](https://zankrut20.github.io/selection.index/articles/constrained-linear-genomic-selection-indices.md):
- [Constrained Linear Phenotypic Selection
  Indices](https://zankrut20.github.io/selection.index/articles/constrained-linear-phenotypic-selection-indices.md):
- [Getting Started with
  selection.index](https://zankrut20.github.io/selection.index/articles/getting-started.md):
- [Linear Genomic Eigen Selection Index
  Methods](https://zankrut20.github.io/selection.index/articles/linear-genomic-eigen-selection-index-methods.md):
- [Linear Genomic Selection
  Indices](https://zankrut20.github.io/selection.index/articles/linear-genomic-selection-indices.md):
- [Linear Marker and Genome-Wide Selection
  Indices](https://zankrut20.github.io/selection.index/articles/linear-marker-selection-indices.md):
- [Linear Phenotypic Eigen Selection Index
  Methods](https://zankrut20.github.io/selection.index/articles/linear-phenotypic-eigen-selection-index-methods.md):
- [The Linear Phenotypic Selection Index
  Theory](https://zankrut20.github.io/selection.index/articles/linear-phenotypic-selection-index.md):
- [Multistage Phenotypic Selection
  Indices](https://zankrut20.github.io/selection.index/articles/multistage-linear-selection-indices.md):
- [Stochastic Simulation of Linear Phenotypic Selection
  Indices](https://zankrut20.github.io/selection.index/articles/stochastic-simulation-linear-phenotypic-indices.md):
