% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/design.R
\name{rcbd.design}
\alias{rcbd.design}
\title{RCBD Design Calculations Engine}
\usage{
rcbd.design(
  trait1,
  trait2 = trait1,
  genotypes,
  replications,
  calc_type = c("all", "sums_of_products", "mean_products", "anova_stats")
)
}
\arguments{
\item{trait1}{Numeric vector of first trait observations}

\item{trait2}{Numeric vector of second trait observations (default: trait1 for variance)}

\item{genotypes}{Integer vector of genotype/treatment indices}

\item{replications}{Integer vector of replication/block indices}

\item{calc_type}{Character string specifying calculation type:
\itemize{
  \item \code{"sums_of_products"} - Returns CF, TSP, GSP, RSP, ESP (for covariance)
  \item \code{"mean_products"} - Returns GMP, EMP (for variance components)
  \item \code{"all"} - Returns all components (default)
  \item \code{"anova_stats"} - Returns degrees of freedom and mean squares
}}
}
\value{
List containing RCBD statistics based on calc_type:
  \itemize{
    \item \code{CF} - Correction factor: (GT1 × GT2) / (r × t)
    \item \code{TSP} - Total sum of products
    \item \code{GSP} - Genotype sum of products  
    \item \code{RSP} - Replication sum of products
    \item \code{ESP} - Error sum of products
    \item \code{GMP} - Genotype mean product
    \item \code{EMP} - Error mean product
    \item \code{DFG} - Degrees of freedom for genotypes (t - 1)
    \item \code{DFR} - Degrees of freedom for replications (r - 1)
    \item \code{DFE} - Degrees of freedom for error (r - 1)(t - 1)
    \item \code{n_genotypes} - Number of genotypes
    \item \code{n_replications} - Number of replications
  }
}
\description{
Modular engine for Randomized Complete Block Design (RCBD) calculations.
Computes correction factors, sums of products, mean products, and degrees of freedom
for variance-covariance analysis and ANOVA statistics.

This function eliminates code duplication across gen.varcov(), phen.varcov(), and 
meanPerformance() by providing a centralized, optimized implementation of RCBD calculations.
}
\details{
The function uses optimized Base R operations:
\itemize{
  \item \code{rowsum()} for fast grouped summations (5-10x faster than tapply)
  \item \code{crossprod()} for efficient matrix products (faster than sum(x*y))
  \item Pre-computed constants to avoid repeated calculations
}

RCBD Model: Y_ij = μ + τ_i + β_j + ε_ij
where τ_i = genotype effect, β_j = block effect, ε_ij = error
}
\examples{
# Example with seldata
gen_idx <- as.integer(as.factor(seldata$treat))
rep_idx <- as.integer(as.factor(seldata$rep))
trait1 <- seldata$sypp
trait2 <- seldata$dtf

# Calculate sums of products for covariance
result <- rcbd.design(trait1, trait2, gen_idx, rep_idx, calc_type = "sums_of_products")
print(result$TSP)
print(result$GSP)

# Calculate mean products for variance components
result <- rcbd.design(trait1, trait1, gen_idx, rep_idx, calc_type = "mean_products")
genetic_variance <- (result$GMP - result$EMP) / result$n_replications
print(genetic_variance)
}
\references{
Cochran, W. G., & Cox, G. M. (1957). Experimental designs (2nd ed.). Wiley.

Steel, R. G. D., & Torrie, J. H. (1980). Principles and procedures of statistics: 
A biometrical approach (2nd ed.). McGraw-Hill.
}
