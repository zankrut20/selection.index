% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{cpp_varcov_iterator}
\alias{cpp_varcov_iterator}
\title{C++ Variance-Covariance Matrix Iterator}
\usage{
cpp_varcov_iterator(
  data_mat,
  gen_idx,
  rep_idx,
  col_idx = NULL,
  main_idx = NULL,
  design_type = 1L,
  cov_type = 1L
)
}
\arguments{
\item{data_mat}{Numeric matrix of trait observations (n_obs x n_traits)}

\item{gen_idx}{Integer vector of genotype indices (1-based converted to 0-based internally)}

\item{rep_idx}{Integer vector of replication indices (1-based converted to 0-based internally)}

\item{col_idx}{Integer vector of column indices for LSD (NULL for RCBD/SPD)}

\item{main_idx}{Integer vector of main plot indices for SPD (NULL for RCBD/LSD)}

\item{design_type}{Integer: 1=RCBD, 2=LSD, 3=SPD}

\item{cov_type}{Integer: 1=genotypic, 2=phenotypic}
}
\value{
Symmetric variance-covariance matrix (n_traits x n_traits)
}
\description{
Optimized C++ implementation for computing variance-covariance matrices.
Replaces nested R loops in gen_varcov() and phen_varcov() with vectorized
operations. Processes all trait pairs in a single call using Eigen for
efficient matrix operations.
}
\details{
Algorithm optimizations:
- Single pass through data for all trait pairs (eliminates R loop overhead)
- Uses Eigen's efficient matrix operations (crossprod, grouped sums)
- Pre-allocates all result matrices (no memory reallocation)
- Computes only upper triangle, then mirrors to lower (symmetric matrix)

RCBD: Cov_G = (GMP - EMP) / r, Cov_P = Cov_G + EMP
LSD:  Cov_G = (GMP - EMP) / t, Cov_P = Cov_G + EMP  
SPD:  Cov_G = (GMP - EMP) / (r*a), Cov_P = Cov_G + EMP
}
\keyword{internal}
