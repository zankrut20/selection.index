% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/missingValueEstimation.R
\name{missingValueEstimation}
\alias{missingValueEstimation}
\title{Missing Value Estimation for RCBD Design}
\usage{
missingValueEstimation(
  data_mat,
  gen_idx,
  rep_idx,
  method = c("REML", "Yates", "Healy", "Regression", "Mean", "Bartlett"),
  tolerance = 1e-06
)
}
\arguments{
\item{data_mat}{Numeric matrix with observations (rows) by traits (columns).
May contain missing values (NA, NaN, Inf).}

\item{gen_idx}{Integer vector indicating genotype/treatment index for each observation.}

\item{rep_idx}{Integer vector indicating replicate/block index for each observation.}

\item{method}{Character string specifying the estimation method. One of:
\describe{
  \item{REML}{Restricted Maximum Likelihood with variance components and BLUP
    (Best Linear Unbiased Prediction). Most robust for complex missing patterns.
    Default method. Iterations: 100.}
  \item{Yates}{Traditional iterative formula: (r*T + t*B - G) / ((r-1)(t-1)).
    Simple and fast. Good for simple missing patterns. Iterations: 50.}
  \item{Healy}{Healy & Westmacott method using weighted adjustment of treatment
    and block means. More stable than Yates for multiple missing values. Iterations: 50.}
  \item{Regression}{Linear regression on treatment and block effects with QR
    decomposition. Non-iterative, single-pass estimation. Fast and stable.}
  \item{Mean}{Simple mean substitution using treatment and block effects.
    Non-iterative, fastest method. Good for quick estimation.}
  \item{Bartlett}{ANCOVA using other traits as covariates with QR decomposition.
    Best when traits are correlated. Iterations: 30.}
}}

\item{tolerance}{Numeric convergence criterion. Iteration stops when maximum
change in estimated values is below this threshold. Default: 1e-6.}
}
\value{
A numeric matrix of the same dimensions as \code{data_mat} with all
  missing values replaced by estimates.
}
\description{
Estimates missing values in a Randomized Complete Block Design (RCBD) using
one of three methods: REML, Yates, or Bartlett (Covariate).
}
\details{
The function handles missing values in RCBD experiments by iteratively
estimating them until convergence. Each method has different strengths:

\strong{REML Method:}
Uses variance component estimation with restricted maximum likelihood.
Applies shrinkage to predictions based on estimated variance ratios.
Most computationally intensive but handles complex patterns well.

\strong{Yates Method:}
Uses the classical formula accounting for treatment, block, and grand totals.
Fast and simple, suitable for balanced designs with few missing values.

\strong{Healy & Westmacott Method:}
Uses weighted adjustment based on residuals from treatment and block effects.
More stable than Yates when multiple values are missing from same treatment or block.
Particularly effective for unbalanced missing patterns.

\strong{Regression Method:}
Fits linear model using complete observations with treatment and block as factors.
Non-iterative single-pass estimation using QR decomposition for numerical stability.
Fast and deterministic - no convergence iterations needed.

\strong{Mean Substitution Method:}
Replaces missing values with treatment mean + block mean - grand mean.
Non-iterative, fastest method. Simple additive model without regression.
Best for quick estimation when precision is less critical.

\strong{Bartlett Method:}
Performs ANCOVA using other traits as covariates to predict missing values.
Leverages trait correlations for better predictions when traits are related.
Uses QR decomposition for numerical stability.
}
\examples{
# Create sample data with missing values
data <- matrix(rnorm(100), ncol = 5)
data[c(3, 7, 15)] <- NA
genotypes <- rep(1:10, each = 2)
replicates <- rep(1:2, times = 10)

# Estimate using REML (default)
data_reml <- missingValueEstimation(data, genotypes, replicates)

# Estimate using Yates method
data_yates <- missingValueEstimation(data, genotypes, replicates, method = "Yates")

# Estimate using Healy & Westmacott method
data_healy <- missingValueEstimation(data, genotypes, replicates, method = "Healy")

# Estimate using Regression method
data_regression <- missingValueEstimation(data, genotypes, replicates, method = "Regression")

# Estimate using Mean substitution method
data_mean <- missingValueEstimation(data, genotypes, replicates, method = "Mean")

# Estimate using Bartlett method
data_bartlett <- missingValueEstimation(data, genotypes, replicates, method = "Bartlett")

}
\references{
Yates, F. (1933). The analysis of replicated experiments when the field results
are incomplete. \emph{Empire Journal of Experimental Agriculture}, 1, 129-142.

Healy, M. J. R., & Westmacott, M. (1956). Missing values in experiments analysed
on automatic computers. \emph{Applied Statistics}, 5(3), 203-206.

Bartlett, M. S. (1937). Some examples of statistical methods of research in
agriculture and applied biology. \emph{Supplement to the Journal of the Royal
Statistical Society}, 4(2), 137-183.
}
